# arc_twitter v3.2.1
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjU6
IjMuMi4xIjtzOjY6ImF1dGhvciI7czoxMToiQW5keSBDYXJ0ZXIiO3M6MTA6ImF1dGhvcl91
cmkiO3M6MzE6Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbS8iO3M6MTE6ImRlc2Ny
aXB0aW9uIjtzOjYwOiI8YSBocmVmPSJodHRwOi8vd3d3LnR3aXR0ZXIuY29tIj5Ud2l0dGVy
PC9hPiBmb3IgVGV4dHBhdHRlcm4iO3M6NToib3JkZXIiO3M6MToiNSI7czo0OiJ0eXBlIjtz
OjE6IjEiO3M6NToiZmxhZ3MiO3M6MToiMyI7czo0OiJoZWxwIjtzOjE3OTA2OiIJPGgxIGNs
YXNzPSJ0aXRsZSI+PHNwYW4gY2xhc3M9ImNhcHMiPlRYUDwvc3Bhbj4gVHdlZXQgKGFyY190
d2l0dGVyIGZvciBUZXh0cGF0dGVybik8L2gxPgoKCTxvbD4KCQk8bGk+PGEgaHJlZj0iI2Fy
Y190d2l0dGVyX2F1dGhvciI+QXV0aG9yPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNf
dHdpdHRlcl9pbnN0YWxsYXRpb24iPkluc3RhbGxhdGlvbiAvIFVuaW5zdGFsbGF0aW9uPC9h
PjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl90YWciPlRoZSBhcmNfdHdpdHRl
ciB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3NlYXJjaF90YWci
PlRoZSBhcmNfdHdpdHRlcl9zZWFyY2ggdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNh
cmNfdHdpdHRlcl90d2VldF9idXR0b25fdGFnIj5UaGUgYXJjX3R3aXR0ZXJfdHdlZXRfYnV0
dG9uIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfZm9sbG93X2J1
dHRvbl90YWciPlRoZSBhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uIHRhZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfdHdlZXRfdXJsIj5UaGUgYXJjX3R3aXR0ZXJf
dHdlZXRfdXJsIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfdGlu
eXVybCI+VGhlIGFyY190d2l0dGVyX3Rpbnl1cmwgdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhy
ZWY9IiNhcmNfdHdpdHRlcl9jYWNoaW5nIj5DYWNoaW5nPC9hPjwvbGk+CgkJPGxpPjxhIGhy
ZWY9IiNhcmNfdHdpdHRlcl9wcmVmcyI+UHJlZmVyZW5jZXM8L2E+PC9saT4KCQk8bGk+PGEg
aHJlZj0iI2FyY190d2l0dGVyX2FydGljbGUiPlR3ZWV0aW5nIGFydGljbGVzPC9hPjwvbGk+
CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9hZG1pbiI+VGhlIFR3aXR0ZXIgdGFiPC9h
PjwvbGk+Cgk8L29sPgoKCTxwPjxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0
IHByb3ZpZGVzIGFjY2VzcyB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudCB0aHJvdWdoIGJvdGgg
dGhlIGFkbWluIGludGVyZmFjZSBhbmQgdGhlIHB1YmxpYyBzaWRlIG9mIHlvdXIgc2l0ZS4g
VXBkYXRlIFR3aXR0ZXIgd2hlbiB5b3UgcG9zdCBhIG5ldyBhcnRpY2xlICh3aXRoIGFydGlj
bGUtYnktYXJ0aWNsZSBvcHQgb3V0IG9wdGlvbiksIHVwZGF0ZSBhbmQgdmlldyB5b3VyIFR3
aXR0ZXIgZmVlZCB0aHJvdWdoIHRoZSBhZG1pbiBUd2l0dGVyIHRhYiwgYW5kIGRpc3BsYXkg
VHdpdHRlciBmZWVkcyBvbiB5b3VyIHNpdGUuPC9wPgoKCTxwPlJlcXVpcmVtZW50czotPC9w
PgoKCTx1bD4KCQk8bGk+VGV4dHBhdHRlcm4gNC4yKzwvbGk+CgkJPGxpPjxzcGFuIGNsYXNz
PSJjYXBzIj5QSFA8L3NwYW4+IDUgYW5kIGNVUkw8L2xpPgoJPC91bD4KCgk8aDIgY2xhc3M9
InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9hdXRob3IiPkF1dGhvcjwvaDI+CgoJPHA+PGEg
aHJlZj0iaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tIj5BbmR5IENhcnRlcjwvYT4u
IEZvciBvdGhlciBUZXh0cGF0dGVybiBwbHVnaW5zIGJ5IG1lIHZpc2l0IG15IDxhIGhyZWY9
Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbS90eHAiPlBsdWdpbnMgcGFnZTwvYT4u
PC9wPgoKCTxwPlRoYW5rcyB0byA8YSBocmVmPSJodHRwOi8vbWFuZnJlLm5ldC8iPk1pY2hh
ZWwgTWFuZnJlPC9hPiBmb3IgaW5zcGlyYXRpb24gZm9yIHRoZSBhcnRpY2xlIHR3ZWV0IHBh
cnQgb2YgdGhpcyBwbHVnaW4gYmFzZWQgb24gaGlzIDxzcGFuIGNsYXNzPSJ0YWciPm1lbV90
d2l0dGVyPC9zcGFuPiBwbHVnaW4uICBBZGRpdGlvbmFsIHRoYW5rcyB0byB0aGUgZ3JlYXQg
VGV4dHBhdHRlcm4gY29tbXVuaXR5IGZvciBoZWxwaW5nIHRvIHRlc3QgdGhpcyBwbHVnaW4g
YW5kIGZvciBzdWdnZXN0aW5nIG5ldyBmZWF0dXJlcy4gVGhlIE9BdXRoIHBhcnQgb2YgdGhl
IHBsdWdpbiBpcyB0aGFua3MgdG8gPGEgaHJlZj0iaHR0cDovL3R3aXR0ZXIuY29tL2FicmFo
YW0iPkFicmFoYW0gV2lsbGlhbXM8L2E+LjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlk
PSJhcmNfdHdpdHRlcl9pbnN0YWxsYXRpb24iPkluc3RhbGxhdGlvbiAvIFVuaW5zdGFsbGF0
aW9uPC9oMj4KCgk8cD5UbyBpbnN0YWxsIGdvIHRvIHRoZSAmIzgyMTY7cGx1Z2lucyYjODIx
NzsgdGFiIHVuZGVyICYjODIxNjthZG1pbiYjODIxNzsgYW5kIHBhc3RlIHRoZSBwbHVnaW4g
Y29kZSBpbnRvIHRoZSAmIzgyMTY7SW5zdGFsbCBwbHVnaW4mIzgyMTc7IGJveCwgJiM4MjE2
O3VwbG9hZCYjODIxNzsgYW5kIHRoZW4gJiM4MjE2O2luc3RhbGwmIzgyMTc7LiBUaGUgcGx1
Z2luIHdpbGwgYmUgYXV0b21hdGljYWxseSBhY3RpdmF0ZWQuPC9wPgoKCTxwPkJlZm9yZSB5
b3Ugc3RhcnQgdXNpbmcgPHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHlv
dSB3aWxsIG5lZWQgdG8gbWFrZSBzdXJlIHRoYXQgdGhlIGNhY2hlIGRpcmVjdG9yeSBpcyB3
cml0YWJsZS4gU2VlIHRoZSAmIzgyMTY7Q2FjaGluZyYjODIxNzsgc3Vic2VjdGlvbiBiZWxv
dyBmb3IgZnVydGhlciBpbmZvcm1hdGlvbi48L3A+CgoJPHA+PHNwYW4gY2xhc3M9InRhZyI+
YXJjX3R3aXR0ZXI8L3NwYW4+IHNob3VsZCBub3cgYmUgcmVhZHkgZm9yIHVzZSBvbiB0aGUg
cHVibGljLXNpZGUgb2YgeW91ciBzaXRlLjwvcD4KCgk8cD5UbyB1bmxvY2sgdGhlIGFkbWlu
IGZlYXR1cmVzIG9mIHRoaXMgcGx1Z2luIHlvdSB3aWxsIG5lZWQgdG8gYXNzb2NpYXRlIHlv
dXIgc2l0ZSB3aXRoIGEgVHdpdHRlciBhY2NvdW50IGJ5IGNvbm5lY3RpbmcgdG8gVHdpdHRl
ciBmcm9tIHRoZSBwbHVnaW4mIzgyMTc7cyBvcHRpb25zIHNjcmVlbi4gQ2xpY2sgb24gdGhl
IGxpbmsgdG8gY29ubmVjdCB0byBUd2l0dGVyLCB5b3Ugd2lsbCBiZSBhc2tlZCB0byBsb2dp
biB0byBUd2l0dGVyLCBjbGlja2luZyB0aGlzIGxpbmsgd2lsbCB0ZW1wb3JhcmlseSB0YWtl
IHlvdSB0byB0aGUgVHdpdHRlciBzaXRlIHdoZXJlIHlvdSB3aWxsIGJlIGFza2VkIHRvIGxv
Z2luIGFuZCBhcHByb3ZlIGFjY2VzcyBmb3IgPHNwYW4gY2xhc3M9ImNhcHMiPlRYUDwvc3Bh
bj4gVHdlZXQgdG8gcmVhZCBhbmQgd3JpdGUgdG8geW91ciBUd2l0dGVyIGFjY291bnQuIElm
IGFsbCBpcyBzdWNjZXNzZnVsIHlvdSB3aWxsIGJlIHJldHVybmVkIHRvIHRoZSBvcHRpb25z
IHNjcmVlbiBhbmQgeW91ciB1c2VyIG5hbWUgd2lsbCBhcHBlYXIuPC9wPgoKCTxwPkF0IGFu
eSB0aW1lIHlvdSBjYW4gZGlzYXNzb2NpYXRlIHlvdXIgVHdpdHRlciBhY2NvdW50IHdpdGgg
PHNwYW4gY2xhc3M9ImNhcHMiPlRYUDwvc3Bhbj4gVHdlZXQgdmlhIHlvdXIgVHdpdHRlciBh
Y2NvdW50IHByZWZlcmVuY2VzIG9uIHRoZSA8YSBocmVmPSJodHRwOi8vd3d3LnR3aXR0ZXIu
Y29tIj5Ud2l0dGVyIHdlYnNpdGU8L2E+LjwvcD4KCgk8cD5UbyB1bmluc3RhbGwgPHNwYW4g
Y2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHNpbXBseSBkZWxldGUgdGhlIHBsdWdp
biBmcm9tIHRoZSAmIzgyMTY7UGx1Z2lucyYjODIxNzsgdGFiLiAgVGhpcyB3aWxsIHJlbW92
ZSB0aGUgcGx1Z2luIGNvZGUsIGRlbGV0ZSByZWxhdGVkIHByZWZlcmVuY2VzIGFuZCBkcm9w
IHRoZSA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4gdGFibGUgZnJvbSB5
b3VyIFRleHRwYXR0ZXJuIGRhdGFiYXNlLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlk
PSJhcmNfdHdpdHRlcl90YWciPlRoZSBhcmNfdHdpdHRlciB0YWc8L2gyPgoKCTxoMz5TeW50
YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXIgdXNlcj0mcXVvdDtkcm1vbmtleW5p
bmphJnF1b3Q7IC8mZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4K
CQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5E
ZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+
dXNlcjwvdGQ+CgkJCTx0ZD5Ud2l0dGVyIHVzZXIgbmFtZTwvdGQ+CgkJCTx0ZD4gPGVtPmFy
Y190d2l0dGVyIHVzZXJuYW1lPC9lbT48L3RkPgoJCQk8dGQ+dXNlcj0mcXVvdDtkcm1vbmtl
eW5pbmphJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnJldHdlZXRzPC90ZD4K
CQkJPHRkPjEgdG8gaW5jbHVkZSByZXR3ZWV0cywgMCB0byBleGNsdWRlIHRoZW0gZnJvbSB0
aGUgZmVlZDwvdGQ+CgkJCTx0ZD4wPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnJlcGxp
ZXM8L3RkPgoJCQk8dGQ+MSB0byBpbmNsdWRlIHJlcGxpZXMsIDAgdG8gZXhjbHVkZSB0aGVt
IGZyb20gdGhlIGZlZWQ8L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5saW1pdDwvdGQ+CgkJCTx0ZD5NYXhpbXVtIG51bWJlciBvZiB0d2VldHMgdG8gZGlzcGxh
eSAobWF4LiAyMDApPC90ZD4KCQkJPHRkPjEwPC90ZD4KCQkJPHRkPmxpbWl0PSZxdW90OzI1
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmZldGNoPC90ZD4KCQkJPHRkPk1h
eGltdW0gbnVtYmVyIG9mIHR3ZWV0cyB0byByZXRyaWV2ZSBmcm9tIFR3aXR0ZXIgKG1heC4g
MjAwKTxzdXAgY2xhc3M9ImZvb3Rub3RlIj48YSBocmVmPSIjZm4zNDgwNTc1MDI0ZjQ4Yzc4
NThmYjQxIj4xPC9hPjwvc3VwPjwvdGQ+CgkJCTx0ZD4wPC90ZD4KCQkJPHRkPmZldGNoPSZx
dW90OzUwJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmRhdGVmb3JtYXQ8L3Rk
PgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBkYXRlIGRhdGVzIHdpbGwgYXBwZWFyIGFzPC90ZD4K
CQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRlIGZvcm1hdDwvZW0+PC90ZD4KCQkJPHRkPmRhdGVm
b3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+
CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0ZD5MYWJlbCBmb3IgdGhlIHRvcCBvZiB0aGUgbGlz
dDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxhYmVsPC9lbT48L3RkPgoJCQk8dGQ+bGFiZWw9JnF1
b3Q7TXkgVHdpdHRlciB0aW1lbGluZSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5JbmRlcGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwv
dGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+bGFiZWx0YWc9JnF1b3Q7
aDMmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+
PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bh
bj4gdGFnICh3aXRob3V0IGJyYWNrZXRzKSwgb3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRl
IHRoZSB1cGRhdGVzPC90ZD4KCQkJPHRkPmxpPC90ZD4KCQkJPHRkPmJyZWFrPSZxdW90O2Jy
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPndyYXB0YWc8L3RkPgoJCQk8dGQ+
PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bh
bj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdyYXB0YWcsIHdpdGhvdXQgYnJhY2tldHM8L3Rk
PgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPndyYXB0YWc9JnF1b3Q7dWwm
cXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNw
YW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBj
bGFzcyBhdHRyaWJ1dGUgZm9yIHdyYXB0YWc8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXI8L3Rk
PgoJCQk8dGQ+Y2xhc3M9JnF1b3Q7dHdpdHRlciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+
CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxz
cGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBw
bGllZCB0byBzcGFuIHRhZyBhcm91bmQgcG9zdGVkIGRhdGU8L3RkPgoJCQk8dGQ+YXJjX3R3
aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8cCBpZD0iZm4zNDgwNTc1
MDI0ZjQ4Yzc4NThmYjQxIiBjbGFzcz0iZm9vdG5vdGUiPjxzdXA+MTwvc3VwPiBUd2l0dGVy
JiM4MjE3O3MgPHNwYW4gY2xhc3M9ImNhcHMiPkFQSTwvc3Bhbj4gY291bnRzIHRoZSBudW1i
ZXIgb2YgdHdlZXRzIHRvIHJldHVybiBiZWZvcmUgYXBwbHlpbmcgc29tZSBvZiB0aGUgZmls
dGVycywgc28gdGhlIHJlc3BvbnNlIGNhbiBiZSBmZXdlciB0d2VldHMgdGhhbiBleHBlY3Rl
ZC4gVG8gaGVscCBhdm9pZCB0aGlzIHlvdSBjYW4gc2V0IGEgPGVtPmZldGNoPC9lbT4gbGlt
aXQgdGhhdCBpcyBoaWdoZXIgdGhhbiB0aGUgZGlzcGxheSA8ZW0+bGltaXQ8L2VtPiB0aGF0
IHlvdSB3YW50IHRvIG91dHB1dC4gSWYgPGVtPmZldGNoPC9lbT4gaXMgbGVzcyB0aGFuIDxl
bT5saW1pdDwvZW0+IHRoZSBsYXR0ZXIgd2lsbCBiZSB1c2VkIGluc3RlYWQuPC9wPgoKCTxo
Mz5FeGFtcGxlIHVzYWdlPC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyIHVzZXI9JnF1
b3Q7ZHJtb25rZXluaW5qYSZxdW90OyBsaW1pdD0mcXVvdDs1JnF1b3Q7IHdyYXB0YWc9JnF1
b3Q7dWwmcXVvdDsgYnJlYWs9JnF1b3Q7bGkmcXVvdDsgZGF0ZWZvcm1hdD0mcXVvdDslYiAl
T2UsICVJOiVNICVwJnF1b3Q7IC8mZ3Q7PC9wPgoKCTxwPlByb2R1Y2VzIGEgYnVsbGV0IHBv
aW50IGxpc3Qgb2YgdGhlIGxhc3QgNSBUd2l0dGVyIHVwZGF0ZXMgZnJvbSBkcm1vbmtleW5p
bmphJiM4MjE3O3MgVHdpdHRlciBmZWVkIHdpdGggYSBkZWZpbmVkIGRhdGUgZm9ybWF0IHRv
IG92ZXJyaWRlIHRoZSBkZWZhdWx0IGFyY2hpdmUgZGF0ZSBmb3JtYXQuPC9wPgoKCTxoMiBj
bGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX3NlYXJjaF90YWciPlRoZSBhcmNfdHdp
dHRlcl9zZWFyY2ggdGFnPC9oMj4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFy
Y190d2l0dGVyX3NlYXJjaCBoYXNodGFncz0mcXVvdDt0eHAmcXVvdDsgLyZndDs8L3A+CgoJ
PGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4K
CQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhh
bXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5zZWFyY2g8L3RkPgoJCQk8dGQ+Q29t
bWEgc2VwYXJhdGVkIGxpc3Qgb2Ygc2VhcmNoIHdvcmRzPC90ZD4KCQkJPHRkPiA8ZW0+dW5z
ZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5zZWFyY2g9JnF1b3Q7dHhwLHRleHRwYXR0ZXJuJnF1b3Q7
PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmhhc2h0YWdzPC90ZD4KCQkJPHRkPkNvbW1h
IHNlcGFyYXRlZCBsaXN0IG9mIGhhc2h0YWdzIHRvIHNlYXJjaCBmb3IgKG5vdCBpbmNsdWRp
bmcgdGhlIGhhc2gpPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5o
YXNodGFncz0mcXVvdDt0eHAsdGV4dHBhdHRlcm4mcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+cmVwbHk8L3RkPgoJCQk8dGQ+VXNlcm5hbWUgb2YgdHdlZXRzIGluIHJlcGx5
IHRvPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5yZXBseT0mcXVv
dDt0d2l0dGVyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPm1lbnRpb248L3Rk
PgoJCQk8dGQ+VXNlcm5hbWUgb2YgdXNlciBtZW50aW9uZWQgaW4gdHdlZXRzICg8aT5pLmUu
PC9pPiB0d2VldHMgY29udGFpbmluZyBAdXNlcm5hbWUpPC90ZD4KCQkJPHRkPiA8ZW0+dW5z
ZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5tZW50aW9uPSZxdW90O3R3aXR0ZXImcXVvdDs8L3RkPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGltaXQ8L3RkPgoJCQk8dGQ+TWF4aW11bSBudW1iZXIg
b2YgdHdlZXRzIHRvIGRpc3BsYXkgKG1heC4gMjAwKTwvdGQ+CgkJCTx0ZD4xMDwvdGQ+CgkJ
CTx0ZD5saW1pdD0mcXVvdDsyNSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5k
YXRlZm9ybWF0PC90ZD4KCQkJPHRkPkZvcm1hdCB0aGF0IHVwZGF0ZSBkYXRlcyB3aWxsIGFw
cGVhciBhczwvdGQ+CgkJCTx0ZD4gPGVtPkFyY2hpdmUgZGF0ZSBmb3JtYXQ8L2VtPjwvdGQ+
CgkJCTx0ZD5kYXRlZm9ybWF0PSZxdW90OyViICVPZSwgJUk6JU0gJXAmcXVvdDs8L3RkPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWw8L3RkPgoJCQk8dGQ+TGFiZWwgZm9yIHRoZSB0
b3Agb2YgdGhlIGxpc3Q8L3RkPgoJCQk8dGQ+IDxlbT5ubyBsYWJlbDwvZW0+PC90ZD4KCQk8
L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsdGFnPC90ZD4KCQkJPHRkPkluZGVwZW5kZW50IHdy
YXB0YWcgZm9yIGxhYmVsPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD5icmVhazwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+
PHNwYW4gY2xhc3M9ImNhcHMiPkhUTUw8L3NwYW4+PC9zcGFuPiB0YWcgKHdpdGhvdXQgYnJh
Y2tldHMpLCBvciBzdHJpbmcsIHVzZWQgdG8gc2VwYXJhdGUgdGhlIHVwZGF0ZXM8L3RkPgoJ
CQk8dGQ+bGk8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+d3JhcHRhZzwvdGQ+CgkJCTx0
ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkhUTUw8L3NwYW4+PC9z
cGFuPiB0YWcgdG8gYmUgdXNlZCBhcyB0aGUgd3JhcHRhZywgd2l0aG91dCBicmFja2V0czwv
dGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+
Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBz
Ij5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgZm9yIHdyYXB0YWc8L3RkPgoJ
CQk8dGQ+YXJjX3R3aXR0ZXJfc2VhcmNoPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNs
YXNzX3VzZXI8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJj
YXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byBzcGFu
IHRhZyBhcm91bmQgdXNlciBuYW1lPC90ZD4KCQkJPHRkPmFyY190d2l0dGVyLXVzZXI8L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3NfcG9zdGVkPC90ZD4KCQkJPHRkPjxzcGFu
IGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xh
c3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHBvc3RlZCBkYXRlPC90
ZD4KCQkJPHRkPmFyY190d2l0dGVyLXBvc3RlZDwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJ
PGgzPkV4YW1wbGUgdXNhZ2U8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfc2VhcmNo
IHNlYXJjaD0mcXVvdDtwbHVnaW4mcXVvdDsgaGFzaHRhZ3M9JnF1b3Q7dHhwLHRleHRwYXR0
ZXJuJnF1b3Q7IGxpbWl0PSZxdW90OzI1JnF1b3Q7IC8mZ3Q7PC9wPgoKCTxwPlByb2R1Y2Vz
IGEgbGlzdCBvZiB0d2VldHMgY29udGFpbmluZyB0aGUgd29yZCAmIzgyMTY7cGx1Z2luJiM4
MjE3OyBhbmQgdGhlIGhhc2h0YWdzICYjODIxNjsjdHhwJiM4MjE3OyBhbmQgJiM4MjE2OyN0
ZXh0cGF0dGVybiYjODIxNzsuIFRoZSB0YWcgd2lsbCByZXR1cm4gYSBtYXhpbXVtIG9mIDI1
IHR3ZWV0cy48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfcmV0
d2VldF90YWciPlRoZSBhcmNfdHdpdHRlcl90d2VldF9idXR0b24gdGFnPC9oMj4KCgk8cD5P
dXRwdXRzIHRoZSBUd2l0dGVyIHR3ZWV0IGJ1dHRvbiAoZm9ybWVybHkgJmx0O3R4cDphcmNf
dHdpdHRlcl9yZXR3ZWV0IC8mZ3Q7KS48L3A+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0
O3R4cDphcmNfdHdpdHRlcl90d2VldF9idXR0b24gLyZndDs8L3A+CgoJPGgzPlVzYWdlPC9o
Mz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2Ny
aXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJPHRkPlR3aXR0ZXIgdXNlciBuYW1l
IHRvIHF1b3RlPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgdXNlcm5hbWU8L2VtPjwv
dGQ+CgkJCTx0ZD51c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+dXJsPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3Bh
biBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPjwvc3Bhbj4gdG8gdHdlZXQ8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+dGV4dDwvdGQ+CgkJCTx0ZD5Ud2VldCB0ZXh0PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmZvbGxvdzE8L3RkPgoJCQk8dGQ+U3VnZ2VzdGVkIFR3aXR0ZXIg
YWNjb3VudCB0byBmb2xsb3csIGZvciBleGFtcGxlIHlvdXIgb3duPC90ZD4KCQkJPHRkPkEg
VHdpdHRlciB1c2VyIHRvIHJlY29tbWVuZDwvdGQ+CgkJCTx0ZD5mb2xsb3cxPSZxdW90O1Rl
eHRwYXR0ZXJuJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmZvbGxvdzI8L3Rk
PgoJCQk8dGQ+QXMgZm9sbG93MTwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFuZzwvdGQ+CgkJCTx0ZD5MYW5ndWFnZTwvdGQ+CgkJ
CTx0ZD5lbjwvdGQ+CgkJCTx0ZD5sYW5nPSZxdW90O2VzJnF1b3Q7PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmNvdW50PC90ZD4KCQkJPHRkPkNvdW50IGJveCBwb3NpdGlvbiwgb3B0
aW9uczogbm9uZSwgaG9yaXpvbnRhbCBvciB2ZXJ0aWNhbDwvdGQ+CgkJCTx0ZD5ob3Jpem9u
dGFsPC90ZD4KCQkJPHRkPmNvdW50PSZxdW90O25vbmUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+aW5jbHVkZV9qczwvdGQ+CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0byBp
bmNsdWRlIHRoZSB3aWRnZXQgSmF2YVNjcmlwdDwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJPHRk
PmluY2x1ZGVfanM9JnF1b3Q7MCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5v
cHRpbWlzZV9qczwvdGQ+CgkJCTx0ZD5PcHRpbWlzZSB0aGUgSmF2YVNjcmlwdCBieSB1c2lu
ZyBhIGxvY2FsIHNjcmlwdCByYXRoZXIgdGhhbiB0aGF0IGhvc3RlZCBvbiB0aGUgVHdpdHRl
ciBzaXRlPC90ZD4KCQkJPHRkPjA8L3RkPgoJCQk8dGQ+b3B0aW1pc2VfanM9JnF1b3Q7MSZx
dW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3Bh
biBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNs
YXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSB0d2VldCBidXR0b248L3RkPgoJCQk8dGQ+
dHdpdHRlci1zaGFyZS1idXR0b248L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFz
cz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2ZvbGxvd19idXR0b25fdGFnIj5UaGUgYXJj
X3R3aXR0ZXJfZm9sbG93X2J1dHRvbiB0YWc8L2gyPgoKCTxwPk91dHB1dHMgdGhlIFR3aXR0
ZXIgZm9sbG93IGJ1dHRvbiAoYW4gYWx0ZXJuYXRpdmUgdmVyc2lvbiBpcyBpbmNsdWRlZCBp
biBhcmNfdHdpdHRlcl9pbnRlbnRzKS48L3A+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0
O3R4cDphcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uIC8mZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwv
aDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNj
cmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+dXNlcjwvdGQ+CgkJCTx0ZD5Ud2l0dGVyIHVzZXIgbmFt
ZSB0byBmb2xsb3c8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciB1c2VybmFtZTwvZW0+
PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OzwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD5sYW5nPC90ZD4KCQkJPHRkPkxhbmd1YWdlPC90ZD4KCQkJPHRk
PmVuPC90ZD4KCQkJPHRkPmxhbmc9JnF1b3Q7ZXMmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+Y291bnQ8L3RkPgoJCQk8dGQ+V2hldGhlciBvciBub3QgdGhlIGZvbGxvd2Vy
IGNvdW50IGlzIHNob3duPC90ZD4KCQkJPHRkPjE8L3RkPgoJCQk8dGQ+Y291bnQ9JnF1b3Q7
MCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5pbmNsdWRlX2pzPC90ZD4KCQkJ
PHRkPldoZXRoZXIgb3Igbm90IHRvIGluY2x1ZGUgdGhlIHdpZGdldCBKYXZhU2NyaXB0PC90
ZD4KCQkJPHRkPjE8L3RkPgoJCQk8dGQ+aW5jbHVkZV9qcz0mcXVvdDswJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPm9wdGltaXNlX2pzPC90ZD4KCQkJPHRkPk9wdGltaXNl
IHRoZSBKYXZhU2NyaXB0IGJ5IHVzaW5nIGEgbG9jYWwgc2NyaXB0IHJhdGhlciB0aGFuIHRo
YXQgaG9zdGVkIG9uIHRoZSBUd2l0dGVyIHNpdGU8L3RkPgoJCQk8dGQ+MDwvdGQ+CgkJCTx0
ZD5vcHRpbWlzZV9qcz0mcXVvdDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2Fw
cyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gdGhlIGZv
bGxvdyBidXR0b248L3RkPgoJCQk8dGQ+dHdpdHRlci1mb2xsb3ctYnV0dG9uPC90ZD4KCQk8
L3RyPgoJPC90YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl90
d2VldF91cmwiPmFyY190d2l0dGVyX3R3ZWV0X3VybDwvaDI+CgoJPHA+UmV0dXJucyB0aGUg
PHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gb2YgdGhlIFR3aXR0ZXIgc3RhdHVzIGZv
ciBhbiBhcnRpY2xlLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190
d2l0dGVyX3R3ZWV0X3VybCAvJmd0OzwvcD4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3
ZWV0X3VybCZndDtMaW5rIHRleHQmbHQ7L3R4cDphcmNfdHdpdHRlcl90d2VldF91cmwmZ3Q7
PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0
ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJ
PHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aWQ8L3RkPgoJCQk8dGQ+
VGV4dHBhdHRlcm4gYXJ0aWNsZSBJRDwvdGQ+CgkJCTx0ZD4gPGVtPmN1cnJlbnQgYXJ0aWNs
ZTwvZW0+PC90ZD4KCQkJPHRkPmlkPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+dGl0bGU8L3RkPgoJCQk8dGQ+VGl0bGUgYXR0cmlidXRlIG9mIHRoZSBsaW5r
PC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNh
cHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSBs
aW5rPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+
CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfdGlueXVybCI+YXJjX3R3
aXR0ZXJfdGlueXVybDwvaDI+CgoJPHA+UmV0dXJucyB0aGUgc2hvcnRlbmVkIDxzcGFuIGNs
YXNzPSJjYXBzIj5VUkw8L3NwYW4+IG9mIHRoZSBhcnRpY2xlIHVzZWQgZm9yIHRoZSBUd2l0
dGVyIHVwZGF0ZS48L3A+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdp
dHRlcl90aW55dXJsIC8mZ3Q7PC9wPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdGlueXVy
bCZndDtMaW5rIHRleHQmbHQ7L3R4cDphcmNfdHdpdHRlcl90aW55dXJsJmd0OzwvcD4KCgk8
aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJ
CQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFt
cGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmlkPC90ZD4KCQkJPHRkPlRleHRwYXR0
ZXJuIGFydGljbGUgSUQ8L3RkPgoJCQk8dGQ+IDxlbT5jdXJyZW50IGFydGljbGU8L2VtPjwv
dGQ+CgkJCTx0ZD5pZD0mcXVvdDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PnRpdGxlPC90ZD4KCQkJPHRkPlRpdGxlIGF0dHJpYnV0ZSBvZiB0aGUgbGluazwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8
L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8
L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUgbGluazwvdGQ+
CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBj
bGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2NhY2hpbmciPkNhY2hpbmc8L2gyPgoK
CTxwPkluIG9yZGVyIHRvIHByZXZlbnQgZXhjZXNzaXZlIHJlcGVhdGl0aXZlIGNhbGxzIHRv
IHRoZSBUd2l0dGVyIHdlYnNpdGUgaXQgaXMgcmVjb21tZW5kZWQgdG8gY2FjaGUgcmVzdWx0
cy4gVHdpdHRlciBsaW1pdHMgdGhlIG51bWJlciBvZiBjYWxscyB0aHJvdWdoIHRoZSA8c3Bh
biBjbGFzcz0iY2FwcyI+QVBJPC9zcGFuPiwgYW5kIGNvbnRpbnVvdXMgY2FsbHMgd2lsbCBy
ZXN1bHQgaW4gVHdpdHRlciBjbG9zaW5nIHRvIGZ1cnRoZXIgcmVxdWVzdHMuIEJ5IGRlZmF1
bHQsIGFyY190d2l0dGVyIGNhY2hlcyBmb3IgMzAgbWludXRlIGludGVydmFscy48L3A+CgoJ
PHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlv
bjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+Y2FjaGluZzwvdGQ+CgkJCTx0ZD4mIzgyMTY7MSYjODIxNzsgdG8g
Y2FjaGUgZmVlZCwgJiM4MjE2OzAmIzgyMTc7IHRvIHR1cm4gY2FjaGluZyBvZmYgKG5vdCBy
ZWNvbW1lbmRlZCk8L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJCTx0ZD5jYWNoaW5nPSZxdW90OzEm
cXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2FjaGVfZGlyPC90ZD4KCQkJPHRk
PkFic29sdXRlIHBhdGggdG8gdGhlIGNhY2hlIGRpcmVjdG9yeSAobXVzdCBiZSB3cml0YWJs
ZSk8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciBwcmVmZXJlbmNlczwvZW0+PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNhY2hlX3RpbWU8L3RkPgoJCQk8dGQ+VGltZSBpbiBt
aW51dGVzIHRoYXQgdGhlIGNhY2hlIGZpbGVzIGFyZSBzdG9yZWQgYmVmb3JlIGJlaW5nIHJl
ZnJlc2hlZDwvdGQ+CgkJCTx0ZD41PC90ZD4KCQkJPHRkPmNhY2hlX3RpbWU9JnF1b3Q7MzAm
cXVvdDs8L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxwPlRoZSBhZG1pbiBzaWRlIG9mIHRo
aXMgcGx1Z2luIGVuZm9yY2VzIGNhY2hpbmcsIGFwYXJ0IGZyb20gd2hlbiBpdCBpcyBwb3N0
aW5nIHRvIFR3aXR0ZXIgKDxpPmUuZy48L2k+IHdoZW4gcG9zdGluZyBvciBkZWxldGluZyBh
biB1cGRhdGUpLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9w
cmVmcyI+UHJlZmVyZW5jZXM8L2gyPgoKCTxwPllvdSBjYW4gYWNjZXNzIHRoZSBwbHVnaW5z
IGNvcmUgcHJlZmVyZW5jZXMgZnJvbSBlaXRoZXIgdGhlIFByZWZlcmVuY2VzIG9yIFBsdWdp
bnMgdGFicyBpbiBhZG1pbi4gU2V0dXAgeW91ciBUd2l0dGVyIGFjY291bnQgKHlvdSB3aWxs
IGJlIGFza2VkIHRvIGNvbm5lY3QgdmlhIFR3aXR0ZXIgYW5kIHRoaXMgbmVlZHMgZG9pbmcg
YmVmb3JlIHlvdSBjYW4gdXNlIHRoZSBwbHVnaW4pIGFuZCBjaGFuZ2UgdGhlIGNhY2hlIGRp
cmVjdG9yeSB1c2luZyBhcmNfdHdpdHRlciYjODIxNztzIHByZWZlcmVuY2VzLiBXaXRob3V0
IHByb3ZpZGluZyB5b3VyIGFjY291bnQgbG9naW4gZGV0YWlscyB0aGUgYWRtaW4gYXJlYSBm
ZWF0dXJlcyBvZiB0aGlzIHBsdWdpbiB3aWxsIGJlIGluYWN0aXZlLjwvcD4KCgk8cD5Zb3Ug
Y2FuIHNlbGVjdCB0aGUgPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gc2hvcnRlbmVy
IG1ldGhvZCB5b3Ugd2FudCB0byB1c2UgdG8gbGluayBiYWNrIHRvIHlvdXIgYXJ0aWNsZSBv
biBUd2l0dGVyLiBQbGVhc2Ugbm90ZSB0aGF0IGlmIHlvdSBzZWxlY3Qgc21kX3Nob3J0X3Vy
bCB5b3Ugd2lsbCBuZWVkIHRvIGhhdmUgaW5zdGFsbGVkIGFuZCBhY3RpdmF0ZWQgdGhlIDxh
IGhyZWY9Imh0dHA6Ly90ZXh0cGF0dGVybi5vcmcvcGx1Z2lucy8xMDk5L3NtZF9zaG9ydF91
cmwiPjxzcGFuIGNsYXNzPSJ0YWciPnNtZF9zaG9ydF91cmw8L3NwYW4+IHBsdWdpbjwvYT4g
ZGV2ZWxvcGVkIGJ5IFN0ZWYgRGF3c29uLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlk
PSJhcmNfdHdpdHRlcl9hcnRpY2xlIj5Ud2VldGluZyBhcnRpY2xlczwvaDI+CgoJPHA+Qnkg
ZGVmYXVsdCBhcmNfdHdpdHRlciB3aWxsIHBvc3QgYW4gdXBkYXRlIHRvIFR3aXR0ZXIgaW5j
bHVkaW5nIGEgc2hvcnRlbmVkIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IHRvIHlv
dXIgYXJ0aWNsZS4gT25seSBsaXZlIGFuZCBhY3RpdmUgYXJ0aWNsZXMgd2lsbCBiZSBzZW50
IHRvIFR3aXR0ZXIsIDxpPmkuZS48L2k+IGFydGljbGVzIHBvc3RlZCBpbiB0aGUgZnV0dXJl
IG9yIGFzIHN0aWNreSBhcnRpY2xlcyB3aWxsIG5vdCBiZSBzZW50LiBJZiB5b3VyIGFydGlj
bGUgaXMgc3VjY2Vzc2Z1bGx5IHN1Ym1pdHRlZCB0byBUd2l0dGVyIHRoZSB1cGRhdGUgd2ls
bCBhcHBlYXIgaW4gcGxhY2Ugb2YgdGhlIFR3aXR0ZXIgb3B0aW9uIG9uIHRoZSByaWdodC1o
YW5kLXNpZGUgb2YgdGhlIGFydGljbGUgZWRpdCBzY3JlZW4uPC9wPgoKCTxwPlR3ZWV0cyBh
cmUgc2VudCBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDogPGVtPlR3ZWV0IHByZWZpeDwvZW0+
IDxlbT5BcnRpY2xlIHRpdGxlPC9lbT4gPGVtPlNob3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2Fw
cyI+VVJMPC9zcGFuPjwvZW0+IDxlbT5Ud2VldCBzdWZmaXg8L2VtPi4gWW91IGNhbiBjaGFu
Z2UgdGhlIHByZWZpeCBhbmQgc3VmZml4IG9uIGFuIGFydGljbGUtYnktYXJ0aWNsZSBiYXNp
cyBieSBjaGFuZ2luZyB0aGUgdHdlZXQgb3B0aW9ucyB1bmRlciAmIzgyMTY7VXBkYXRlIFR3
aXR0ZXImIzgyMTc7IG9uIHRoZSBhcnRpY2xlIGVkaXRvciBzY3JlZW4uIFRoZSBkZWZhdWx0
IDxlbT5Ud2VldCBwcmVmaXg8L2VtPiBjYW4gYmUgc2V0IHVuZGVyIHRoZSA8c3BhbiBjbGFz
cz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4gcHJlZmVyZW5jZXMgc2NyZWVuICh0aGUgZGVm
YXVsdCBvbiBpbnN0YWxsYXRpb24gaXMgJiM4MjIwO0p1c3QgcG9zdGVkOiYjODIyMTspLjwv
cD4KCgk8cD5QbGVhc2Ugbm90ZSB0aGF0IG9uY2UgYW4gYXJ0aWNsZSBoYXMgYmVlbiB0d2Vl
dGVkIHRoZSB0d2VldCBjYW5ub3QgYmUgZWRpdGVkLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rp
b24iIGlkPSJhcmNfdHdpdHRlcl9hZG1pbiI+VGhlIFR3aXR0ZXIgdGFiPC9oMj4KCgk8cD5V
bmRlciB0aGUgRXh0ZW5zaW9ucyB0YWIgKHRoaXMgY2FuIGJlIGNoYW5nZWQgZnJvbSB0aGUg
cGx1Z2luJiM4MjE3O3MgcHJlZmVyZW5jZSBwYWdlKSBhIG5ldyBUd2l0dGVyIHRhYiBzaG91
bGQgYXBwZWFyIG9uY2UgeW91IGhhdmUgY29ubmVjdGVkIHlvdXIgc2l0ZSB0byB5b3VyIFR3
aXR0ZXIgYWNjb3VudC4gRnJvbSBoZXJlIHlvdSB3aWxsIGJlIGFibGUgdG8gc3VibWl0IG5l
dyBUd2l0dGVyIHVwZGF0ZXMsIHZpZXcgYmFzaWMgYWNjb3VudCBzdGF0aXN0aWNzLCBhbmQg
Y2hlY2sgb3V0IHlvdXIgcmVjZW50IHVwZGF0ZXMgKGluY2x1ZGluZyB0aGUgb3B0aW9uIHRv
IGRlbGV0ZSB5b3VyIHR3ZWV0cykuPC9wPiI7czo0OiJjb2RlIjtzOjc2NjU5OiJnbG9iYWwg
JHByZWZzLCR0eHBjZmcsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCRhcmNfdHdpdHRlcl9j
b25zdW1lclNlY3JldDsKCiRhcmNfdHdpdHRlciA9IGFycmF5KCk7CgokYXJjX3R3aXR0ZXJf
Y29uc3VtZXJLZXkgPSAnbktjWHNsd3paaEJkMGtmS01ldG5QQSc7CiRhcmNfdHdpdHRlcl9j
b25zdW1lclNlY3JldCA9ICdDNm5TUENMM2VlSEdUQmhLQ2d3ZDlvY2xjdUQwc3JCOFdWa2ZY
UVlDNTQnOwoKYWRkX3ByaXZzKCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInLCcxLDInKTsK
cmVnaXN0ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVyX2luc3RhbGwnLCdwbHVnaW5fbGlmZWN5
Y2xlLmFyY190d2l0dGVyJywgJ2luc3RhbGxlZCcpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJj
X3R3aXR0ZXJfdW5pbnN0YWxsJywncGx1Z2luX2xpZmVjeWNsZS5hcmNfdHdpdHRlcicsICdk
ZWxldGVkJyk7CnJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9wcmVmcycsJ3BsdWdp
bl9wcmVmcy5hcmNfdHdpdHRlcicpOwoKLyoKICogU2V0dXAgaW5pdGlhbCBwcmVmZXJlbmNl
cyBpZiBub3QgaW4gdGhlIHR4cF9wcmVmcyB0YWJsZS4KICovCmlmICghaXNzZXQoJHByZWZz
WydhcmNfdHdpdHRlcl91c2VyJ10pKQogICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VzZXIn
LCAnJywgJ2FyY190d2l0dGVyJywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJl
ZnNbJ2FyY190d2l0dGVyX3ByZWZpeCddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcHJl
Zml4JywnSnVzdCBwb3N0ZWQ6JywgJ2FyY190d2l0dGVyJywgMiwgJ3RleHRfaW5wdXQnKTsK
aWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3N1ZmZpeCddKSkKICBzZXRfcHJlZign
YXJjX3R3aXR0ZXJfc3VmZml4JywnJywgJ2FyY190d2l0dGVyJywgMiwgJ3RleHRfaW5wdXQn
KTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2RpciddKSkKICBzZXRf
cHJlZignYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywkdHhwY2ZnWyd0eHBhdGgnXS4kcHJlZnNb
J3RlbXBkaXInXSwgJ2FyY190d2l0dGVyJywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3Nl
dCgkcHJlZnNbJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnXSkpCiAgc2V0X3ByZWYoJ2Fy
Y190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnLCAxLCAnYXJjX3R3aXR0ZXInLCAyLCAneWVzbm9S
YWRpbycpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddKSkK
ICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcsICd0aW55dXJsJywgJ2FyY190
d2l0dGVyJywgMiwKICAgICdhcmNfdHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCcpOwppZiAo
IWlzc2V0KCRwcmVmc1snYXJjX3Nob3J0X3VybCddKSkKICBzZXRfcHJlZignYXJjX3Nob3J0
X3VybCcsIDAsICdhcmNfdHdpdHRlcicsIDIsICd5ZXNub1JhZGlvJyk7CmlmICghaXNzZXQo
JHByZWZzWydhcmNfc2hvcnRfc2l0ZV91cmwnXSkpCiAgc2V0X3ByZWYoJ2FyY19zaG9ydF9z
aXRlX3VybCcsICRwcmVmc1snc2l0ZXVybCddLCAnYXJjX3R3aXR0ZXInLCAyLCAndGV4dF9p
bnB1dCcpOwovLyBNYWtlIHN1cmUgdGhhdCB0aGUgVHdpdHRlciB0YWIgaGFzIGJlZW4gZGVm
aW5lZAppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ10pKSB7CiAgc2V0X3By
ZWYoJ2FyY190d2l0dGVyX3RhYicsICdleHRlbnNpb25zJywgJ2FyY190d2l0dGVyJywgMiwK
ICAgICdhcmNfdHdpdHRlcl90YWJfc2VsZWN0Jyk7CiAgICAkcHJlZnNbJ2FyY190d2l0dGVy
X3RhYiddID0gJ2V4dGVuc2lvbnMnOwp9CgovLyBDaGVjayBpZiBhcmNfc2hvcnRfdXJsIGlz
IGVuYWJsZWQKaWYgKChpc3NldCgkcHJlZnNbJ2FyY19zaG9ydF91cmwnXSkmJiRwcmVmc1sn
YXJjX3Nob3J0X3VybCddKQp8fCAoaXNzZXQoJHByZWZzWydhcmNfc2hvcnRfdXJsX21ldGhv
ZCddKSYmJHByZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0aG9kJ109PSdhcmNfdHdpdHRlcicp
KSB7CiAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19zaG9ydF91cmxfcmVkaXJlY3QnLCAndHhw
X2RpZScsIDQwNCk7Cn0KCmlmIChAdHhwaW50ZXJmYWNlID09ICdhZG1pbicpIHsKICAgIHJl
Z2lzdGVyX2NhbGxiYWNrKCdfYXJjX3R3aXR0ZXJfYXV0b19lbmFibGUnLCAncGx1Z2luX2xp
ZmVjeWNsZS5hcmNfdHdpdHRlcicsICdpbnN0YWxsZWQnKTsKICAgIGlmICghZW1wdHkoJHBy
ZWZzWydhcmNfdHdpdHRlcl91c2VyJ10pCiAgICAgICAgJiYgIWVtcHR5KCRwcmVmc1snYXJj
X3R3aXR0ZXJfYWNjZXNzVG9rZW4nXSkKICAgICAgICAmJiAhZW1wdHkoJHByZWZzWydhcmNf
dHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKSApIHsKCiAgICAgICAgaWYgKCRwcmVmc1sn
YXJjX3R3aXR0ZXJfdGFiJ10pIHsKICAgICAgICAgICAgYWRkX3ByaXZzKCdhcmNfYWRtaW5f
dHdpdHRlcicsICcxLDIsMyw0Jyk7CiAgICAgICAgICAgIHJlZ2lzdGVyX3RhYigkcHJlZnNb
J2FyY190d2l0dGVyX3RhYiddLCAnYXJjX2FkbWluX3R3aXR0ZXInLCAnVHdpdHRlcicpOwog
ICAgICAgICAgICByZWdpc3Rlcl9jYWxsYmFjaygnYXJjX2FkbWluX3R3aXR0ZXInLCAnYXJj
X2FkbWluX3R3aXR0ZXInKTsKICAgICAgICB9CgogICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNr
KCdhcmNfYXJ0aWNsZV90d2VldCcsICdwaW5nJyk7CiAgICAgICAgcmVnaXN0ZXJfY2FsbGJh
Y2soJ2FyY19hcnRpY2xlX3R3ZWV0JywgJ2FydGljbGUnLCAnZWRpdCcsIDEpOwogICAgICAg
IHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXBwZW5kX3R3aXR0ZXInLCAnYXJ0aWNsZV91aScs
ICdzdGF0dXMnKTsKICAgIH0KfQoKLyoKICAgIFB1YmxpYy1zaWRlIGZ1bmN0aW9ucwogICAg
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PQoqLwoKZnVuY3Rpb24gYXJjX3R3aXR0ZXIoJGF0dHMpCnsKICBnbG9iYWwg
JHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVy
U2VjcmV0OwoKICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgJ3VzZXInICAgICAgPT4gJHBy
ZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sCiAgICAncGFzc3dvcmQnICA9PiAnJywKICAgICd0
aW1lbGluZScgID0+ICd1c2VyJywKICAgICdsaW1pdCcgICAgID0+ICcxMCcsCiAgICAnZmV0
Y2gnICAgICA9PiAwLAogICAgJ3JldHdlZXRzJyAgPT4gZmFsc2UsCiAgICAncmVwbGllcycg
ICA9PiB0cnVlLAogICAgJ2RhdGVmb3JtYXQnPT4gJHByZWZzWydhcmNoaXZlX2RhdGVmb3Jt
YXQnXSwKICAgICdjYWNoaW5nJyAgID0+ICcxJywKICAgICdjYWNoZV9kaXInID0+ICRwcmVm
c1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10sCiAgICAnY2FjaGVfdGltZSc9PiAnNScsCiAg
ICAnbGFiZWwnICAgICA9PiAnJywKICAgICdsYWJlbHRhZycgID0+ICcnLAogICAgJ2JyZWFr
JyAgICAgPT4gJ2xpJywKICAgICd3cmFwdGFnJyAgID0+ICcnLAogICAgJ2NsYXNzJyAgICAg
PT4gX19GVU5DVElPTl9fLAogICAgJ2NsYXNzX3Bvc3RlZCcgPT4gX19GVU5DVElPTl9fLict
cG9zdGVkJwogICAgKSwkYXR0cykpOwoKICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJj
X3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3Vt
ZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAgICAgICAg
ICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSk7CgogIGlmICgk
Y2FjaGluZykgeyAgLy8gdHVybiBvbiBjYWNoaW5nLCByZWNvbW1lbmRlZCAoZGVmYXVsdCkK
ICAgICR0d2l0LT5zZXRDYWNoaW5nKHRydWUpOwogICAgJHR3aXQtPmNhY2hlRGlyKCRjYWNo
ZV9kaXIpOwogICAgJHR3aXQtPmNhY2hlVGltZSgkY2FjaGVfdGltZSk7CiAgfSBlbHNlIHsg
IC8vIHR1cm4gb2ZmIGNhY2hpbmcsIG5vdCByZWNvbW1lbmRlZCBvdGhlciB0aGFuIGZvciB0
ZXN0aW5nCiAgICAkdHdpdC0+c2V0Q2FjaGluZyhmYWxzZSk7CiAgfQoKICBzd2l0Y2ggKCR0
aW1lbGluZSkgewogICAgY2FzZSAnaG9tZSc6IGNhc2UgJ2ZyaWVuZHMnOgogICAgICAkdGlt
ZWxpbmUgPSAnc3RhdHVzZXMvZnJpZW5kc190aW1lbGluZSc7IGJyZWFrOwogICAgY2FzZSAn
bWVudGlvbnMnOgogICAgICAkdGltZWxpbmUgPSAnc3RhdHVzZXMvbWVudGlvbnMnOyBicmVh
azsKICAgIGNhc2UgJ3VzZXInOiBkZWZhdWx0OiAkdGltZWxpbmUgPSAnc3RhdHVzZXMvdXNl
cl90aW1lbGluZSc7CiAgfQoKICAvLyBDaGVjayB0aGF0IHRoZSBmZXRjaCAoVHdpdHRlcidz
IGNvdW50IGF0dHJpYnV0ZSkgaXMgc2V0IGNvcnJlY3RseQogICRmZXRjaCA9ICghJGZldGNo
IHx8ICRmZXRjaDwkbGltaXQpID8gJGxpbWl0IDogJGZldGNoOwoKICAkb3V0ID0gYXJyYXko
KTsKICAkeG1sID0gJHR3aXQtPmdldCgkdGltZWxpbmUsIGFycmF5KAogICAgICAnc2NyZWVu
X25hbWUnPT4kdXNlciwKICAgICAgJ2NvdW50Jz0+JGZldGNoLAogICAgICAnaW5jbHVkZV9y
dHMnPT4kcmV0d2VldHMsCiAgICAgICdleGNsdWRlX3JlcGxpZXMnPT4hJHJlcGxpZXMKICAg
ICkpOwogIGlmICgkeG1sKSB7CiAgICAkdHdlZXRzID0gQCR4bWwtPnhwYXRoKCcvc3RhdHVz
ZXMvc3RhdHVzJyk7CiAgICBpZiAoJHR3ZWV0cykgewogICAgICAvLyBBcHBseSB0aGUgZGlz
cGxheSBsaW1pdCB0byB0aGUgcmV0dXJuZWQgdHdlZXRzCiAgICAgICR0d2VldHMgPSBhcnJh
eV9zbGljZSgkdHdlZXRzLCAwLCAkbGltaXQpOwogICAgICBmb3JlYWNoICgkdHdlZXRzIGFz
ICR0d2VldCkgewogICAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGllcygkdHdl
ZXQtPmNyZWF0ZWRfYXQpKTsKICAgICAgICAkZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJGRhdGVm
b3JtYXQsJHRpbWUpOwogICAgICAgICRvdXRbXSA9IGFyY19Ud2l0dGVyOjptYWtlTGlua3Mo
aHRtbGVudGl0aWVzKCR0d2VldC0+dGV4dCwgRU5UX1FVT1RFUywnVVRGLTgnKSkKICAgICAg
ICAgIC4nICcudGFnKGh0bWxlbnRpdGllcygkZGF0ZSksJ3NwYW4nLCcgY2xhc3M9IicuJGNs
YXNzX3Bvc3RlZC4nIicpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGRvTGFiZWwoJGxh
YmVsLCAkbGFiZWx0YWcpLmRvV3JhcCgkb3V0LCAkd3JhcHRhZywgJGJyZWFrLCAkY2xhc3Mp
OwogIH0KCn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3NlYXJjaCgkYXR0cykKewogICAgZ2xv
YmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25z
dW1lclNlY3JldDsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICd1c2VyJyAg
ICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLAogICAgICAgICdzZWFyY2gnICAg
ID0+ICcnLAogICAgICAgICdoYXNodGFncycgID0+ICcnLAogICAgICAgICd1c2VyJyAgICAg
ID0+ICcnLAogICAgICAgICdyZXBseScgICAgID0+ICcnLAogICAgICAgICdtZW50aW9uJyAg
ID0+ICcnLAogICAgICAgICdsaW1pdCcgICAgID0+ICcxMCcsCiAgICAgICAgJ2xhbmcnICAg
ICAgPT4gJycsCiAgICAgICAgJ2RhdGVmb3JtYXQnPT4gJHByZWZzWydhcmNoaXZlX2RhdGVm
b3JtYXQnXSwKICAgICAgICAnY2FjaGluZycgICA9PiAnMScsCiAgICAgICAgJ2NhY2hlX2Rp
cicgPT4gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSwKICAgICAgICAnY2FjaGVf
dGltZSc9PiAnNScsCiAgICAgICAgJ2xhYmVsJyAgICAgPT4gJycsCiAgICAgICAgJ2xhYmVs
dGFnJyAgPT4gJycsCiAgICAgICAgJ2JyZWFrJyAgICAgPT4gJ2xpJywKICAgICAgICAnd3Jh
cHRhZycgICA9PiAnJywKICAgICAgICAnY2xhc3MnICAgICA9PiBfX0ZVTkNUSU9OX18sCiAg
ICAgICAgJ2NsYXNzX3Bvc3RlZCcgPT4gX19GVU5DVElPTl9fLictcG9zdGVkJywKICAgICAg
ICAnY2xhc3NfdXNlcicgICA9PiBfX0ZVTkNUSU9OX18uJy11c2VyJwogICAgKSwkYXR0cykp
OwoKICAgICAgICAkdHdpdCA9IG5ldyBhcmNfVHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3Vt
ZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICAg
ICAgICBpZiAoJGNhY2hpbmcpIHsgIC8vIHR1cm4gb24gY2FjaGluZywgcmVjb21tZW5kZWQg
KGRlZmF1bHQpCiAgICAgICAgICAgICR0d2l0LT5zZXRDYWNoaW5nKHRydWUpOwogICAgICAg
ICAgICAkdHdpdC0+Y2FjaGVEaXIoJGNhY2hlX2Rpcik7CiAgICAgICAgICAgICR0d2l0LT5j
YWNoZVRpbWUoJGNhY2hlX3RpbWUpOwogICAgICAgIH0gZWxzZSB7ICAvLyB0dXJuIG9mZiBj
YWNoaW5nLCBub3QgcmVjb21tZW5kZWQgb3RoZXIgdGhhbiBmb3IgdGVzdGluZwogICAgICAg
ICAgICAkdHdpdC0+c2V0Q2FjaGluZyhmYWxzZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBj
b25zdHJ1Y3Qgc2VhcmNoIHF1ZXJ5CiAgICAgICAgaWYgKCFlbXB0eSgkc2VhcmNoKSkgewog
ICAgICAgICAgICAkdGVybXMgPSBleHBsb2RlKCcsJywkc2VhcmNoKTsgJHRlcm1zID0gYXJy
YXlfbWFwKCd0cmltJywkdGVybXMpOwogICAgICAgICAgICAkc2VhcmNoID0gaW1wbG9kZSgn
ICcsJHRlcm1zKTsKICAgICAgICB9CiAgICAgICAgaWYgKCRoYXNodGFncykgewogICAgICAg
ICAgICAkaGFzaGVzID0gZXhwbG9kZSgnLCcsJGhhc2h0YWdzKTsgJGhhc2hlcyA9IGFycmF5
X21hcCgndHJpbScsJGhhc2hlcyk7CiAgICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gp
PycgJzonJykuJyMnLmltcGxvZGUoJyAjJywkaGFzaGVzKTsKICAgICAgICB9CiAgICAgICAg
aWYgKCRyZXBseSkgewogICAgICAgICAgICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6Jycp
Lid0bzonLnRyaW0oJHJlcGx5KTsKICAgICAgICB9CiAgICAgICAgaWYgKCR1c2VyKSB7CiAg
ICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJ2Zyb206Jy50cmltKCR1
c2VyKTsKICAgICAgICB9CiAgICAgICAgaWYgKCRtZW50aW9uKSB7CiAgICAgICAgICAgICRz
ZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJ0AnLnRyaW0oJG1lbnRpb24pOwogICAgICAg
IH0KCiAgICAgICAgaWYgKGVtcHR5KCRzZWFyY2gpKSB7CiAgICAgICAgICAgIHJldHVybiAn
JzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkc2VhcmNoID0gdXJsZW5jb2RlKCRz
ZWFyY2gpOwogICAgICAgIH0KCiAgICAgICAgJG91dCA9IGFycmF5KCk7CiAgICAgICAgJHR3
ZWV0cyA9ICR0d2l0LT5nZXQoJ2h0dHA6Ly9zZWFyY2gudHdpdHRlci5jb20vc2VhcmNoLmF0
b20/cT0nLiRzZWFyY2gKICAgICAgICAgICAgLCBhcnJheSgncnBwJz0+JGxpbWl0LCdsYW5n
Jz0+JGxhbmcpKTsKCiAgICAgICAgaWYgKCR0d2VldHMpIHsgZm9yZWFjaCAoJHR3ZWV0cy0+
ZW50cnkgYXMgJHR3ZWV0KSB7CiAgICAgICAgICAgIHByZWdfbWF0Y2goIi8oLiopIFwoKC4q
KVwpLyIsJHR3ZWV0LT5hdXRob3ItPm5hbWUsJG1hdGNoZXMpOwogICAgICAgICAgICBsaXN0
KCRhdXRob3IsJHVuYW1lLCRuYW1lKSA9ICRtYXRjaGVzOwogICAgICAgICAgICAkdGltZSA9
IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5wdWJsaXNoZWQpKTsKICAgICAgICAg
ICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRkYXRlZm9ybWF0LCR0aW1lKTsKICAgICAgICAg
ICAgJHRleHQgPSAkdHdlZXQtPnRpdGxlOwogICAgICAgICAgICAkb3V0W10gPSB0YWcoaHJl
ZihodG1sZW50aXRpZXMoJHVuYW1lKSwkdHdlZXQtPmF1dGhvci0+dXJpLAogICAgICAgICAg
ICAgICAgJyB0aXRsZT0iJy5odG1sZW50aXRpZXMoJG5hbWUpLiciJykuJzogJywnc3BhbicK
ICAgICAgICAgICAgICAgICAgICAsJyBjbGFzcz0iJy4kY2xhc3NfdXNlci4nIicpCiAgICAg
ICAgICAgICAgICAuYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcyhodG1sZW50aXRpZXMoJHRleHQs
IEVOVF9RVU9URVMsJ1VURi04JykpCiAgICAgICAgICAgICAgICAuJyAnLnRhZyhodG1sZW50
aXRpZXMoJGRhdGUpLCdzcGFuJwogICAgICAgICAgICAgICAgICAgICwnIGNsYXNzPSInLiRj
bGFzc19wb3N0ZWQuJyInKTsKICAgICAgICB9IHJldHVybiBkb0xhYmVsKCRsYWJlbCwgJGxh
YmVsdGFnKQogICAgICAgICAgICAuZG9XcmFwKCRvdXQsICR3cmFwdGFnLCAkYnJlYWssICRj
bGFzcyk7IH0KCn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0KCRhdHRzKSB7CiAgICBn
bG9iYWwgJHRoaXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICdp
ZCcgICAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAgICAgICdpbmNsdWRlX3Vy
bCcgICA9PiB0cnVlCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRpZCkgewogICAgICAvLyBG
ZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2Vl
dCA9ICgkaW5jbHVkZV91cmwpID8gc2FmZV9yb3coInR3ZWV0IiwgJ2FyY190d2l0dGVyJywg
ImFydGljbGVfaWQ9eyRpZH0iKQogICAgICAgIDogc2FmZV9yb3coIlJFUExBQ0UodHdlZXQs
Q09OQ0FUKCcgJyx0aW55dXJsKSwnJykgQVMgdHdlZXQiCiAgICAgICAgICAsICdhcmNfdHdp
dHRlcicsICJhcnRpY2xlX2lkPXskaWR9Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsndHdl
ZXQnXSkgewogICAgICByZXR1cm4gYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcygKICAgICAgICBo
dG1sZW50aXRpZXMoJHR3ZWV0Wyd0d2VldCddLCBFTlRfUVVPVEVTLCdVVEYtOCcpKTsKICAg
IH0KfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdHdlZXRfdXJsKCRhdHRzLCAkdGhpbmc9bnVs
bCkgewogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZSwkcHJlZnM7CgogICAgZXh0cmFjdChsQXR0
cyhhcnJheSgKICAgICAgJ2lkJyAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAg
ICAgICd0aXRsZScgICA9PiAnJywKICAgICAgJ2NsYXNzJyAgID0+ICcnCiAgICApLCRhdHRz
KSk7CgogICAgaWYgKCRpZCkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0
byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2VldCA9IHNhZmVfcm93KCJ0d2VldF9pZCIK
ICAgICAgICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXskaWR9Iik7CiAgICB9Cgog
ICAgaWYgKCR0d2VldFsndHdlZXRfaWQnXSkgewogICAgICAkdXJsID0gImh0dHA6Ly90d2l0
dGVyLmNvbS8iLiRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLiIvc3RhdHVzLyIuJHR3ZWV0
Wyd0d2VldF9pZCddOwogICAgICBpZiAoJHRoaW5nPT09bnVsbCkgewogICAgICAgIHJldHVy
biAkdXJsOwogICAgICB9CiAgICAgIHJldHVybiBocmVmKHBhcnNlKCR0aGluZyksICR1cmws
CiAgICAgICAgKCR0aXRsZSA/ICcgdGl0bGU9IicuJHRpdGxlLiciJyA6ICcnKQogICAgICAg
IC4oJGNsYXNzID8gJyBjbGFzcz0iJy4kY2xhc3MuJyInIDogJycpKTsKICAgIH0KfQoKZnVu
Y3Rpb24gYXJjX3R3aXR0ZXJfdGlueXVybCgkYXR0cywgJHRoaW5nPW51bGwpIHsKICAgIGds
b2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgJ2lk
JyAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAgICAgICd0aXRsZScgICA9PiAn
JywKICAgICAgJ2NsYXNzJyAgID0+ICcnCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRpZCkg
ewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9t
CiAgICAgICR0d2VldCA9IHNhZmVfcm93KCJ0aW55dXJsIgogICAgICAgICwgJ2FyY190d2l0
dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0aW55
dXJsJ10pIHsKICAgICAgaWYgKCR0aGluZz09PW51bGwpIHsKICAgICAgICByZXR1cm4gJHR3
ZWV0Wyd0aW55dXJsJ107CiAgICAgIH0KCiAgICAgIHJldHVybiBocmVmKHBhcnNlKCR0aGlu
ZyksICR0d2VldFsndGlueXVybCddLAogICAgICAgICgkdGl0bGUgPyAnIHRpdGxlPSInLiR0
aXRsZS4nIicgOiAnJykKICAgICAgICAuKCRjbGFzcyA/ICcgY2xhc3M9IicuJGNsYXNzLici
JyA6ICcnKSk7CiAgICB9Cn0KCi8qCiAqIFB1YmxpYyB0YWcgZm9yIG91dHB1dHRpbmcgd2lk
Z2V0IEpTCiAqLwpmdW5jdGlvbiBhcmNfdHdpdHRlcl93aWRnZXRfanMoJGF0dHMpCnsKICBl
eHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICdvcHRpbWlzZScgPT4gZmFsc2UKICAgICks
JGF0dHMpKTsKCiAgcmV0dXJuIF9hcmNfdHdpdHRlcl93aWRnZXRfanMoJG9wdGltaXNlKTsK
fQoKZnVuY3Rpb24gX2FyY190d2l0dGVyX3dpZGdldF9qcygkb3B0aW1pc2U9dHJ1ZSkKewog
IGdsb2JhbCAkYXJjX3R3aXR0ZXI7CgogIC8vIENoZWNrIGlmIHdpZGdldCBKUyBoYXMgYWxy
ZWFkeSBiZWVuIG91dHB1dAogIGlmICgkYXJjX3R3aXR0ZXJbJ3dpZGdldF9qcyddKSByZXR1
cm47CgogIGlmICgkb3B0aW1pc2U9PWZhbHNlKSB7CiAgICByZXR1cm4gJzxzY3JpcHQgc3Jj
PSJodHRwOi8vcGxhdGZvcm0udHdpdHRlci5jb20vd2lkZ2V0cy5qcyIgdHlwZT0idGV4dC9q
YXZhc2NyaXB0Ij48L3NjcmlwdD4nOwogIH0KCiAgJGpzID0gPDw8SlMKPHNjcmlwdCB0eXBl
PSJ0ZXh0L2phdmFzY3JpcHQiPgooZnVuY3Rpb24oKSB7CiAgaWYgKHdpbmRvdy5fX3R3aXR0
ZXJJbnRlbnRIYW5kbGVyKSByZXR1cm47CiAgdmFyIGludGVudFJlZ2V4ID0gL3R3aXR0ZXJc
LmNvbShcOlxkezIsNH0pP1wvaW50ZW50XC8oXHcrKS8sCiAgICAgIHdpbmRvd09wdGlvbnMg
PSAnc2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPXllcyx0b29sYmFyPW5vLGxvY2F0aW9uPXll
cycsCiAgICAgIHdpZHRoID0gNTUwLAogICAgICBoZWlnaHQgPSA0MjAsCiAgICAgIHdpbkhl
aWdodCA9IHNjcmVlbi5oZWlnaHQsCiAgICAgIHdpbldpZHRoID0gc2NyZWVuLndpZHRoOwoK
ICBmdW5jdGlvbiBoYW5kbGVJbnRlbnQoZSkgewogICAgZSA9IGUgfHwgd2luZG93LmV2ZW50
OwogICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudCwKICAgICAgICBt
LCBsZWZ0LCB0b3A7CgogICAgd2hpbGUgKHRhcmdldCAmJiB0YXJnZXQubm9kZU5hbWUudG9M
b3dlckNhc2UoKSAhPT0gJ2EnKSB7CiAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2Rl
OwogICAgfQoKICAgIGlmICh0YXJnZXQgJiYgdGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNl
KCkgPT09ICdhJyAmJiB0YXJnZXQuaHJlZikgewogICAgICBtID0gdGFyZ2V0LmhyZWYubWF0
Y2goaW50ZW50UmVnZXgpOwogICAgICBpZiAobSkgewogICAgICAgIGxlZnQgPSBNYXRoLnJv
dW5kKCh3aW5XaWR0aCAvIDIpIC0gKHdpZHRoIC8gMikpOwogICAgICAgIHRvcCA9IDA7Cgog
ICAgICAgIGlmICh3aW5IZWlnaHQgPiBoZWlnaHQpIHsKICAgICAgICAgIHRvcCA9IE1hdGgu
cm91bmQoKHdpbkhlaWdodCAvIDIpIC0gKGhlaWdodCAvIDIpKTsKICAgICAgICB9CgogICAg
ICAgIHdpbmRvdy5vcGVuKHRhcmdldC5ocmVmLCAnaW50ZW50Jywgd2luZG93T3B0aW9ucyAr
ICcsd2lkdGg9JyArIHdpZHRoICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICcsaGVpZ2h0PScgKyBoZWlnaHQgKyAnLGxlZnQ9JyArIGxlZnQgKyAnLHRv
cD0nICsgdG9wKTsKICAgICAgICBlLnJldHVyblZhbHVlID0gZmFsc2U7CiAgICAgICAgZS5w
cmV2ZW50RGVmYXVsdCAmJiBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0KICAgIH0KICB9
CgogIGlmIChkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKSB7CiAgICBkb2N1bWVudC5hZGRF
dmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUludGVudCwgZmFsc2UpOwogIH0gZWxzZSBp
ZiAoZG9jdW1lbnQuYXR0YWNoRXZlbnQpIHsKICAgIGRvY3VtZW50LmF0dGFjaEV2ZW50KCdv
bmNsaWNrJywgaGFuZGxlSW50ZW50KTsKICB9CiAgd2luZG93Ll9fdHdpdHRlckludGVudEhh
bmRsZXIgPSB0cnVlOwp9KCkpOwo8L3NjcmlwdD4KSlM7CiAgJGFyY190d2l0dGVyWyd3aWRn
ZXRfanMnXSA9IHRydWU7CiAgcmV0dXJuICRqczsKfQoKLy8gRGVwcmVjYXRlZCBhcmNfdHdp
dHRlcl9yZXR3ZWV0IHRhZywgdXNlIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbiBpbnN0ZWFk
CmZ1bmN0aW9uIGFyY190d2l0dGVyX3JldHdlZXQoJGF0dHMsICR0aGluZz1udWxsKQp7CiAg
cmV0dXJuIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbigkYXR0cywgJHRoaW5nPW51bGwpOwp9
CmZ1bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbigkYXR0cywgJHRoaW5nPW51bGwp
CnsKICAgIGdsb2JhbCAkcHJlZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3
aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlOwoKICAgIGV4
dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICAgJ3VzZXInICAgICAgICA9PiAkcHJlZnNbJ2Fy
Y190d2l0dGVyX3VzZXInXSwgLy8gdmlhIHVzZXIgYWNjb3VudAogICAgICAgICd1cmwnICAg
ICAgICAgPT4gJycsCiAgICAgICAgJ3RleHQnICAgICAgICA9PiAnJywKICAgICAgICAnZm9s
bG93MScgICAgID0+ICcnLAogICAgICAgICdmb2xsb3cyJyAgICAgPT4gJycsCiAgICAgICAg
J2xhbmcnICAgICAgICA9PiAnJywKICAgICAgICAnY291bnQnICAgICAgID0+ICdob3Jpem9u
dGFsJywKICAgICAgICAnaW5jbHVkZV9qcycgID0+IHRydWUsCiAgICAgICAgJ29wdGltaXNl
X2pzJyA9PiBmYWxzZSwKICAgICAgICAnd3JhcHRhZycgICAgID0+ICcnLAogICAgICAgICdj
bGFzcycgICAgICAgPT4gJ3R3aXR0ZXItc2hhcmUtYnV0dG9uJwogICAgKSwkYXR0cykpOwoK
ICAgICRxID0gJyc7IC8vIHF1ZXJ5IHN0cmluZwoKICAgIGlmICgkaWQ9JHRoaXNhcnRpY2xl
Wyd0aGlzaWQnXSkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWls
ZCB0d2VldCBmcm9tCiAgICAgICRyb3cgPSBzYWZlX3JvdygiUkVQTEFDRSh0d2VldCxDT05D
QVQoJyAnLHRpbnl1cmwpLCcnKSBBUyB0d2VldCx0aW55dXJsIgogICAgICAgICwgJ2FyY190
d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKCiAgICAgIGlmICgkdXJsPT0nJykgewog
ICAgICAgICR1cmwgPSAoJHVybCkgPyAkdXJsIDogcGVybWxpbmt1cmwoJHRoaXNhcnRpY2xl
KTsKICAgICAgICAkcSA9ICd1cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAgIH0KICAgICAg
aWYgKCR0ZXh0PT0nJykgewogICAgICAgICR0ZXh0ID0gKCRyb3dbJ3R3ZWV0J10pID8gJHJv
d1sndHdlZXQnXSA6ICR0aGlzYXJ0aWNsZVsndGl0bGUnXTsKICAgICAgfQogICAgICAkcSAu
PSAoJHEgPyAnJmFtcDsnIDogJycpLid0ZXh0PScudXJsZW5jb2RlKCR0ZXh0KTsKICAgIH0K
ICAgIGlmICgkdXNlcikgewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLid2aWE9
Jy51cmxlbmNvZGUoJHVzZXIpOwogICAgfQogICAgaWYgKCRmb2xsb3cxJiYkZm9sbG93Mikg
ewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidyZWxhdGVkPScudXJsZW5jb2Rl
KCRmb2xsb3cxLic6Jy4kZm9sbG93Mik7CiAgICB9IGVsc2VpZiAoJGZvbGxvdzF8fCRmb2xs
b3cyKSB7CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ3JlbGF0ZWQ9Jy51cmxl
bmNvZGUoJGZvbGxvdzEuJGZvbGxvdzIpOwogICAgfQoKICAgIHN3aXRjaCAoJGxhbmcpIHsK
ICAgICAgY2FzZSAnZnInOiBicmVhazsgY2FzZSAnZGUnOiBicmVhazsgY2FzZSAnZXMnOiBi
cmVhazsgY2FzZSAnanAnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICAkbGFuZyA9
ICdlbic7CiAgICB9CiAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidsYW5nPScudXJs
ZW5jb2RlKCRsYW5nKTsKCiAgICBzd2l0Y2ggKCRjb3VudCkgewogICAgICBjYXNlICdub25l
JzogYnJlYWs7IGNhc2UgJ3ZlcnRpY2FsJzogYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAg
ICAgJGNvdW50ID0gJ2hvcml6b250YWwnOwogICAgfQogICAgJHEgLj0gKCRxID8gJyZhbXA7
JyA6ICcnKS4nY291bnQ9Jy51cmxlbmNvZGUoJGNvdW50KTsKCiAgICAkdGhpbmcgPSAoJHRo
aW5nPT09bnVsbCkgPyAnVHdlZXQnIDogcGFyc2UoJHRoaW5nKTsKCiAgICAkaHRtbCA9IGhy
ZWYoJHRoaW5nLCdodHRwOi8vdHdpdHRlci5jb20vc2hhcmU/Jy4kcQogICAgICAsICcgY2xh
c3M9IicuJGNsYXNzLiciJyk7CgogICAgJGpzID0gKCRpbmNsdWRlX2pzKSA/IF9hcmNfdHdp
dHRlcl93aWRnZXRfanMoJG9wdGltaXNlX2pzP3RydWU6ZmFsc2UpIDogJyc7CgogICAgcmV0
dXJuICRqcy4kaHRtbDsKfQoKLyoKICogVHdpdHRlciBGb2xsb3cgYnV0dG9uCiAqLwpmdW5j
dGlvbiBhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uKCRhdHRzLCAkdGhpbmc9bnVsbCkKewog
ICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRl
cl9jb25zdW1lclNlY3JldDsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFj
dChsQXR0cyhhcnJheSgKICAgICAgICAndXNlcicgICAgICAgID0+ICRwcmVmc1snYXJjX3R3
aXR0ZXJfdXNlciddLCAvLyB2aWEgdXNlciBhY2NvdW50CiAgICAgICAgJ2xhbmcnICAgICAg
ICA9PiAnJywKICAgICAgICAnY291bnQnICAgICAgID0+IHRydWUsCiAgICAgICAgJ2luY2x1
ZGVfanMnICA9PiB0cnVlLAogICAgICAgICdvcHRpbWlzZV9qcycgPT4gZmFsc2UsCiAgICAg
ICAgJ2NsYXNzJyAgICAgICA9PiAndHdpdHRlci1mb2xsb3ctYnV0dG9uJwogICAgKSwkYXR0
cykpOwoKICAgICRhdHRzID0gJyc7IC8vIGRhdGEgYXR0cmlidXRlcwoKICAgIHN3aXRjaCAo
JGxhbmcpIHsKICAgICAgY2FzZSAnZnInOiBicmVhazsgY2FzZSAnZGUnOiBicmVhazsgY2Fz
ZSAnZXMnOiBicmVhazsgY2FzZSAnanAnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAg
ICAkbGFuZyA9ICdlbic7CiAgICB9CiAgICAkYXR0cyAuPSAnIGRhdGEtbGFuZz0iJy51cmxl
bmNvZGUoJGxhbmcpLiciJzsKCiAgICAkYXR0cyAuPSAnIGRhdGEtc2hvdy1jb3VudD0iJy4o
JGNvdW50Pyd0cnVlJzonZmFsc2UnKS4nIic7CgogICAgJHRoaW5nID0gKCR0aGluZz09PW51
bGwpID8gJ0ZvbGxvdyBAJy4kdXNlciA6IHBhcnNlKCR0aGluZyk7CgogICAgJGh0bWwgPSBo
cmVmKCR0aGluZywnaHR0cDovL3R3aXR0ZXIuY29tLycudXJsZW5jb2RlKCR1c2VyKQogICAg
ICAsICcgY2xhc3M9IicuJGNsYXNzLiciJy4kYXR0cyk7CgogICAgJGpzID0gKCRpbmNsdWRl
X2pzKSA/IF9hcmNfdHdpdHRlcl93aWRnZXRfanMoJG9wdGltaXNlX2pzP3RydWU6ZmFsc2Up
IDogJyc7CgogICAgcmV0dXJuICRqcy4kaHRtbDsKfQoKLyoKICAgIEFkbWluLXNpZGUgZnVu
Y3Rpb25zCiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09CiovCgovLyBJbnN0YWxsYXRpb24gZnVuY3Rpb24gLSBi
dWlsZHMgTXlTUUwgdGFibGUKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfaW5zdGFsbCgpCnsKCiAg
ICAvLyBGb3IgZmlyc3QgaW5zdGFsbCwgY3JlYXRlIHRhYmxlIGZvciB0d2VldHMKICAgICRz
cWwgPSAiQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgIi5QRlguImFyY190d2l0dGVyICI7
CiAgICAkc3FsLj0gIihhcmNfdHdpdHRlcmlkIElOVEVHRVIgQVVUT19JTkNSRU1FTlQgUFJJ
TUFSWSBLRVksCiAgICAgICAgYXJ0aWNsZV9pZCBJTlRFR0VSKDExKSwKICAgICAgICB0d2Vl
dF9pZCBCSUdJTlQoMjApLAogICAgICAgIHR3ZWV0IFZBUkNIQVIoMTQwKSwKICAgICAgICB0
aW55dXJsIFZBUkNIQVIoMzApKTsiOwoKICAgIGlmICghc2FmZV9xdWVyeSgkc3FsKSkgewog
ICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUgdG8gY3JlYXRlIGFyY190d2l0dGVyIHRh
YmxlJzsKICAgIH0KCn0KCi8vIFVuaW5zdGFsbCBmdW5jdGlvbiAtIGRlbGV0ZXMgTXlTUUwg
dGFibGUgYW5kIHJlbGF0ZWQgcHJlZmVyZW5jZXMKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdW5p
bnN0YWxsKCkKewoKICAgICRzcWwgPSAiRFJPUCBUQUJMRSBJRiBFWElTVFMgIi5QRlguImFy
Y190d2l0dGVyOyI7CiAgICBpZiAoIXNhZmVfcXVlcnkoJHNxbCkpIHsKICAgICAgICByZXR1
cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRlbGV0ZSBhcmNfdHdpdHRlciB0YWJsZSc7CiAgICB9
CgogICAgJHNxbCA9ICJERUxFVEUgRlJPTSAgIi5QRlguInR4cF9wcmVmcyBXSEVSRSBldmVu
dD0nYXJjX3R3aXR0ZXInOyI7CiAgICBpZiAoIXNhZmVfcXVlcnkoJHNxbCkpIHsKICAgICAg
ICByZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRlbGV0ZSBhcmNfdHdpdHRlciBwcmVmZXJl
bmNlcyc7CiAgICB9Cgp9CmZ1bmN0aW9uIGFyY190d2l0dGVyX3VybF9tZXRob2Rfc2VsZWN0
KCRuYW1lLCAkdmFsKQp7CiAgICAkbWV0aG9kcyA9IGFycmF5KCd0aW55dXJsJyA9PiAnVGlu
eXVybCcsCiAgICAgICdpc2dkJyA9PiAnSXMuZ2QnLAogICAgICAnYXJjX3R3aXR0ZXInID0+
ICdUWFAgVHdlZXQnLAogICAgICAnc21kJyA9PiAnc21kX3Nob3J0X3VybCcpOwogICAgcmV0
dXJuIHNlbGVjdElucHV0KCRuYW1lLCAkbWV0aG9kcywgJHZhbCk7Cn0KZnVuY3Rpb24gYXJj
X3R3aXR0ZXJfdGFiX3NlbGVjdCgkbmFtZSwgJHZhbCkKewogICAgJHRhYnMgPSBhcnJheSgn
Y29udGVudCcgPT4gJ0NvbnRlbnQnLAogICAgICAgICdleHRlbnNpb25zJyA9PiAnRXh0ZW5z
aW9ucycsCiAgICAgICAgJycgPT4gJ0hpZGRlbicpOwogICAgcmV0dXJuIHNlbGVjdElucHV0
KCRuYW1lLCAkdGFicywgJHZhbCk7Cn0KLy8gUHJvdmlkZSBpbnRlcmZhY2UgZm9yIHNldHRp
bmcgcHJlZmVyZW5jZXMKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfcHJlZnMoJGV2ZW50LCRzdGVw
KQp7CgogICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksJGFyY190
d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgICR1c2VyICAgICAgICAgID0gJHByZWZzWydh
cmNfdHdpdHRlcl91c2VyJ107CiAgICAkcHJlZml4ICAgICAgICA9ICRwcmVmc1snYXJjX3R3
aXR0ZXJfcHJlZml4J107CiAgICAkc3VmZml4ICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0
ZXJfc3VmZml4J107CiAgICAkdHdlZXRfZGVmYXVsdCA9ICRwcmVmc1snYXJjX3R3aXR0ZXJf
dHdlZXRfZGVmYXVsdCddOwogICAgJHVybF9tZXRob2QgICAgPSAkcHJlZnNbJ2FyY190d2l0
dGVyX3VybF9tZXRob2QnXTsKICAgICRzaG9ydF91cmwgICAgID0gJHByZWZzWydhcmNfc2hv
cnRfdXJsJ107CiAgICAkc2hvcnRfc2l0ZV91cmw9ICRwcmVmc1snYXJjX3Nob3J0X3NpdGVf
dXJsJ107CiAgICAkY2FjaGVfZGlyICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVf
ZGlyJ107CiAgICAkdGFiICAgICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ107
CgogICAgc3dpdGNoICgkc3RlcCkgewogICAgICAgIGNhc2UgJ3ByZWZzX3NhdmUnOiBwYWdl
dG9wKCdUWFAgVHdlZXQnLCAnUHJlZmVyZW5jZXMgc2F2ZWQnKTsgYnJlYWs7CiAgICAgICAg
Y2FzZSAncmVnaXN0ZXInOiBwYWdldG9wKCdUWFAgVHdlZXQnLCdDb25uZWN0IHRvIFR3aXR0
ZXInKTsgYnJlYWs7CiAgICAgICAgY2FzZSAndmFsaWRhdGUnOgogICAgICAgIGRlZmF1bHQ6
IHBhZ2V0b3AoJ1RYUCBUd2VldCcpOwogICAgfQoKICAgICRodG1sID0gJyc7CgogICAgaWYg
KCRzdGVwPT0ncmVnaXN0ZXInKSB7IC8vIE9BdXRoIHJlZ2lzdHJhdGlvbiBwcm9jZXNzCiAg
ICAgICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5
CiAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0KTsKCiAgICAgICAg
Ly8gQnVpbGQgYSBjYWxsYmFjayBVUkwgZm9yIFR3aXR0ZXIgdG8gcmV0dXJuIHRvIHRoZSBu
ZXh0IHN0YWdlCiAgICAgICAgJGNhbGxiYWNrVVJMID0gJHR3aXQtPmNhbGxiYWNrVVJMKCRl
dmVudCwndmFsaWRhdGUnKTsKCiAgICAgICAgJHJlcXVlc3QgPSAkdHdpdC0+Z2V0UmVxdWVz
dFRva2VuKCRjYWxsYmFja1VSTCk7CiAgICAgICAgJHJlcXVlc3RfdG9rZW4gPSAkcmVxdWVz
dFsib2F1dGhfdG9rZW4iXTsKICAgICAgICAkcmVxdWVzdF90b2tlbl9zZWNyZXQgPSAkcmVx
dWVzdFsib2F1dGhfdG9rZW5fc2VjcmV0Il07CgogICAgICAgIHNldF9wcmVmKCdhcmNfdHdp
dHRlcl9yZXF1ZXN0VG9rZW4nLCRyZXF1ZXN0X3Rva2VuCiAgICAgICAgICAgICwgJ2FyY190
d2l0dGVyJywyKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2Vu
U2VjcmV0JywkcmVxdWVzdF90b2tlbl9zZWNyZXQKICAgICAgICAgICAgLCAnYXJjX3R3aXR0
ZXInLDIpOwoKICAgICAgICAkaHRtbC49IHN0YXJ0VGFibGUoJ2VkaXQnKS4KICAgICAgICAg
ICAgICAgIHRyKHRkKAogICAgICAgICAgICAgICAgICAgICgnPHA+Jy5ocmVmKCdTaWduLWlu
IHRvIFR3aXR0ZXInCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsJHR3aXQtPmdldEF1
dGhvcml6ZVVSTCgkcmVxdWVzdCkpCiAgICAgICAgICAgICAgICAgICAgICAgIC4nIGFuZCBm
b2xsb3cgdGhlIGluc3RydWN0aW9ucyB0byBhbGxvdyBUWFAgVHdlZXQgdG8gdXNlIHlvdXIg
YWNjb3VudC4gSWYgeW91IGFyZSBhbHJlYWR5IHNpZ25lZCBpbiB0byBUd2l0dGVyIHRoZW4g
dGhhdCBhY2NvdW50IHdpbGwgYmUgYXNzb2NpYXRlZCB3aXRoIFRYUCBUd2VldCBzbyB5b3Ug
bWF5IG5lZWQgdG8gc2lnbiBvdXQgZmlyc3QgaWYgeW91IHdhbnQgdG8gdXNlIGEgZGlmZmVy
ZW50IGFjY291bnQuPC9wPicpCiAgICAgICAgICAgICAgICApKS5lbmRUYWJsZSgpOwogICAg
fSBlbHNlaWYgKCRzdGVwPT0ndmFsaWRhdGUnKSB7CiAgICAgICAgJHR3aXQgPSBuZXcgYXJj
X3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICwgJGFyY190
d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tl
biddCiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW5TZWNy
ZXQnXSk7CiAgICAgICAgLy8gQXNrIFR3aXR0ZXIgZm9yIGFuIGFjY2VzcyB0b2tlbiAoYW5k
IGFuIGFjY2VzcyB0b2tlbiBzZWNyZXQpCiAgICAgICAgJHJlcXVlc3QgPSAkdHdpdC0+Z2V0
QWNjZXNzVG9rZW4oIGdwcygnb2F1dGhfdmVyaWZpZXInKSApOwogICAgICAgICRhY2Nlc3Nf
dG9rZW4gPSAkcmVxdWVzdFsnb2F1dGhfdG9rZW4nXTsKICAgICAgICAkYWNjZXNzX3Rva2Vu
X3NlY3JldCA9ICRyZXF1ZXN0WydvYXV0aF90b2tlbl9zZWNyZXQnXTsKICAgICAgICAkdXNl
ciA9ICRyZXF1ZXN0WydzY3JlZW5fbmFtZSddOwogICAgICAgIC8vIFN0b3JlIHRoZSBhY2Nl
c3MgdG9rZW4gYW5kIHNlY3JldAogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9hY2Nl
c3NUb2tlbicsJGFjY2Vzc190b2tlbiwgJ2FyY190d2l0dGVyJywyKTsKICAgICAgICBzZXRf
cHJlZignYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnLCRhY2Nlc3NfdG9rZW5fc2Vj
cmV0CiAgICAgICAgICAgICwgJ2FyY190d2l0dGVyJywyKTsKICAgICAgICBzZXRfcHJlZign
YXJjX3R3aXR0ZXJfdXNlcicsJHVzZXIpOwogICAgICAgICRwcmVmc1snYXJjX3R3aXR0ZXJf
YWNjZXNzVG9rZW4nXSA9ICRhY2Nlc3NfdG9rZW47CiAgICAgICAgJHByZWZzWydhcmNfdHdp
dHRlcl9hY2Nlc3NUb2tlblNlY3JldCddID0gJGFjY2Vzc190b2tlbl9zZWNyZXQ7CiAgICAg
ICAgdW5zZXQoJHR3aXQpOwogICAgfQoKICAgIGlmICgkc3RlcD09InByZWZzX3NhdmUiKSB7
CiAgICAgICAgJHByZWZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7CiAg
ICAgICAgJHN1ZmZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9zdWZmaXgnKSk7CiAgICAg
ICAgJHR3ZWV0X2RlZmF1bHQgPSBncHMoJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnKTsK
ICAgICAgICAkdXJsX21ldGhvZCA9IGdwcygnYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcpOwog
ICAgICAgICRzaG9ydF91cmwgPSBncHMoJ2FyY19zaG9ydF91cmwnKTsKICAgICAgICAkc2hv
cnRfc2l0ZV91cmwgPSBncHMoJ2FyY19zaG9ydF9zaXRlX3VybCcpOwogICAgICAgICRjYWNo
ZV9kaXIgPSBncHMoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicpOwogICAgICAgICR0YWIgPSBn
cHMoJ2FyY190d2l0dGVyX3RhYicpOwogICAgICAgIGlmIChzdHJsZW4oJHByZWZpeCk8PTIw
KSB7CiAgICAgICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9wcmVmaXgnLCRwcmVmaXgp
OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRwcmVmaXggPSAkcHJlZnNbJ2FyY190
d2l0dGVyX3ByZWZpeCddOwogICAgICAgIH0KICAgICAgICBpZiAoc3RybGVuKCRzdWZmaXgp
PD0yMCkgewogICAgICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfc3VmZml4Jywkc3Vm
Zml4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkc3VmZml4ID0gJHByZWZzWydh
cmNfdHdpdHRlcl9zdWZmaXgnXTsKICAgICAgICB9CiAgICAgICAgJHR3ZWV0X2RlZmF1bHQg
PSAoJHR3ZWV0X2RlZmF1bHQpID8gMSA6IDA7CiAgICAgICAgJHNob3J0X3VybCA9ICgkc2hv
cnRfdXJsKSA/IDEgOiAwOwogICAgICAgIGlmICghJHNob3J0X3NpdGVfdXJsKSAkc2hvcnRf
c2l0ZV91cmwgPSAkcHJlZnNbJ3NpdGV1cmwnXTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3
aXR0ZXJfdHdlZXRfZGVmYXVsdCcsJHR3ZWV0X2RlZmF1bHQpOwogICAgICAgIHNldF9wcmVm
KCdhcmNfc2hvcnRfdXJsJywkc2hvcnRfdXJsKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3
aXR0ZXJfdXJsX21ldGhvZCcsJHVybF9tZXRob2QpOwogICAgICAgIHNldF9wcmVmKCdhcmNf
c2hvcnRfc2l0ZV91cmwnLCRzaG9ydF9zaXRlX3VybCk7CiAgICAgICAgc2V0X3ByZWYoJ2Fy
Y190d2l0dGVyX2NhY2hlX2RpcicsJGNhY2hlX2Rpcik7CiAgICAgICAgc2V0X3ByZWYoJ2Fy
Y190d2l0dGVyX3RhYicsJHRhYik7CiAgICB9CgogICAgaWYgKCAkc3RlcCE9J3JlZ2lzdGVy
JyApIHsKICAgICAgICBpZiAoIGlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9r
ZW4nXSkKICAgICAgICAmJiBpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2Vu
U2VjcmV0J10pICkgewogICAgICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJj
X3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2Nv
bnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10KICAgICAg
ICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKTsK
ICAgICAgICAgICAgJHJlZ2lzdGVyVVJMID0gJHR3aXQtPmNhbGxiYWNrVVJMKCRldmVudCwn
cmVnaXN0ZXInKTsKICAgICAgICAgICAgJGh0bWwuPSBzdGFydFRhYmxlKCdsaXN0JykuZm9y
bSgKICAgICAgICAgICAgICAgIHRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdU
d2l0dGVyIGFjY291bnQgZGV0YWlscycsIDIpLDIpCiAgICAgICAgICAgICAgICApCiAgICAg
ICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJh
cmNfdHdpdHRlcl91c2VyIj5Ud2l0dGVyIHVzZXJuYW1lPC9sYWJlbD4nLAogICAgICAgICAg
ICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxp
Z246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoCiAgICAgICAgICAgICAg
ICAgICAgICAgICgkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkgPwogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgJHVzZXIuJyAoJy5ocmVmKCdSZS1jb25uZWN0JywkcmVnaXN0ZXJV
UkwpLicpJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnPGVtPnVua25vd248L2Vt
PicKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5ocmVmKCdDb25uZWN0IHRvIFR3aXR0
ZXInLCRyZWdpc3RlclVSTCkpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAu
dHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1R3ZWV0IHNldHRpbmdzJywgMiks
MikKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAg
ICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3ByZWZpeCI+VHdlZXQgcHJl
Zml4PC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFs
aWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAg
ICAgICAudGQoZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJfcHJlZml4JywkcHJlZml4LCcn
LCcnLCcnLCcnLCcnLCdhcmNfdHdpdHRlcl9wcmVmaXgnKSkKICAgICAgICAgICAgICAgICku
dHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl9z
dWZmaXgiPlR3ZWV0IHN1ZmZpeDwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAg
JyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7Iicp
CiAgICAgICAgICAgICAgICAgICAgLnRkKGZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX3N1
ZmZpeCcsJHN1ZmZpeCwnJywnJywnJywnJywnJywnYXJjX3R3aXR0ZXJfc3VmZml4JykpCiAg
ICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZv
cj0iYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCI+VHdlZXQgYXJ0aWNsZXMgYnkgZGVmYXVs
dDwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGln
bjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAg
ICAgLnRkKHllc25vUmFkaW8oJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnLCAkdHdlZXRf
ZGVmYXVsdCwgJycsICdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JykpCiAgICAgICAgICAg
ICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3
aXR0ZXJfdXJsX21ldGhvZCI+VVJMIHNob3J0bmVyPC9sYWJlbD4nLAogICAgICAgICAgICAg
ICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246
IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoYXJjX3R3aXR0ZXJfdXJsX21l
dGhvZF9zZWxlY3QoJ2FyY190d2l0dGVyX3VybF9tZXRob2QnLCR1cmxfbWV0aG9kKSkKICAg
ICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1RYUCBU
d2VldCBzaG9ydCBVUkwnLCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAg
ICAgLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3Nob3J0
X3VybCI+RW5hYmxlIFRYUCBUd2VldCBzaG9ydCBVUkwgcmVkaXJlY3Q8L2xhYmVsPicsCiAg
ICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0
aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZCh5ZXNub1Jh
ZGlvKCdhcmNfc2hvcnRfdXJsJywgJHNob3J0X3VybCwgJycsICdhcmNfc2hvcnRfdXJsJykp
LAogICAgICAgICAgICAgICAgICAgICcgaWQ9ImFyY19zaG9ydF91cmwtb25fb2ZmIicKICAg
ICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9y
PSJhcmNfc2hvcnRfc2l0ZV91cmwiPlRYUCBUd2VldCBzaG9ydCBzaXRlIFVSTDwvbGFiZWw+
JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7
IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGZJ
bnB1dCgndGV4dCcsJ2FyY19zaG9ydF9zaXRlX3VybCcsJHNob3J0X3NpdGVfdXJsLCcnLCcn
LCcnLCcnLCcnLCdhcmNfc2hvcnRfc2l0ZV91cmwnKSksCiAgICAgICAgICAgICAgICAgICAg
JyBpZD0iYXJjX3Nob3J0X3NpdGVfdXJsLW9wdGlvbiInCiAgICAgICAgICAgICAgICApLnRy
KAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdUd2l0dGVyIHRhYicsIDIpLDIpCiAg
ICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZv
cj0iYXJjX3R3aXR0ZXJfdGFiIj5Mb2NhdGlvbiBvZiBUd2l0dGVyIHRhYjwvbGFiZWw+JywK
ICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZl
cnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGFyY190
d2l0dGVyX3RhYl9zZWxlY3QoJ2FyY190d2l0dGVyX3RhYicsJHRhYikpCiAgICAgICAgICAg
ICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdDYWNoZScsIDIpLDIp
CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAg
ICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl9jYWNoZV9kaXIiPkNhY2hlIGRp
cmVjdG9yeTwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4
dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAg
ICAgICAgICAgLnRkKGZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX2NhY2hlX2RpcicsJGNh
Y2hlX2RpciwnJywnJywnJywnJywnJywnYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJykpCiAgICAg
ICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAg
dGRhKAogICAgICAgICAgICAgICAgICAgICAgICBmSW5wdXQoJ3N1Ym1pdCcsICdTdWJtaXQn
LCBnVHh0KCdzYXZlX2J1dHRvbicpLCAncHVibGlzaCcpCiAgICAgICAgICAgICAgICAgICAg
ICAgIC5uLnNJbnB1dCgncHJlZnNfc2F2ZScpCiAgICAgICAgICAgICAgICAgICAgICAgIC5u
LmVJbnB1dCgncGx1Z2luX3ByZWZzLmFyY190d2l0dGVyJykKICAgICAgICAgICAgICAgICAg
ICAsICcgY29sc3Bhbj0iMiIgY2xhc3M9Im5vbGluZSInKSkpCiAgICAgICAgICAgICAgICAu
ZW5kVGFibGUoKTsKICAgICAgICB9IGVsc2VpZiAoICRzdGVwIT0ncmVnaXN0ZXInICkgewog
ICAgICAgICAgICAkcmVnaXN0ZXJVUkwgPSBhcmNfdHdpdHRlcjo6Y2FsbGJhY2tVUkwoJGV2
ZW50LCdyZWdpc3RlcicpOwogICAgICAgICAgICAkaHRtbC49IHN0YXJ0VGFibGUoJ2xpc3Qn
KS5mb3JtKAogICAgICAgICAgICAgICAgdHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyho
ZWQoJ1R3aXR0ZXIgYWNjb3VudCBkZXRhaWxzJywgMiksMikKICAgICAgICAgICAgICAgICkK
ICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBm
b3I9ImFyY190d2l0dGVyX3VzZXIiPlR3aXR0ZXIgdXNlcm5hbWU8L2xhYmVsPicsCiAgICAg
ICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNh
bC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZCgKICAgICAgICAg
ICAgICAgICAgICAgICAgKCc8ZW0+dW5rbm93bjwvZW0+ICgnCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAuaHJlZignQ29ubmVjdCB0byBUd2l0dGVyJywkcmVnaXN0ZXJVUkwpLicp
JykKICAgICAgICAgICAgICAgICkpKQogICAgICAgICAgICAgICAgLmVuZFRhYmxlKCk7CiAg
ICAgICAgfQogICAgfQoKICAgIC8vIFNldCBqUXVlcnkgZm9yIHN3aXRjaGluZyBvbi9vZmYg
cmVsZXZhbnQgYXJjX3Nob3J0X3VybCBmaWVsZHMKICAgICRqcyA9IDw8PEpTCjxzY3JpcHQg
bGFuZ3VhZ2U9ImphdmFzY3JpcHQiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiQoZG9jdW1l
bnQpLnJlYWR5KGZ1bmN0aW9uKCl7CiAgdmFyIG9ub2ZmID0gJCgnI2FyY19zaG9ydF91cmwt
b25fb2ZmJyk7CiAgdmFyIGFyY19zaG9ydF91cmxfb2ZmID0gJCgnI2FyY19zaG9ydF91cmwt
YXJjX3Nob3J0X3VybC0wJyk7CiAgdmFyIHVybCA9ICQoJyNhcmNfc2hvcnRfc2l0ZV91cmwt
b3B0aW9uJyk7CiAgdmFyIHVybF9tZXRob2QgPSAkKCdzZWxlY3RbbmFtZT0iYXJjX3R3aXR0
ZXJfdXJsX21ldGhvZCJdJyk7CgogIGlmIChhcmNfc2hvcnRfdXJsX29mZi5hdHRyKCdjaGVj
a2VkJyk9PXRydWUKICAmJiAkKCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwo
KSE9J2FyY190d2l0dGVyJykgewogICAgdXJsLmhpZGUoKTsKICB9CiAgJCgnaW5wdXQnLCBv
bm9mZikuY2hhbmdlKGZ1bmN0aW9uKCl7CiAgICBpZiAoJCgnb3B0aW9uOnNlbGVjdGVkJywg
dXJsX21ldGhvZCkudmFsKCkhPSdhcmNfdHdpdHRlcicpIHsKICAgICAgYXJjX3Nob3J0X3Vy
bF9vZmYuYXR0cignY2hlY2tlZCcpPT10cnVlID8gdXJsLmhpZGUoKSA6IHVybC5zaG93KCk7
CiAgICB9CiAgfSk7CgogIGlmICgkKCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52
YWwoKT09J2FyY190d2l0dGVyJykgewogICAgb25vZmYuaGlkZSgpOyB1cmwuc2hvdygpOwog
IH0KICB1cmxfbWV0aG9kLmNoYW5nZShmdW5jdGlvbigpewogICAgaWYgKCQoJ29wdGlvbjpz
ZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpPT0nYXJjX3R3aXR0ZXInKSB7CiAgICAgIG9u
b2ZmLnRvZ2dsZSgpOyB1cmwuc2hvdygpOwogICAgfSBlbHNlIHsKICAgICAgb25vZmYudG9n
Z2xlKCk7CiAgICAgIGFyY19zaG9ydF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09dHJ1ZSA/
IHVybC5oaWRlKCkgOiB1cmwuc2hvdygpOwogICAgfQogIH0pCn0pOwo8L3NjcmlwdD4KSlM7
CgogICAgZWNobyAkanMuJGh0bWw7Cn0KCi8vIEFkZCBUd2l0dGVyIHRhYiB0byBUZXh0cGF0
dGVybgpmdW5jdGlvbiBhcmNfYWRtaW5fdHdpdHRlcigkZXZlbnQsJHN0ZXApCnsKICAgIGds
b2JhbCAkcHJlZnMsICRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2Nv
bnN1bWVyU2VjcmV0OwoKICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRl
cl9jb25zdW1lcktleQogICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3Jl
dCwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddCiAgICAgICAgICAgICwgJHBy
ZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKTsKCiAgICAkdHdpdC0+Y2Fj
aGVEaXIoJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSk7CgogICAgJHhtbCA9ICR0
d2l0LT5nZXQoJ3VzZXJzL3Nob3cnCiAgICAgICAgLCBhcnJheSgnc2NyZWVuX25hbWUnPT4k
cHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkpOwogICAgJHR3aXR0ZXJVc2VyID0gQCR4bWwt
PnhwYXRoKCcvdXNlcicpOwogICAgJHR3aXR0ZXJVc2VyID0gJHR3aXR0ZXJVc2VyWzBdOwog
ICAgJHR3aXR0ZXJVc2VyVVJMID0gJ2h0dHA6Ly93d3cudHdpdHRlci5jb20vJy4kdHdpdHRl
clVzZXItPnNjcmVlbl9uYW1lOwoKICAgIGlmICgkc3RlcD09InR3ZWV0IikgeyAvLyBwb3N0
IGFuIHVwZGF0ZSB0byBUd2l0dGVyCgogICAgICAgIC8vIGZldGNoIGFuZCBjbGVhbiBtZXNz
YWdlCiAgICAgICAgJG1lc3NhZ2UgPSBzdHJpcF90YWdzKGdwcygnbWVzc2FnZScpKTsKICAg
ICAgICAkY291bnQgPSBzdHJsZW4oJG1lc3NhZ2UpOwoKICAgICAgICBpZiAoJGNvdW50PD0x
NDAgJiYgJGNvdW50PjApIHsgLy8gcG9zdCB1cGRhdGUKICAgICAgICAgICAgJHJlc3VsdCA9
ICR0d2l0LT5wb3N0KCdzdGF0dXNlcy91cGRhdGUnLCBhcnJheSgnc3RhdHVzJyA9PiAkbWVz
c2FnZSkpOwogICAgICAgIH0gZWxzZSB7IC8vIG1lc3NhZ2UgdG9vIGxvbmcsIEphdmFTY3Jp
cHQgaW50ZXJmYWNlIHNob3VsZCBwcmV2ZW50IHRoaXMKICAgICAgICAgICAgJHJlc3VsdCA9
IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcGFnZXRvcCgnVHdpdHRlcicsCiAgICAgICAg
ICAgICgoJHJlc3VsdCE9ZmFsc2UpPydUd2l0dGVyIHVwZGF0ZWQnOidFcnJvciB1cGRhdGlu
ZyBUd2l0dGVyJykpOwoKICAgIH0gZWxzZWlmICgkc3RlcD09ImRlbGV0ZSIpIHsgLy8gZGVs
ZXRlIGFuIHVwZGF0ZSBmcm9tIFR3aXR0ZXIKCiAgICAgICAgJGlkID0gc3RyaXBfdGFncyhn
cHMoJ2lkJykpOwogICAgICAgIGlmICgkaWQpIHsKICAgICAgICAgICAgJHR3aXQtPmRlbGV0
ZSgnc3RhdHVzZXMvZGVzdHJveScuJGlkKTsKICAgICAgICAgICAgc2FmZV9kZWxldGUoJ2Fy
Y190d2l0dGVyJywidHdlZXRfaWQgPSAkaWQiKTsKICAgICAgICB9CgogICAgICAgIHBhZ2V0
b3AoJ1R3aXR0ZXInLCdUd2l0dGVyIHVwZGF0ZWQnKTsKCiAgICB9IGVsc2UgewoKICAgICAg
ICBwYWdldG9wKCdUd2l0dGVyJyk7CgogICAgfQoKICAgIC8vIFByZXBhcmUgSmF2YVNjcmlw
dCB0byBjcmVhdGUgVHdpdHRlciB1cGRhdGUgaW50ZXJmYWNlCgogICAgJGpzID0gJzxzY3Jp
cHQgbGFuZ3VhZ2U9ImphdmFzY3JpcHQiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+JzsKICAg
ICRqcy49ICIkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpewogICAgICAgICAgICB2YXIg
Y291bnRlclN0eWxlID0gJ2ZvbnQtd2VpZ2h0OmJvbGQ7ZmxvYXQ6cmlnaHQ7Zm9udC1zaXpl
OjJlbTtsaW5lLWhlaWdodDoxLjJlbTsnOwogICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcp
LmF0dHIoJ3N0eWxlJywgY291bnRlclN0eWxlKydjb2xvcjojY2NjOycpOwogICAgICAgICAg
ICAkKCcjbWVzc2FnZScpLmtleXVwKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFy
IGNvdW50ID0gMTQwLSQoJyNtZXNzYWdlJykudmFsKCkubGVuZ3RoOwogICAgICAgICAgICAg
ICAgJCgnI3R3ZWV0Y291bnQnKS5odG1sKGNvdW50KycnKTsgLy8gaGFjayB0byBmb3JjZSBv
dXRwdXQgb2YgMAogICAgICAgICAgICAgICAgaWYgKGNvdW50PDApIHsKICAgICAgICAgICAg
ICAgICAgICAkKCdpbnB1dC5wdWJsaXNoJykuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQn
KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJCgnaW5w
dXQucHVibGlzaCcpLmF0dHIoJ2Rpc2FibGVkJywgJycpOwogICAgICAgICAgICAgICAgfQog
ICAgICAgICAgICAgICAgaWYgKGNvdW50PDApIHsKICAgICAgICAgICAgICAgICAgICAkKCcj
dHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRlclN0eWxlKydjb2xvcjojZjAwOycp
OwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudDwxMCkgewogICAgICAgICAgICAg
ICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2Nv
bG9yOiMwMDA7Jyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg
ICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9y
OiNjY2M7Jyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfSk7
IjsKICAgICRqcy49ICI8L3NjcmlwdD4iOwoKICAgICRvdXQgPSAnJzsKICAgICR4bWwgPSAk
dHdpdC0+Z2V0KCdzdGF0dXNlcy91c2VyX3RpbWVsaW5lJwogICAgICAgICwgYXJyYXkoJ3Nj
cmVlbl9uYW1lJz0+JHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sJ2NvdW50Jz0+MjUpKTsK
ICAgICR0d2VldHMgPSBAJHhtbC0+eHBhdGgoJy9zdGF0dXNlcy9zdGF0dXMnKTsKICAgIGlm
ICgkdHdlZXRzKSBmb3JlYWNoICgkdHdlZXRzIGFzICR0d2VldCkgewogICAgICAgICR0aW1l
ID0gc3RydG90aW1lKGh0bWxlbnRpdGllcygkdHdlZXQtPmNyZWF0ZWRfYXQpKTsKICAgICAg
ICAkZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJHByZWZzWydhcmNoaXZlX2RhdGVmb3JtYXQnXSwk
dGltZSk7CiAgICAgICAgJG91dC49IHRyKHRkKCRkYXRlLCdzcGFuJykKICAgICAgICAgICAg
LnRkKGFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVudGl0aWVzKCR0d2VldC0+dGV4dAog
ICAgICAgICAgICAgICAgLCBFTlRfUVVPVEVTLCdVVEYtOCcpKSkKICAgICAgICAgICAgLnRk
KGRMaW5rKCdhcmNfYWRtaW5fdHdpdHRlcicsJ2RlbGV0ZScsJ2lkJywkdHdlZXQtPmlkLCcn
KSkKICAgICAgICAgICAgKTsKICAgIH0KCiAgICAkaHRtbCA9IHN0YXJ0VGFibGUoJ2VkaXQn
KQogICAgICAgICAgICAudHIodGQoCiAgICAgICAgICAgIGdyYWYoJzxpbWcgc3JjPSInLiR0
d2l0dGVyVXNlci0+cHJvZmlsZV9pbWFnZV91cmwuJyIgYWx0PSJUd2l0dGVyIGF2YXRhciIg
Lz4nCiAgICAgICAgICAgICwnIHN0eWxlPSJmbG9hdDpsZWZ0O3BhZGRpbmc6MnB4OyInKQog
ICAgICAgICAgICAuZ3JhZihocmVmKCR0d2l0dGVyVXNlci0+bmFtZSwkdHdpdHRlclVzZXJV
UkwpLCcgc3R5bGU9ImZvbnQtc2l6ZToxLjJlbTtmb250LXdlaWdodDpib2xkOyInKQogICAg
ICAgICAgICAuZ3JhZihocmVmKCR0d2l0dGVyVXNlci0+ZnJpZW5kc19jb3VudC4nIGZvbGxv
d2luZycsJHR3aXR0ZXJVc2VyVVJMLicvZm9sbG93aW5nJykKICAgICAgICAgICAgLicsICcu
aHJlZigkdHdpdHRlclVzZXItPmZvbGxvd2Vyc19jb3VudC4nIGZvbGxvd2VycycsJHR3aXR0
ZXJVc2VyVVJMLicvZm9sbG93ZXJzJykKICAgICAgICAgICAgLicsICcuaHJlZigkdHdpdHRl
clVzZXItPnN0YXR1c2VzX2NvdW50LicgdXBkYXRlcycsJHR3aXR0ZXJVc2VyVVJMKSkpKQog
ICAgICAgICAgICAudHIodGQoZm9ybSgKICAgICAgICAgICAgZ3JhZigiVXBkYXRlIFR3aXR0
ZXIuLi48c3BhbiBpZD0ndHdlZXRjb3VudCcgc3R5bGU9J2ZvbnQtd2VpZ2h0OmJvbGQ7Zmxv
YXQ6cmlnaHQ7Jz4xNDA8L3NwYW4+IikKICAgICAgICAgICAgLnRleHRfYXJlYSgnbWVzc2Fn
ZScsJzUwJywnNTUwJywnJywnbWVzc2FnZScpCiAgICAgICAgICAgIC5lSW5wdXQoJ2FyY19h
ZG1pbl90d2l0dGVyJykKICAgICAgICAgICAgLnNJbnB1dCgndHdlZXQnKS5icgogICAgICAg
ICAgICAuZklucHV0KCdzdWJtaXQnLCd1cGRhdGUnLGdUeHQoJ1VwZGF0ZScpLCdwdWJsaXNo
JykKICAgICAgICApKSkKICAgICAgICAuZW5kVGFibGUoKTsKCiAgICAvLyBBdHRhY2ggcmVj
ZW50IFR3aXR0ZXIgdXBkYXRlcwoKICAgICRodG1sLj0gc3RhcnRUYWJsZSgnbGlzdCcsJycs
JycsJycsJzkwJScpCiAgICAgICAgLiRvdXQKICAgICAgICAuZW5kVGFibGUoKTsKCiAgICAv
LyBPdXRwdXQgSmF2YVNjcmlwdCBhbmQgSFRNTAoKICAgIGVjaG8gJGpzLiRodG1sOwp9Cgov
LyBBZGQgVHdpdHRlciBvcHRpb25zIHRvIGFydGljbGUgYXJ0aWNsZSBzY3JlZW4KZnVuY3Rp
b24gYXJjX2FwcGVuZF90d2l0dGVyKCRldmVudCwgJHN0ZXAsICRkYXRhLCAkcnMxKQp7CiAg
ICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXI7CiAgICAkcHJlZml4ID0gdHJpbShncHMo
J2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICRwcmVmaXggPSAoJHByZWZpeCkgPyAkcHJl
Zml4IDogJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXTsKICAgICRzdWZmaXggPSB0cmlt
KGdwcygnYXJjX3R3aXR0ZXJfc3VmZml4JykpOwogICAgJHN1ZmZpeCA9ICgkc3VmZml4KSA/
ICRzdWZmaXggOiAkcHJlZnNbJ2FyY190d2l0dGVyX3N1ZmZpeCddOwoKICAgIGlmICgkcnMx
WydJRCddKSB7CiAgICAgICAgJHNxbCA9ICJTRUxFQ1QgdHdlZXRfaWQsdHdlZXQgRlJPTSAi
LlBGWC4iYXJjX3R3aXR0ZXIgV0hFUkUgYXJ0aWNsZV9pZD0iLiRyczFbJ0lEJ10uIjsiOwog
ICAgICAgICRyczIgPSBzYWZlX3F1ZXJ5KCRzcWwpOyAkcnMyID0gbmV4dFJvdygkcnMyKTsK
ICAgIH0gZWxzZSB7IC8vIG5ldyBhcnRpY2xlCiAgICAgICAgJHJzMiA9ICcnOwogICAgfQoK
ICAgIGlmICgkcnMxWydJRCddICYmICRyczJbJ3R3ZWV0X2lkJ10pIHsKICAgICAgICAkY29u
dGVudCA9IHRhZyhhcmNfVHdpdHRlcjo6bWFrZUxpbmtzKCRyczJbJ3R3ZWV0J10pLCdwJyk7
CiAgICAgICAgcmV0dXJuICRkYXRhLmZpZWxkc2V0KCRjb250ZW50LCAnVHdpdHRlciB1cGRh
dGUnLCAnYXJjX3R3aXR0ZXInKTsKICAgIH0gZWxzZSB7CiAgICAgICAgJHZhciA9IGdwcygn
YXJjX3R3ZWV0X3RoaXMnKTsKICAgICAgICAkdmFyID0gKCRyczFbJ0lEJ10mJiEkdmFyKSA/
IDAgOiAkcHJlZnNbJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnXTsKICAgICAgICAkY29u
dGVudCAgPSB0YWcoeWVzbm9SYWRpbygnYXJjX3R3ZWV0X3RoaXMnLCAkdmFyLCAnJywgJ2Fy
Y190d2VldF90aGlzJyksJ3AnKTsKICAgICAgICAkY29udGVudCAuPSB0YWcoaHJlZignT3B0
aW9ucycsJyNhcmNfdHdpdHRlcl9vcHRpb25zJyksJ3AnLCcgY2xhc3M9InBsYWluIGxldmVy
IiBzdHlsZT0ibWFyZ2luLXRvcDo1cHg7IicpOwogICAgICAgICRjb250ZW50IC49IHRhZyh0
YWcodGFnKCdUd2VldCBwcmVmaXgnLCdsYWJlbCcsICcgZm9yPSJhcmNfdHdpdHRlcl9wcmVm
aXgiJykKICAgICAgICAgICAgLmZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX3ByZWZpeCcs
JHByZWZpeCwnZWRpdCcsJycsJycsJzIyJywnJywnYXJjX3R3aXR0ZXJfcHJlZml4JyksJ3An
KQogICAgICAgICAgICAudGFnKHRhZygnVHdlZXQgc3VmZml4IChlZyAjaGFzaHRhZ3MpJywn
bGFiZWwnLCAnIGZvcj0iYXJjX3R3aXR0ZXJfc3VmZml4IicpCiAgICAgICAgICAgIC5mSW5w
dXQoJ3RleHQnLCdhcmNfdHdpdHRlcl9zdWZmaXgnLCRzdWZmaXgsJ2VkaXQnLCcnLCcnLCcy
MicsJycsJ2FyY190d2l0dGVyX3N1ZmZpeCcpLCdwJykKICAgICAgICAgICAgLCdkaXYnLCcg
aWQ9ImFyY190d2l0dGVyX29wdGlvbnMiIGNsYXNzPSJ0b2dnbGUiIHN0eWxlPSJkaXNwbGF5
Om5vbmUiJyk7CiAgICAgICAgaWYgKGlzc2V0KCRhcmNfdHdpdHRlclsnZXJyb3InXSkpIHsK
ICAgICAgICAgICAgJGNvbnRlbnQgLj0gJzxwPicuJGFyY190d2l0dGVyWydlcnJvciddLic8
L3A+JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICRkYXRhLmZpZWxkc2V0KCRjb250ZW50
LCAnVXBkYXRlIFR3aXR0ZXInLCAnYXJjX3R3aXR0ZXInKTsKICAgIH0KCn0KCi8vIFVwZGF0
ZSBUd2l0dGVyIHdpdGggcG9zdGVkIGFydGljbGUKZnVuY3Rpb24gYXJjX2FydGljbGVfdHdl
ZXQoJGV2ZW50LCRzdGVwKQp7CiAgICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXIsICRh
cmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVy
U2VjcmV0OwoKICAgICRhcnRpY2xlX2lkID0gZW1wdHkoJEdMT0JBTFNbJ0lEJ10pID8gZ3Bz
KCdJRCcpIDogJEdMT0JBTFNbJ0lEJ107CiAgICBpZiAoIWVtcHR5KCRhcnRpY2xlX2lkKSkg
ewoKICAgICAgICBpbmNsdWRlX29uY2UgdHhwYXRoLicvcHVibGlzaC90YWdoYW5kbGVycy5w
aHAnOwoKICAgICAgICAkYXJ0aWNsZSA9IHNhZmVfcm93KCJJRCwgVGl0bGUsIFNlY3Rpb24s
IFBvc3RlZCIsICd0ZXh0cGF0dGVybicsCiAgICAgICAgICAgICJJRD17JGFydGljbGVfaWR9
IEFORCBTdGF0dXM9NCBBTkQgbm93KCk+PVBvc3RlZCIpOwoKICAgICAgICBpZiAoJGFydGlj
bGUgJiYgZ3BzKCdhcmNfdHdlZXRfdGhpcycpKSB7IC8vIHR3ZWV0IGFydGljbGUKCiAgICAg
ICAgICAgIC8vIE5lZWQgdG8gbWFudWFsbHkgdXBkYXRlIHRoZSAnVVJMIG9ubHkgdGl0bGUn
IGJlZm9yZSBidWlsZGluZyB0aGUKICAgICAgICAgICAgLy8gVVJMCiAgICAgICAgICAgICRh
cnRpY2xlWyd1cmxfdGl0bGUnXSA9IGdwcygndXJsX3RpdGxlJyk7CiAgICAgICAgICAgIC8v
IE1ha2Ugc2hvcnQgVVJMCiAgICAgICAgICAgICR1cmwgPSBwZXJtbGlua3VybCgkYXJ0aWNs
ZSk7CiAgICAgICAgICAgICRzaG9ydF91cmwgPSBhcmNfc2hvcnRlbl91cmwoJHVybCwkcHJl
ZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXSwKICAgICAgICAgICAgICAgIGFycmF5KCdp
ZCc9PiRhcnRpY2xlX2lkKSk7CgogICAgICAgICAgICBpZiAoISRzaG9ydF91cmwpIHsgLy8g
RmFpbGVkIHRvIG9idGFpbiBhIHNob3J0ZW5lZCBVUkwsIGRvIG5vdCB0d2VldCEKICAgICAg
ICAgICAgICAgICRhcmNfdHdpdHRlclsnZXJyb3InXSA9ICdVbmFibGUgdG8gb2J0YWluIGEg
c2hvcnQgVVJMIGZvciB0aGlzIGFydGljbGUuJzsKCiAgICAgICAgICAgICAgICByZXR1cm4g
ZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIENvbnN0cnVjdCBUd2l0dGVy
IHVwZGF0ZQogICAgICAgICAgICAkcHJlZml4ICA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9w
cmVmaXgnKSk7CiAgICAgICAgICAgICRwcmVfbGVuID0gc3RybGVuKCRwcmVmaXgpOwogICAg
ICAgICAgICAkcHJlZml4ICA9ICgkcHJlZml4ICYmICRwcmVfbGVuPD0yMCkgPyAkcHJlZml4
LicgJyA6ICcnOwogICAgICAgICAgICAkc3VmZml4ICA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRl
cl9zdWZmaXgnKSk7CiAgICAgICAgICAgICRzdWZfbGVuID0gc3RybGVuKCRzdWZmaXgpOwog
ICAgICAgICAgICAkc3VmZml4ICA9ICgkc3VmZml4ICYmICRzdWZfbGVuPD00MCkgPyAnICcu
JHN1ZmZpeCA6ICcnOwogICAgICAgICAgICAkdXJsX2xlbiA9IHN0cmxlbigkc2hvcnRfdXJs
KSsxOyAvLyBjb3VudCBVUkwgbGVuZ3RoICsgMSBmb3IgcHJlZml4ZWQgc3BhY2UKICAgICAg
ICAgICAgaWYgKCRwcmVmaXgpICRwcmVfbGVuICs9IDE7CiAgICAgICAgICAgIGlmICgkc3Vm
Zml4KSAkc3VmX2xlbiArPSAxOwogICAgICAgICAgICBpZiAoKHN0cmxlbigkYXJ0aWNsZVsn
VGl0bGUnXSkrJHVybF9sZW4rJHByZV9sZW4rJHN1Zl9sZW4pPjE0MCkgewogICAgICAgICAg
ICAgICAgJGFydGljbGVbJ1RpdGxlJ10gPSBzdWJzdHIoJGFydGljbGVbJ1RpdGxlJ10sMCwx
MzUtJHVybF9sZW4tJHByZV9sZW4tJHN1Zl9sZW4pLicuLi4nOwogICAgICAgICAgICB9CiAg
ICAgICAgICAgICR0d2VldCA9ICRwcmVmaXguJGFydGljbGVbJ1RpdGxlJ10uIiAiLiRzaG9y
dF91cmwuJHN1ZmZpeDsKCiAgICAgICAgICAgIC8vIFVwZGF0ZSBUd2l0dGVyCiAgICAgICAg
ICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQog
ICAgICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1sn
YXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAgICAgICAgICAgICAgLCAkcHJlZnNbJ2Fy
Y190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pOwogICAgICAgICAgICAkcmVzdWx0ID0g
JHR3aXQtPnBvc3QoJ3N0YXR1c2VzL3VwZGF0ZScsIGFycmF5KCdzdGF0dXMnID0+ICR0d2Vl
dCkpOwoKICAgICAgICAgICAgJHR3ZWV0X2lkID0gKGlzX29iamVjdCgkcmVzdWx0KSkgPyAk
cmVzdWx0WzBdLT5pZCA6IDA7CgogICAgICAgICAgICBpZiAoJHR3ZWV0X2lkKSB7CgogICAg
ICAgICAgICAgICAgJHR3ZWV0ID0gYWRkc2xhc2hlcygkdHdlZXQpOwoKICAgICAgICAgICAg
ICAgIC8vIHVwZGF0ZSBhcmNfdHdpdHRlciB0YWJsZSB3aXRoIHR3ZWV0CiAgICAgICAgICAg
ICAgICAkc3FsID0gIklOU0VSVCBJTlRPICIuUEZYLiJhcmNfdHdpdHRlciAoYXJ0aWNsZV9p
ZCx0d2VldF9pZCx0d2VldCx0aW55dXJsKSAiOwogICAgICAgICAgICAgICAgJHNxbC49ICJW
QUxVRVMoJGFydGljbGVfaWQsJHR3ZWV0X2lkLFwiJHR3ZWV0XCIsJyRzaG9ydF91cmwnKTsi
OwogICAgICAgICAgICAgICAgc2FmZV9xdWVyeSgkc3FsKTsKCiAgICAgICAgICAgICAgICBy
ZXR1cm4gdHJ1ZTsKCiAgICAgICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAgICAgJGFy
Y190d2l0dGVyWydlcnJvciddID0gJ1R3aXR0ZXIgcmVzcG9uc2U6ICcKICAgICAgICAgICAg
ICAgICAgICAuJHR3aXQtPmh0dHBfY29kZTsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxz
ZTsKCiAgICAgICAgICAgIH0KCiAgICAgICAgfQoKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7
Cgp9CgovKgogKiBTaG9ydGVuIFVSTHMgdXNpbmcgdmFyaW91cyBtZXRob2RzCiAqLwoKZnVu
Y3Rpb24gYXJjX3Nob3J0ZW5fdXJsKCR1cmwsICRtZXRob2Q9JycsICRhdHRzPWFycmF5KCkp
CnsKICBnbG9iYWwgJHByZWZzOwoKICAkY2ggPSBjdXJsX2luaXQoKTsKICBjdXJsX3NldG9w
dCgkY2gsIENVUkxPUFRfSEVBREVSLCAwKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRf
UkVUVVJOVFJBTlNGRVIsIHRydWUpOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9USU1F
T1VULCAxMCk7CgogIHN3aXRjaCAoJG1ldGhvZCkgewogICAgY2FzZSAnc21kJzogLy8gY3Jl
YXRlIGEgc2hvcnRlbmVkIFVSTCB1c2luZyBTTUQgU2hvcnQgVVJMCiAgICAgIHJldHVybiAo
JGF0dHNbJ2lkJ10pID8gaHUuJGF0dHNbJ2lkJ10gOiBmYWxzZTsgYnJlYWs7CiAgICBjYXNl
ICdhcmNfdHdpdHRlcic6IC8vIG5hdGl2ZSBVUkwgc2hvcnRlbmluZwoKICAgICAgcmV0dXJu
ICgkYXR0c1snaWQnXSkgPyBQUk9UT0NPTC4kcHJlZnNbJ2FyY19zaG9ydF9zaXRlX3VybCdd
LicvJy4kYXR0c1snaWQnXSA6IGZhbHNlOwogICAgICBicmVhazsKCiAgICBjYXNlICdpc2dk
JzoKCiAgICAgICR1ID0gJ2h0dHA6Ly9pcy5nZC9hcGkucGhwP2xvbmd1cmw9Jy51cmxlbmNv
ZGUoJHVybCk7CiAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICR1KTsKCiAg
ICAgICR0aW55dXJsID0gY3VybF9leGVjKCRjaCk7CiAgICAgIGlmICgkdGlueXVybCE9J0Vy
cm9yJyAmJiAkdGlueXVybCE9JycpIHsKICAgICAgICByZXR1cm4gJHRpbnl1cmw7CiAgICAg
IH0gZWxzZSB7CiAgICAgICAgdHJpZ2dlcl9lcnJvcignYXJjX3R3aXR0ZXIgZmFpbGVkIHRv
IGdldCBhIGlzLmdkIFVSTCBmb3IgJwogICAgICAgICAgICAuJHVybCxFX1VTRVJfV0FSTklO
Ryk7CiAgICAgIH0KICAgICAgYnJlYWs7CgogICAgY2FzZSAndGlueXVybCc6IGRlZmF1bHQ6
IC8vIGNyZWF0ZSBhIHNob3J0ZW5lZCBVUkwgdXNpbmcgVGlueVVSTAoKICAgICAgJHUgPSAn
aHR0cDovL3Rpbnl1cmwuY29tL2FwaS1jcmVhdGUucGhwP3VybD0nLnVybGVuY29kZSgkdXJs
KTsKICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgJHUpOwogICAgICAkdGlu
eXVybCA9IGN1cmxfZXhlYygkY2gpOwogICAgICBpZiAoJHRpbnl1cmwhPSdFcnJvcicgJiYg
JHRpbnl1cmwhPScnKSB7CiAgICAgICAgcmV0dXJuICR0aW55dXJsOwogICAgICB9IGVsc2Ug
ewogICAgICAgIHRyaWdnZXJfZXJyb3IoJ2FyY190d2l0dGVyIGZhaWxlZCB0byBnZXQgYSBU
aW55VVJMIGZvciAnLiR1cmwsRV9VU0VSX1dBUk5JTkcpOwogICAgICB9CgogIH0KCiAgcmV0
dXJuIGZhbHNlOyAvLyBmYWlsCgp9CgovKgogKiBTaG9ydGVuZWQgVVJMIHJlZGlyZWN0IGJh
c2VkIG9uIHNtZF9zaG9ydF91cmwKICovCmZ1bmN0aW9uIGFyY19zaG9ydF91cmxfcmVkaXJl
Y3QoJGV2ZW50LCAkc3RlcCkgewogIGdsb2JhbCAkcHJlZnM7CgogICRoYXZlX2lkID0gMDsK
CiAgLy8gQ2hlY2sgaWYgdGhlcmUgaXMgYW4gYXZhaWxhYmxlIHNob3J0IHNpdGUgdXJsIGFu
ZCBpZiBpdCBpcyBiZWluZyB1c2VkIGluCiAgLy8gdGhpcyBpbnN0YW5jZQogICRzaG9ydF9z
aXRlX3VybCA9ICRwcmVmc1snYXJjX3Nob3J0X3NpdGVfdXJsJ107CiAgaWYgKCRzaG9ydF9z
aXRlX3VybCkgewogICAgJHNob3J0X3NpdGVfdXJsID0gUFJPVE9DT0wuJHNob3J0X3NpdGVf
dXJsLicvJzsKICAgICR1cmxfcGFydHMgPSBwYXJzZV91cmwoJHNob3J0X3NpdGVfdXJsKTsK
ICAgICRyZSA9ICcjXicuJHVybF9wYXJ0c1sncGF0aCddLicoWzAtOV0uKikjJzsKICAgICRo
YXZlX2lkID0gcHJlZ19tYXRjaCgkcmUsICRfU0VSVkVSWydSRVFVRVNUX1VSSSddLCAkbSk7
CiAgfQoKICAvLyBGYWxsIGJhY2sgdG8gc3RhbmRhcmQgc2l0ZSB1cmwgKHNtZF9zaG9ydF91
cmwgYmVoYXZpb3VyKQogIGlmICgkaGF2ZV9pZCkgewogICAgJHVybF9wYXJ0cyA9IHBhcnNl
X3VybChodSk7CiAgICAkcmUgPSAnI14nLiR1cmxfcGFydHNbJ3BhdGgnXS4nKFswLTldLiop
Iyc7CiAgICAkaGF2ZV9pZCA9IHByZWdfbWF0Y2goJHJlLCAkX1NFUlZFUlsnUkVRVUVTVF9V
UkknXSwgJG0pOwogIH0KCiAgLy8gRG8gdGhlIHJlZGlyZWN0IGlmIHdlJ3ZlIGdvdCBhbiBh
cnRpY2xlIGlkCiAgaWYgKCRoYXZlX2lkKSB7CgkgICRpZCA9ICRtWzFdOwoJICAkcGVybWxp
bmsgPSBwZXJtbGlua3VybF9pZCgkaWQpOwoKCSAgaWYgKCRwZXJtbGluaykgewoJCSAgb2Jf
ZW5kX2NsZWFuKCk7CgoJCSAgLy8gU3R1cGlkLCBvdmVyIHRoZSB0b3AgaGVhZGVyIHNldHRp
bmcgZm9yIElFCgkJICBoZWFkZXIoIlN0YXR1czogMzAxIik7CgkJICBoZWFkZXIoIkhUVFAv
MS4wIDMwMSBNb3ZlZCBQZXJtYW5lbnRseSIpOwoJCSAgaGVhZGVyKCJMb2NhdGlvbjogIi4k
cGVybWxpbmssIFRSVUUsIDMwMSk7CgoJCSAgLy8gSW4gY2FzZSB0aGUgaGVhZGVyKCkgbWV0
aG9kIGZhaWxzLCBmYWxsIGJhY2sgb24gYSBjbGFzc2ljIHJlZGlyZWN0CgkJICBlY2hvICc8
aHRtbD48aGVhZD48TUVUQSBIVFRQLUVRVUlWPSJSZWZyZXNoIiBDT05URU5UPSIwO1VSTD0n
CgkJICAgIC4kcGVybWxpbmsuJyI+PC9oZWFkPjxib2R5PjwvYm9keT48L2h0bWw+JzsKCQkg
IGRpZSgpOwoJICB9CiAgfQoKfQoKLy8gQXV0byBlbmFibGUgcGx1Z2luIG9uIGluc3RhbGwg
KG9yaWdpbmFsIGlkZWEgYnkgTWljaGFlbCBNYW5mcmUpCmZ1bmN0aW9uIF9hcmNfdHdpdHRl
cl9hdXRvX2VuYWJsZSgkZXZlbnQsICRzdGVwLCAkcHJlZml4PSdhcmNfdHdpdHRlcicpCnsK
ICAkcGx1Z2luID0gc3Vic3RyKCRldmVudCwgc3RybGVuKCdwbHVnaW5fbGlmZWN5Y2xlLicp
KTsKICBpZiAoc3RybmNtcCgkcGx1Z2luLCAkcHJlZml4LCBzdHJsZW4oJHByZWZpeCkpID09
IDApCiAgewogICAgc2FmZV91cGRhdGUoJ3R4cF9wbHVnaW4nLCAic3RhdHVzID0gMSIsICJu
YW1lID0gJyIgLiBkb1NsYXNoKCRwbHVnaW4pIC4gIiciKTsKICB9Cn0KCi8qCiAqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqCiovCgpjbGFzcyBhcmNfdHdpdHRlciBleHRlbmRzIFR3aXR0
ZXJPQXV0aCB7CiAgICAvLyBDYWNoaW5nIHZhcmlhYmxlcwogICAgcHJpdmF0ZSAkX2NhY2hl
ID0gdHJ1ZTsKICAgIHByaXZhdGUgJF9jYWNoZV9kaXIgPSAnLi90bXAnOwogICAgcHJpdmF0
ZSAkX2NhY2hlX3RpbWUgPSAxODAwOyAvLyAzMCBtaW51dGUgY2FjaGUKCiAgICBmdW5jdGlv
biBfX2NvbnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0LCAkb2F1dGhf
dG9rZW4gPSBOVUxMCiAgICAgICAgLCAkb2F1dGhfdG9rZW5fc2VjcmV0ID0gTlVMTCkKICAg
IHsKICAgICAgICBwYXJlbnQ6Ol9fY29uc3RydWN0KCRjb25zdW1lcl9rZXksICRjb25zdW1l
cl9zZWNyZXQsICRvYXV0aF90b2tlbgogICAgICAgICAgICAsICRvYXV0aF90b2tlbl9zZWNy
ZXQpOwogICAgICAgICR0aGlzLT5mb3JtYXQgPSAneG1sJzsKICAgICAgICAkdGhpcy0+dGlt
ZW91dCA9IDE1OwogICAgICAgICR0aGlzLT5jb25uZWN0dGltZW91dCA9IDE1OwogICAgfQoK
ICAgIHB1YmxpYyBmdW5jdGlvbiBjYWxsYmFja1VSTCgkZXZlbnQsJHN0ZXApCiAgICB7CiAg
ICAgICAgcmV0dXJuIHByZWdfcmVwbGFjZSgnL1w/LiovJywgJycsUFJPVE9DT0wuJF9TRVJW
RVJbJ1NFUlZFUl9OQU1FJ10uJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10pCiAgICAgICAgICAu
Jz9ldmVudD0nLiRldmVudC4nJmFtcDtzdGVwPScuJHN0ZXA7CiAgICB9CgogICAgLy8gY3Jl
YXRlIFR3aXR0ZXIgYW5kIGV4dGVybmFsIGxpbmtzIGluIHRleHQKICAgIHB1YmxpYyBzdGF0
aWMgZnVuY3Rpb24gbWFrZUxpbmtzKCR0ZXh0KQogICAgewogICAgICAgICR1cmwgPSAnL1xi
KGh0dHB8aHR0cHN8ZnRwKTpcL1wvKFtBLVowLTldW0EtWjAtOV8tXSooPzpcLltBLVowLTld
W0EtWjAtOV8tXSopKyk6PyhcZCspP1wvPyhbXC9cdytcLl0rKVxiL2knOwogICAgICAgICR0
ZXh0ID0gcHJlZ19yZXBsYWNlKCR1cmwsICI8YSBocmVmPSckMCcgcmVsPSdleHRlcm5hbCc+
JDA8L2E+IiwgJHRleHQpOwogICAgICAgICR1cmwgPSAnL1xiKF58XHMpd3d3LihbYS16X0Et
WjAtOV0rKSgoXC5bYS16XSspKylcYi9pJzsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFj
ZSgkdXJsLCAiPGEgaHJlZj0naHR0cDovL3d3dy4kMiQzJyByZWw9J2V4dGVybmFsJz53d3cu
JDIkMzwvYT4iLCAkdGV4dCk7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoIi8oXnxc
cylAKFthLXpfQS1aMC05XSspLyIsCiAgICAgICAgICAgICIkMUA8YSBocmVmPSdodHRwOi8v
dHdpdHRlci5jb20vJDInIHJlbD0nZXh0ZXJuYWwnPiQyPC9hPiIsJHRleHQpOwogICAgICAg
ICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCIvKF58XHMpKFwjKFthLXpfQS1aMC05Ol8tXSspKS8i
LAogICAgICAgICAgICAiJDE8YSBocmVmPSdodHRwOi8vdHdpdHRlci5jb20vc2VhcmNoP3E9
JTIzJDMnIHJlbD0nZXh0ZXJuYWwnPiQyPC9hPiIsJHRleHQpOwogICAgICAgIHJldHVybiAk
dGV4dDsKICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGdldCgkdXJsLCAkcGFyYW1zID0gYXJy
YXkoKSkKICAgIHsKICAgICAgICAkYXBpX3VybCA9IG1kNSgkdXJsLnVybGVuY29kZShzZXJp
YWxpemUoJHBhcmFtcykpKTsKICAgICAgICAkZGF0YSA9ICcnOwoKICAgICAgICBpZiAoJHRo
aXMtPl9jYWNoZSkgeyAvLyBjaGVjayBmb3IgY2FjaGVkIHhtbAoKICAgICAgICAgICAgJGRh
dGEgPSAkdGhpcy0+X3JldHJpZXZlQ2FjaGUoJGFwaV91cmwpOwoKICAgICAgICB9CiAgICAg
ICAgaWYgKGVtcHR5KCRkYXRhKSkgewogICAgICAgICAgICAkZGF0YSA9IHBhcmVudDo6Z2V0
KCR1cmwsICRwYXJhbXMpOwogICAgICAgICAgICBpZiAoJHRoaXMtPmh0dHBfY29kZT09PTIw
MCAmJiAkeG1sPXNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSkpIHsgLy8gc2F2ZSBjYWNo
ZQogICAgICAgICAgICAgICAgJGZpbGUgPSAkdGhpcy0+X2NhY2hlX2Rpci4nLycuJGFwaV91
cmw7CiAgICAgICAgICAgICAgICBmaWxlX3B1dF9jb250ZW50cygkZmlsZSwkZGF0YSxMT0NL
X0VYKTsKICAgICAgICAgICAgICAgIHJldHVybiAkeG1sOwogICAgICAgICAgICB9IGVsc2Ug
eyAvLyBmYWlsZWQgdG8gcmV0cmlldmUgZGF0YSBmcm9tIFR3aXR0ZXIKCiAgICAgICAgICAg
ICAgICBpZiAoJHRoaXMtPl9jYWNoZSkgeyAvLyBhdHRlbXB0IHRvIGZvcmNlIGNhY2hlZCB4
bWwgcmV0dXJuCgogICAgICAgICAgICAgICAgICAgICRkYXRhID0gJHRoaXMtPl9yZXRyaWV2
ZUNhY2hlKCRhcGlfdXJsLHRydWUpOwogICAgICAgICAgICAgICAgICAgIGlmICgkZGF0YSkg
cmV0dXJuIEBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwoKICAgICAgICAgICAgICAg
IH0KCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICB9CiAgICAg
ICAgfSBlbHNlIHsgLy8gcmV0dXJuIGNhY2hlZCB4bWwKICAgICAgICAgICAgcmV0dXJuIEBz
aW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwogICAgICAgIH0KICAgIH0gLy9lbmQgZ2V0
KCkKCiAgICBmdW5jdGlvbiBwb3N0KCR1cmwsICRwYXJhbXMgPSBhcnJheSgpKQogICAgewog
ICAgICAgICRkYXRhID0gcGFyZW50Ojpwb3N0KCR1cmwsJHBhcmFtcyk7CiAgICAgICAgcmV0
dXJuIHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CiAgICB9CgogICAgZnVuY3Rpb24g
ZGVsZXRlKCR1cmwsICRwYXJhbXMgPSBhcnJheSgpKQogICAgewogICAgICAgICRkYXRhID0g
cGFyZW50OjpkZWxldGUoJHVybCwkcGFyYW1zKTsKICAgICAgICByZXR1cm4gc2ltcGxleG1s
X2xvYWRfc3RyaW5nKCRkYXRhKTsKICAgIH0KCiAgICAvLyBDYWNoZSBtZXRob2RzCgogICAg
cHVibGljIGZ1bmN0aW9uIHNldENhY2hpbmcoJGNhY2hlPXRydWUpCiAgICB7CiAgICAgICAg
JHRoaXMtPl9jYWNoZSA9ICgkY2FjaGUpID8gdHJ1ZSA6IGZhbHNlOwogICAgICAgIHJldHVy
biB0cnVlOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjYWNoZURpcigkbG9jKQogICAg
ewogICAgICAgICR0aGlzLT5fY2FjaGVfZGlyID0gJGxvYzsKICAgICAgICByZXR1cm4gdHJ1
ZTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY2FjaGVUaW1lKCRtaW5zKQogICAgewog
ICAgICAgICR0aGlzLT5fY2FjaGVfdGltZSA9ICRtaW5zKjYwOyAvLyBjb252ZXJ0IG1pbnV0
ZXMgaW50byBzZWNvbmRzCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJpdmF0
ZSBmdW5jdGlvbiBfcmV0cmlldmVDYWNoZSgkdXJsLCRvdmVyaWRlX3RpbWVvdXQ9ZmFsc2Up
CiAgICB7CiAgICAgICAgJGZpbGUgPSAkdGhpcy0+X2NhY2hlX2Rpci4nLycuJHVybDsKICAg
ICAgICBpZiAoZmlsZV9leGlzdHMoJGZpbGUpKSB7CgogICAgICAgICAgICAkZGlmZiA9IHRp
bWUoKSAtIGZpbGVtdGltZSgkZmlsZSk7CiAgICAgICAgICAgIGlmICgkb3ZlcmlkZV90aW1l
b3V0IHx8ICRkaWZmIDwgJHRoaXMtPl9jYWNoZV90aW1lKSB7CiAgICAgICAgICAgICAgICBy
ZXR1cm4gZmlsZV9nZXRfY29udGVudHMoJGZpbGUpOwogICAgICAgICAgICB9IGVsc2Ugewog
ICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgIH0g
ZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9Cn0KCi8q
CiAqIEFicmFoYW0gV2lsbGlhbXMgKGFicmFoYW1AYWJyYWguYW0pIGh0dHA6Ly9hYnJhaC5h
bQogKgogKiBUaGUgZmlyc3QgUEhQIExpYnJhcnkgdG8gc3VwcG9ydCBPQXV0aCBmb3IgVHdp
dHRlcidzIFJFU1QgQVBJLgogKi8KCi8qKgogKiBUd2l0dGVyIE9BdXRoIGNsYXNzCiAqLwpj
bGFzcyBUd2l0dGVyT0F1dGggewogIC8qIENvbnRhaW5zIHRoZSBsYXN0IEhUVFAgc3RhdHVz
IGNvZGUgcmV0dXJuZWQuICovCiAgcHVibGljICRodHRwX2NvZGU7CiAgLyogQ29udGFpbnMg
dGhlIGxhc3QgQVBJIGNhbGwuICovCiAgcHVibGljICR1cmw7CiAgLyogU2V0IHVwIHRoZSBB
UEkgcm9vdCBVUkwuICovCiAgcHVibGljICRob3N0ID0gImh0dHBzOi8vYXBpLnR3aXR0ZXIu
Y29tLzEvIjsKICAvKiBTZXQgdGltZW91dCBkZWZhdWx0LiAqLwogIHB1YmxpYyAkdGltZW91
dCA9IDMwOwogIC8qIFNldCBjb25uZWN0IHRpbWVvdXQuICovCiAgcHVibGljICRjb25uZWN0
dGltZW91dCA9IDMwOwogIC8qIFZlcmlmeSBTU0wgQ2VydC4gKi8KICBwdWJsaWMgJHNzbF92
ZXJpZnlwZWVyID0gRkFMU0U7CiAgLyogUmVzcG9ucyBmb3JtYXQuICovCiAgcHVibGljICRm
b3JtYXQgPSAnanNvbic7CiAgLyogRGVjb2RlIHJldHVybmVkIGpzb24gZGF0YS4gKi8KICBw
dWJsaWMgJGRlY29kZV9qc29uID0gVFJVRTsKICAvKiBDb250YWlucyB0aGUgbGFzdCBIVFRQ
IGhlYWRlcnMgcmV0dXJuZWQuICovCiAgcHVibGljICRodHRwX2luZm87CiAgLyogU2V0IHRo
ZSB1c2VyYWduZXQuICovCiAgcHVibGljICR1c2VyYWdlbnQgPSAnVHdpdHRlck9BdXRoIHYw
LjIuMC1iZXRhMic7CiAgLyogSW1tZWRpYXRlbHkgcmV0cnkgdGhlIEFQSSBjYWxsIGlmIHRo
ZSByZXNwb25zZSB3YXMgbm90IHN1Y2Nlc3NmdWwuICovCiAgLy9wdWJsaWMgJHJldHJ5ID0g
VFJVRTsKCgoKCiAgLyoqCiAgICogU2V0IEFQSSBVUkxTCiAgICovCiAgZnVuY3Rpb24gYWNj
ZXNzVG9rZW5VUkwoKSAgeyByZXR1cm4gJ2h0dHBzOi8vYXBpLnR3aXR0ZXIuY29tL29hdXRo
L2FjY2Vzc190b2tlbic7IH0KICBmdW5jdGlvbiBhdXRoZW50aWNhdGVVUkwoKSB7IHJldHVy
biAnaHR0cHM6Ly90d2l0dGVyLmNvbS9vYXV0aC9hdXRoZW50aWNhdGUnOyB9CiAgZnVuY3Rp
b24gYXV0aG9yaXplVVJMKCkgICAgeyByZXR1cm4gJ2h0dHBzOi8vdHdpdHRlci5jb20vb2F1
dGgvYXV0aG9yaXplJzsgfQogIGZ1bmN0aW9uIHJlcXVlc3RUb2tlblVSTCgpIHsgcmV0dXJu
ICdodHRwczovL2FwaS50d2l0dGVyLmNvbS9vYXV0aC9yZXF1ZXN0X3Rva2VuJzsgfQoKICAv
KioKICAgKiBEZWJ1ZyBoZWxwZXJzCiAgICovCiAgZnVuY3Rpb24gbGFzdFN0YXR1c0NvZGUo
KSB7IHJldHVybiAkdGhpcy0+aHR0cF9zdGF0dXM7IH0KICBmdW5jdGlvbiBsYXN0QVBJQ2Fs
bCgpIHsgcmV0dXJuICR0aGlzLT5sYXN0X2FwaV9jYWxsOyB9CgogIC8qKgogICAqIGNvbnN0
cnVjdCBUd2l0dGVyT0F1dGggb2JqZWN0CiAgICovCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3Qo
JGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rva2VuID0gTlVMTCwg
JG9hdXRoX3Rva2VuX3NlY3JldCA9IE5VTEwpIHsKICAgICR0aGlzLT5zaGExX21ldGhvZCA9
IG5ldyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9ITUFDX1NIQTEoKTsKICAgICR0aGlzLT5jb25z
dW1lciA9IG5ldyBPQXV0aENvbnN1bWVyKCRjb25zdW1lcl9rZXksICRjb25zdW1lcl9zZWNy
ZXQpOwogICAgaWYgKCFlbXB0eSgkb2F1dGhfdG9rZW4pICYmICFlbXB0eSgkb2F1dGhfdG9r
ZW5fc2VjcmV0KSkgewogICAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigk
b2F1dGhfdG9rZW4sICRvYXV0aF90b2tlbl9zZWNyZXQpOwogICAgfSBlbHNlIHsKICAgICAg
JHRoaXMtPnRva2VuID0gTlVMTDsKICAgIH0KICB9CgoKICAvKioKICAgKiBHZXQgYSByZXF1
ZXN0X3Rva2VuIGZyb20gVHdpdHRlcgogICAqCiAgICogQHJldHVybnMgYSBrZXkvdmFsdWUg
YXJyYXkgY29udGFpbmluZyBvYXV0aF90b2tlbiBhbmQgb2F1dGhfdG9rZW5fc2VjcmV0CiAg
ICovCiAgZnVuY3Rpb24gZ2V0UmVxdWVzdFRva2VuKCRvYXV0aF9jYWxsYmFjayA9IE5VTEwp
IHsKICAgICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgIGlmICghZW1wdHkoJG9hdXRoX2Nh
bGxiYWNrKSkgewogICAgICAkcGFyYW1ldGVyc1snb2F1dGhfY2FsbGJhY2snXSA9ICRvYXV0
aF9jYWxsYmFjazsKICAgIH0KICAgICRyZXF1ZXN0ID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgk
dGhpcy0+cmVxdWVzdFRva2VuVVJMKCksICdHRVQnLCAkcGFyYW1ldGVycyk7CiAgICAkdG9r
ZW4gPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoJHJlcXVlc3QpOwogICAgJHRoaXMt
PnRva2VuID0gbmV3IE9BdXRoQ29uc3VtZXIoJHRva2VuWydvYXV0aF90b2tlbiddLCAkdG9r
ZW5bJ29hdXRoX3Rva2VuX3NlY3JldCddKTsKICAgIHJldHVybiAkdG9rZW47CiAgfQoKICAv
KioKICAgKiBHZXQgdGhlIGF1dGhvcml6ZSBVUkwKICAgKgogICAqIEByZXR1cm5zIGEgc3Ry
aW5nCiAgICovCiAgZnVuY3Rpb24gZ2V0QXV0aG9yaXplVVJMKCR0b2tlbiwgJHNpZ25faW5f
d2l0aF90d2l0dGVyID0gVFJVRSkgewogICAgaWYgKGlzX2FycmF5KCR0b2tlbikpIHsKICAg
ICAgJHRva2VuID0gJHRva2VuWydvYXV0aF90b2tlbiddOwogICAgfQogICAgaWYgKGVtcHR5
KCRzaWduX2luX3dpdGhfdHdpdHRlcikpIHsKICAgICAgcmV0dXJuICR0aGlzLT5hdXRob3Jp
emVVUkwoKSAuICI/b2F1dGhfdG9rZW49eyR0b2tlbn0iOwogICAgfSBlbHNlIHsKICAgICAg
IHJldHVybiAkdGhpcy0+YXV0aGVudGljYXRlVVJMKCkgLiAiP29hdXRoX3Rva2VuPXskdG9r
ZW59IjsKICAgIH0KICB9CgogIC8qKgogICAqIEV4Y2hhbmdlIHJlcXVlc3QgdG9rZW4gYW5k
IHNlY3JldCBmb3IgYW4gYWNjZXNzIHRva2VuIGFuZAogICAqIHNlY3JldCwgdG8gc2lnbiBB
UEkgY2FsbHMuCiAgICoKICAgKiBAcmV0dXJucyBhcnJheSgib2F1dGhfdG9rZW4iID0+ICJ0
aGUtYWNjZXNzLXRva2VuIiwKICAgKiAgICAgICAgICAgICAgICAib2F1dGhfdG9rZW5fc2Vj
cmV0IiA9PiAidGhlLWFjY2Vzcy1zZWNyZXQiLAogICAqICAgICAgICAgICAgICAgICJ1c2Vy
X2lkIiA9PiAiOTQzNjk5MiIsCiAgICogICAgICAgICAgICAgICAgInNjcmVlbl9uYW1lIiA9
PiAiYWJyYWhhbSIpCiAgICovCiAgZnVuY3Rpb24gZ2V0QWNjZXNzVG9rZW4oJG9hdXRoX3Zl
cmlmaWVyID0gRkFMU0UpIHsKICAgICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgIGlmICgh
ZW1wdHkoJG9hdXRoX3ZlcmlmaWVyKSkgewogICAgICAkcGFyYW1ldGVyc1snb2F1dGhfdmVy
aWZpZXInXSA9ICRvYXV0aF92ZXJpZmllcjsKICAgIH0KICAgICRyZXF1ZXN0ID0gJHRoaXMt
Pm9BdXRoUmVxdWVzdCgkdGhpcy0+YWNjZXNzVG9rZW5VUkwoKSwgJ0dFVCcsICRwYXJhbWV0
ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygkcmVxdWVz
dCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9rZW5bJ29hdXRo
X3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAgcmV0dXJuICR0
b2tlbjsKICB9CgogIC8qKgogICAqIE9uZSB0aW1lIGV4Y2hhbmdlIG9mIHVzZXJuYW1lIGFu
ZCBwYXNzd29yZCBmb3IgYWNjZXNzIHRva2VuIGFuZCBzZWNyZXQuCiAgICoKICAgKiBAcmV0
dXJucyBhcnJheSgib2F1dGhfdG9rZW4iID0+ICJ0aGUtYWNjZXNzLXRva2VuIiwKICAgKiAg
ICAgICAgICAgICAgICAib2F1dGhfdG9rZW5fc2VjcmV0IiA9PiAidGhlLWFjY2Vzcy1zZWNy
ZXQiLAogICAqICAgICAgICAgICAgICAgICJ1c2VyX2lkIiA9PiAiOTQzNjk5MiIsCiAgICog
ICAgICAgICAgICAgICAgInNjcmVlbl9uYW1lIiA9PiAiYWJyYWhhbSIsCiAgICogICAgICAg
ICAgICAgICAgInhfYXV0aF9leHBpcmVzIiA9PiAiMCIpCiAgICovCiAgZnVuY3Rpb24gZ2V0
WEF1dGhUb2tlbigkdXNlcm5hbWUsICRwYXNzd29yZCkgewogICAgJHBhcmFtZXRlcnMgPSBh
cnJheSgpOwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF91c2VybmFtZSddID0gJHVzZXJuYW1l
OwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF9wYXNzd29yZCddID0gJHBhc3N3b3JkOwogICAg
JHBhcmFtZXRlcnNbJ3hfYXV0aF9tb2RlJ10gPSAnY2xpZW50X2F1dGgnOwogICAgJHJlcXVl
c3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5hY2Nlc3NUb2tlblVSTCgpLCAnUE9T
VCcsICRwYXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1l
dGVycygkcmVxdWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigk
dG9rZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwog
ICAgcmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIEdFVCB3cmFwcGVyIGZvciBvQXV0
aFJlcXVlc3QuCiAgICovCiAgZnVuY3Rpb24gZ2V0KCR1cmwsICRwYXJhbWV0ZXJzID0gYXJy
YXkoKSkgewogICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdXJsLCAnR0VU
JywgJHBhcmFtZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09ICdqc29uJyAmJiAk
dGhpcy0+ZGVjb2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25fZGVjb2RlKCRyZXNwb25z
ZSk7CiAgICB9CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogUE9TVCB3
cmFwcGVyIGZvciBvQXV0aFJlcXVlc3QuCiAgICovCiAgZnVuY3Rpb24gcG9zdCgkdXJsLCAk
cGFyYW1ldGVycyA9IGFycmF5KCkpIHsKICAgICRyZXNwb25zZSA9ICR0aGlzLT5vQXV0aFJl
cXVlc3QoJHVybCwgJ1BPU1QnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAoJHRoaXMtPmZvcm1h
dCA9PT0gJ2pzb24nICYmICR0aGlzLT5kZWNvZGVfanNvbikgewogICAgICByZXR1cm4ganNv
bl9kZWNvZGUoJHJlc3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVzcG9uc2U7CiAgfQoK
ICAvKioKICAgKiBERUxFVEUgd3JhcHBlciBmb3Igb0F1dGhSZXFldXN0LgogICAqLwogIGZ1
bmN0aW9uIGRlbGV0ZSgkdXJsLCAkcGFyYW1ldGVycyA9IGFycmF5KCkpIHsKICAgICRyZXNw
b25zZSA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHVybCwgJ0RFTEVURScsICRwYXJhbWV0ZXJz
KTsKICAgIGlmICgkdGhpcy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMtPmRlY29kZV9q
c29uKSB7CiAgICAgIHJldHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwogICAgfQogICAg
cmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIEZvcm1hdCBhbmQgc2lnbiBhbiBP
QXV0aCAvIEFQSSByZXF1ZXN0CiAgICovCiAgZnVuY3Rpb24gb0F1dGhSZXF1ZXN0KCR1cmws
ICRtZXRob2QsICRwYXJhbWV0ZXJzKSB7CiAgICBpZiAoc3RycnBvcygkdXJsLCAnaHR0cHM6
Ly8nKSAhPT0gMCAmJiBzdHJycG9zKCR1cmwsICdodHRwOi8vJykgIT09IDApIHsKICAgICAg
JHVybCA9ICJ7JHRoaXMtPmhvc3R9eyR1cmx9LnskdGhpcy0+Zm9ybWF0fSI7CiAgICB9CiAg
ICAkcmVxdWVzdCA9IE9BdXRoUmVxdWVzdDo6ZnJvbV9jb25zdW1lcl9hbmRfdG9rZW4oJHRo
aXMtPmNvbnN1bWVyLCAkdGhpcy0+dG9rZW4sICRtZXRob2QsICR1cmwsICRwYXJhbWV0ZXJz
KTsKICAgICRyZXF1ZXN0LT5zaWduX3JlcXVlc3QoJHRoaXMtPnNoYTFfbWV0aG9kLCAkdGhp
cy0+Y29uc3VtZXIsICR0aGlzLT50b2tlbik7CiAgICBzd2l0Y2ggKCRtZXRob2QpIHsKICAg
IGNhc2UgJ0dFVCc6CiAgICAgIHJldHVybiAkdGhpcy0+aHR0cCgkcmVxdWVzdC0+dG9fdXJs
KCksICdHRVQnKTsKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiAkdGhpcy0+aHR0cCgkcmVx
dWVzdC0+Z2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKSwgJG1ldGhvZCwgJHJlcXVlc3QtPnRv
X3Bvc3RkYXRhKCkpOwogICAgfQogIH0KCiAgLyoqCiAgICogTWFrZSBhbiBIVFRQIHJlcXVl
c3QKICAgKgogICAqIEByZXR1cm4gQVBJIHJlc3VsdHMKICAgKi8KICBmdW5jdGlvbiBodHRw
KCR1cmwsICRtZXRob2QsICRwb3N0ZmllbGRzID0gTlVMTCkgewogICAgJHRoaXMtPmh0dHBf
aW5mbyA9IGFycmF5KCk7CiAgICAkY2kgPSBjdXJsX2luaXQoKTsKICAgIC8qIEN1cmwgc2V0
dGluZ3MgKi8KICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9VU0VSQUdFTlQsICR0aGlz
LT51c2VyYWdlbnQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0NPTk5FQ1RUSU1F
T1VULCAkdGhpcy0+Y29ubmVjdHRpbWVvdXQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJM
T1BUX1RJTUVPVVQsICR0aGlzLT50aW1lb3V0KTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VS
TE9QVF9SRVRVUk5UUkFOU0ZFUiwgVFJVRSk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxP
UFRfSFRUUEhFQURFUiwgYXJyYXkoJ0V4cGVjdDonKSk7CiAgICBjdXJsX3NldG9wdCgkY2ks
IENVUkxPUFRfU1NMX1ZFUklGWVBFRVIsICR0aGlzLT5zc2xfdmVyaWZ5cGVlcik7CiAgICBj
dXJsX3NldG9wdCgkY2ksIENVUkxPUFRfSEVBREVSRlVOQ1RJT04sIGFycmF5KCR0aGlzLCAn
Z2V0SGVhZGVyJykpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0hFQURFUiwgRkFM
U0UpOwoKICAgIHN3aXRjaCAoJG1ldGhvZCkgewogICAgICBjYXNlICdQT1NUJzoKICAgICAg
ICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfUE9TVCwgVFJVRSk7CiAgICAgICAgaWYgKCFl
bXB0eSgkcG9zdGZpZWxkcykpIHsKICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9Q
VF9QT1NURklFTERTLCAkcG9zdGZpZWxkcyk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwog
ICAgICBjYXNlICdERUxFVEUnOgogICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9D
VVNUT01SRVFVRVNULCAnREVMRVRFJyk7CiAgICAgICAgaWYgKCFlbXB0eSgkcG9zdGZpZWxk
cykpIHsKICAgICAgICAgICR1cmwgPSAieyR1cmx9P3skcG9zdGZpZWxkc30iOwogICAgICAg
IH0KICAgIH0KCiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfVVJMLCAkdXJsKTsKICAg
ICRyZXNwb25zZSA9IGN1cmxfZXhlYygkY2kpOwogICAgJHRoaXMtPmh0dHBfY29kZSA9IGN1
cmxfZ2V0aW5mbygkY2ksIENVUkxJTkZPX0hUVFBfQ09ERSk7CiAgICAkdGhpcy0+aHR0cF9p
bmZvID0gYXJyYXlfbWVyZ2UoJHRoaXMtPmh0dHBfaW5mbywgY3VybF9nZXRpbmZvKCRjaSkp
OwogICAgJHRoaXMtPnVybCA9ICR1cmw7CiAgICBjdXJsX2Nsb3NlICgkY2kpOwogICAgcmV0
dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIEdldCB0aGUgaGVhZGVyIGluZm8gdG8g
c3RvcmUuCiAgICovCiAgZnVuY3Rpb24gZ2V0SGVhZGVyKCRjaCwgJGhlYWRlcikgewogICAg
JGkgPSBzdHJwb3MoJGhlYWRlciwgJzonKTsKICAgIGlmICghZW1wdHkoJGkpKSB7CiAgICAg
ICRrZXkgPSBzdHJfcmVwbGFjZSgnLScsICdfJywgc3RydG9sb3dlcihzdWJzdHIoJGhlYWRl
ciwgMCwgJGkpKSk7CiAgICAgICR2YWx1ZSA9IHRyaW0oc3Vic3RyKCRoZWFkZXIsICRpICsg
MikpOwogICAgICAkdGhpcy0+aHR0cF9oZWFkZXJbJGtleV0gPSAkdmFsdWU7CiAgICB9CiAg
ICByZXR1cm4gc3RybGVuKCRoZWFkZXIpOwogIH0KfQoKY2xhc3MgT0F1dGhFeGNlcHRpb24g
ZXh0ZW5kcyBFeGNlcHRpb24gewogIC8vIHBhc3MKfQoKY2xhc3MgT0F1dGhDb25zdW1lciB7
CiAgcHVibGljICRrZXk7CiAgcHVibGljICRzZWNyZXQ7CgogIGZ1bmN0aW9uIF9fY29uc3Ry
dWN0KCRrZXksICRzZWNyZXQsICRjYWxsYmFja191cmw9TlVMTCkgewogICAgJHRoaXMtPmtl
eSA9ICRrZXk7CiAgICAkdGhpcy0+c2VjcmV0ID0gJHNlY3JldDsKICAgICR0aGlzLT5jYWxs
YmFja191cmwgPSAkY2FsbGJhY2tfdXJsOwogIH0KCiAgZnVuY3Rpb24gX190b1N0cmluZygp
IHsKICAgIHJldHVybiAiT0F1dGhDb25zdW1lcltrZXk9JHRoaXMtPmtleSxzZWNyZXQ9JHRo
aXMtPnNlY3JldF0iOwogIH0KfQoKY2xhc3MgT0F1dGhUb2tlbiB7CiAgLy8gYWNjZXNzIHRv
a2VucyBhbmQgcmVxdWVzdCB0b2tlbnMKICBwdWJsaWMgJGtleTsKICBwdWJsaWMgJHNlY3Jl
dDsKCiAgLyoqCiAgICoga2V5ID0gdGhlIHRva2VuCiAgICogc2VjcmV0ID0gdGhlIHRva2Vu
IHNlY3JldAogICAqLwogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRrZXksICRzZWNyZXQpIHsK
ICAgICR0aGlzLT5rZXkgPSAka2V5OwogICAgJHRoaXMtPnNlY3JldCA9ICRzZWNyZXQ7CiAg
fQoKICAvKioKICAgKiBnZW5lcmF0ZXMgdGhlIGJhc2ljIHN0cmluZyBzZXJpYWxpemF0aW9u
IG9mIGEgdG9rZW4gdGhhdCBhIHNlcnZlcgogICAqIHdvdWxkIHJlc3BvbmQgdG8gcmVxdWVz
dF90b2tlbiBhbmQgYWNjZXNzX3Rva2VuIGNhbGxzIHdpdGgKICAgKi8KICBmdW5jdGlvbiB0
b19zdHJpbmcoKSB7CiAgICByZXR1cm4gIm9hdXRoX3Rva2VuPSIgLgogICAgICAgICAgIE9B
dXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHRoaXMtPmtleSkgLgogICAgICAgICAgICIm
b2F1dGhfdG9rZW5fc2VjcmV0PSIgLgogICAgICAgICAgIE9BdXRoVXRpbDo6dXJsZW5jb2Rl
X3JmYzM5ODYoJHRoaXMtPnNlY3JldCk7CiAgfQoKICBmdW5jdGlvbiBfX3RvU3RyaW5nKCkg
ewogICAgcmV0dXJuICR0aGlzLT50b19zdHJpbmcoKTsKICB9Cn0KCi8qKgogKiBBIGNsYXNz
IGZvciBpbXBsZW1lbnRpbmcgYSBTaWduYXR1cmUgTWV0aG9kCiAqIFNlZSBzZWN0aW9uIDkg
KCJTaWduaW5nIFJlcXVlc3RzIikgaW4gdGhlIHNwZWMKICovCmFic3RyYWN0IGNsYXNzIE9B
dXRoU2lnbmF0dXJlTWV0aG9kIHsKICAvKioKICAgKiBOZWVkcyB0byByZXR1cm4gdGhlIG5h
bWUgb2YgdGhlIFNpZ25hdHVyZSBNZXRob2QgKGllIEhNQUMtU0hBMSkKICAgKiBAcmV0dXJu
IHN0cmluZwogICAqLwogIGFic3RyYWN0IHB1YmxpYyBmdW5jdGlvbiBnZXRfbmFtZSgpOwoK
ICAvKioKICAgKiBCdWlsZCB1cCB0aGUgc2lnbmF0dXJlCiAgICogTk9URTogVGhlIG91dHB1
dCBvZiB0aGlzIGZ1bmN0aW9uIE1VU1QgTk9UIGJlIHVybGVuY29kZWQuCiAgICogdGhlIGVu
Y29kaW5nIGlzIGhhbmRsZWQgaW4gT0F1dGhSZXF1ZXN0IHdoZW4gdGhlIGZpbmFsCiAgICog
cmVxdWVzdCBpcyBzZXJpYWxpemVkCiAgICogQHBhcmFtIE9BdXRoUmVxdWVzdCAkcmVxdWVz
dAogICAqIEBwYXJhbSBPQXV0aENvbnN1bWVyICRjb25zdW1lcgogICAqIEBwYXJhbSBPQXV0
aFRva2VuICR0b2tlbgogICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAgYWJzdHJhY3QgcHVi
bGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9r
ZW4pOwoKICAvKioKICAgKiBWZXJpZmllcyB0aGF0IGEgZ2l2ZW4gc2lnbmF0dXJlIGlzIGNv
cnJlY3QKICAgKiBAcGFyYW0gT0F1dGhSZXF1ZXN0ICRyZXF1ZXN0CiAgICogQHBhcmFtIE9B
dXRoQ29uc3VtZXIgJGNvbnN1bWVyCiAgICogQHBhcmFtIE9BdXRoVG9rZW4gJHRva2VuCiAg
ICogQHBhcmFtIHN0cmluZyAkc2lnbmF0dXJlCiAgICogQHJldHVybiBib29sCiAgICovCiAg
cHVibGljIGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAk
dG9rZW4sICRzaWduYXR1cmUpIHsKICAgICRidWlsdCA9ICR0aGlzLT5idWlsZF9zaWduYXR1
cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKICAgIHJldHVybiAkYnVpbHQgPT0g
JHNpZ25hdHVyZTsKICB9Cn0KCi8qKgogKiBUaGUgSE1BQy1TSEExIHNpZ25hdHVyZSBtZXRo
b2QgdXNlcyB0aGUgSE1BQy1TSEExIHNpZ25hdHVyZSBhbGdvcml0aG0gYXMgZGVmaW5lZCBp
biBbUkZDMjEwNF0KICogd2hlcmUgdGhlIFNpZ25hdHVyZSBCYXNlIFN0cmluZyBpcyB0aGUg
dGV4dCBhbmQgdGhlIGtleSBpcyB0aGUgY29uY2F0ZW5hdGVkIHZhbHVlcyAoZWFjaCBmaXJz
dAogKiBlbmNvZGVkIHBlciBQYXJhbWV0ZXIgRW5jb2RpbmcpIG9mIHRoZSBDb25zdW1lciBT
ZWNyZXQgYW5kIFRva2VuIFNlY3JldCwgc2VwYXJhdGVkIGJ5IGFuICcmJwogKiBjaGFyYWN0
ZXIgKEFTQ0lJIGNvZGUgMzgpIGV2ZW4gaWYgZW1wdHkuCiAqICAgLSBDaGFwdGVyIDkuMiAo
IkhNQUMtU0hBMSIpCiAqLwpjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9ITUFDX1NIQTEg
ZXh0ZW5kcyBPQXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgZnVuY3Rpb24gZ2V0X25hbWUoKSB7
CiAgICByZXR1cm4gIkhNQUMtU0hBMSI7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRf
c2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJGJhc2Vfc3Ry
aW5nID0gJHJlcXVlc3QtPmdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKTsKICAgICRyZXF1
ZXN0LT5iYXNlX3N0cmluZyA9ICRiYXNlX3N0cmluZzsKCiAgICAka2V5X3BhcnRzID0gYXJy
YXkoCiAgICAgICRjb25zdW1lci0+c2VjcmV0LAogICAgICAoJHRva2VuKSA/ICR0b2tlbi0+
c2VjcmV0IDogIiIKICAgICk7CgogICAgJGtleV9wYXJ0cyA9IE9BdXRoVXRpbDo6dXJsZW5j
b2RlX3JmYzM5ODYoJGtleV9wYXJ0cyk7CiAgICAka2V5ID0gaW1wbG9kZSgnJicsICRrZXlf
cGFydHMpOwoKICAgIHJldHVybiBiYXNlNjRfZW5jb2RlKGhhc2hfaG1hYygnc2hhMScsICRi
YXNlX3N0cmluZywgJGtleSwgdHJ1ZSkpOwogIH0KfQoKLyoqCiAqIFRoZSBQTEFJTlRFWFQg
bWV0aG9kIGRvZXMgbm90IHByb3ZpZGUgYW55IHNlY3VyaXR5IHByb3RlY3Rpb24gYW5kIFNI
T1VMRCBvbmx5IGJlIHVzZWQKICogb3ZlciBhIHNlY3VyZSBjaGFubmVsIHN1Y2ggYXMgSFRU
UFMuIEl0IGRvZXMgbm90IHVzZSB0aGUgU2lnbmF0dXJlIEJhc2UgU3RyaW5nLgogKiAgIC0g
Q2hhcHRlciA5LjQgKCJQTEFJTlRFWFQiKQogKi8KY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRo
b2RfUExBSU5URVhUIGV4dGVuZHMgT0F1dGhTaWduYXR1cmVNZXRob2QgewogIHB1YmxpYyBm
dW5jdGlvbiBnZXRfbmFtZSgpIHsKICAgIHJldHVybiAiUExBSU5URVhUIjsKICB9CgogIC8q
KgogICAqIG9hdXRoX3NpZ25hdHVyZSBpcyBzZXQgdG8gdGhlIGNvbmNhdGVuYXRlZCBlbmNv
ZGVkIHZhbHVlcyBvZiB0aGUgQ29uc3VtZXIgU2VjcmV0IGFuZAogICAqIFRva2VuIFNlY3Jl
dCwgc2VwYXJhdGVkIGJ5IGEgJyYnIGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCksIGV2ZW4g
aWYgZWl0aGVyIHNlY3JldCBpcwogICAqIGVtcHR5LiBUaGUgcmVzdWx0IE1VU1QgYmUgZW5j
b2RlZCBhZ2Fpbi4KICAgKiAgIC0gQ2hhcHRlciA5LjQuMSAoIkdlbmVyYXRpbmcgU2lnbmF0
dXJlcyIpCiAgICoKICAgKiBQbGVhc2Ugbm90ZSB0aGF0IHRoZSBzZWNvbmQgZW5jb2Rpbmcg
TVVTVCBOT1QgaGFwcGVuIGluIHRoZSBTaWduYXR1cmVNZXRob2QsIGFzCiAgICogT0F1dGhS
ZXF1ZXN0IGhhbmRsZXMgdGhpcyEKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2ln
bmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJGtleV9wYXJ0cyA9
IGFycmF5KAogICAgICAkY29uc3VtZXItPnNlY3JldCwKICAgICAgKCR0b2tlbikgPyAkdG9r
ZW4tPnNlY3JldCA6ICIiCiAgICApOwoKICAgICRrZXlfcGFydHMgPSBPQXV0aFV0aWw6OnVy
bGVuY29kZV9yZmMzOTg2KCRrZXlfcGFydHMpOwogICAgJGtleSA9IGltcGxvZGUoJyYnLCAk
a2V5X3BhcnRzKTsKICAgICRyZXF1ZXN0LT5iYXNlX3N0cmluZyA9ICRrZXk7CgogICAgcmV0
dXJuICRrZXk7CiAgfQp9CgovKioKICogVGhlIFJTQS1TSEExIHNpZ25hdHVyZSBtZXRob2Qg
dXNlcyB0aGUgUlNBU1NBLVBLQ1MxLXYxXzUgc2lnbmF0dXJlIGFsZ29yaXRobSBhcyBkZWZp
bmVkIGluCiAqIFtSRkMzNDQ3XSBzZWN0aW9uIDguMiAobW9yZSBzaW1wbHkga25vd24gYXMg
UEtDUyMxKSwgdXNpbmcgU0hBLTEgYXMgdGhlIGhhc2ggZnVuY3Rpb24gZm9yCiAqIEVNU0Et
UEtDUzEtdjFfNS4gSXQgaXMgYXNzdW1lZCB0aGF0IHRoZSBDb25zdW1lciBoYXMgcHJvdmlk
ZWQgaXRzIFJTQSBwdWJsaWMga2V5IGluIGEKICogdmVyaWZpZWQgd2F5IHRvIHRoZSBTZXJ2
aWNlIFByb3ZpZGVyLCBpbiBhIG1hbm5lciB3aGljaCBpcyBiZXlvbmQgdGhlIHNjb3BlIG9m
IHRoaXMKICogc3BlY2lmaWNhdGlvbi4KICogICAtIENoYXB0ZXIgOS4zICgiUlNBLVNIQTEi
KQogKi8KYWJzdHJhY3QgY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2RfUlNBX1NIQTEgZXh0
ZW5kcyBPQXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgcHVibGljIGZ1bmN0aW9uIGdldF9uYW1l
KCkgewogICAgcmV0dXJuICJSU0EtU0hBMSI7CiAgfQoKICAvLyBVcCB0byB0aGUgU1AgdG8g
aW1wbGVtZW50IHRoaXMgbG9va3VwIG9mIGtleXMuIFBvc3NpYmxlIGlkZWFzIGFyZToKICAv
LyAoMSkgZG8gYSBsb29rdXAgaW4gYSB0YWJsZSBvZiB0cnVzdGVkIGNlcnRzIGtleWVkIG9m
ZiBvZiBjb25zdW1lcgogIC8vICgyKSBmZXRjaCB2aWEgaHR0cCB1c2luZyBhIHVybCBwcm92
aWRlZCBieSB0aGUgcmVxdWVzdGVyCiAgLy8gKDMpIHNvbWUgc29ydCBvZiBzcGVjaWZpYyBk
aXNjb3ZlcnkgY29kZSBiYXNlZCBvbiByZXF1ZXN0CiAgLy8KICAvLyBFaXRoZXIgd2F5IHNo
b3VsZCByZXR1cm4gYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIGNlcnRpZmljYXRl
CiAgcHJvdGVjdGVkIGFic3RyYWN0IGZ1bmN0aW9uIGZldGNoX3B1YmxpY19jZXJ0KCYkcmVx
dWVzdCk7CgogIC8vIFVwIHRvIHRoZSBTUCB0byBpbXBsZW1lbnQgdGhpcyBsb29rdXAgb2Yg
a2V5cy4gUG9zc2libGUgaWRlYXMgYXJlOgogIC8vICgxKSBkbyBhIGxvb2t1cCBpbiBhIHRh
YmxlIG9mIHRydXN0ZWQgY2VydHMga2V5ZWQgb2ZmIG9mIGNvbnN1bWVyCiAgLy8KICAvLyBF
aXRoZXIgd2F5IHNob3VsZCByZXR1cm4gYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhl
IGNlcnRpZmljYXRlCiAgcHJvdGVjdGVkIGFic3RyYWN0IGZ1bmN0aW9uIGZldGNoX3ByaXZh
dGVfY2VydCgmJHJlcXVlc3QpOwoKICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJl
KCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJGJhc2Vfc3RyaW5nID0gJHJl
cXVlc3QtPmdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKTsKICAgICRyZXF1ZXN0LT5iYXNl
X3N0cmluZyA9ICRiYXNlX3N0cmluZzsKCiAgICAvLyBGZXRjaCB0aGUgcHJpdmF0ZSBrZXkg
Y2VydCBiYXNlZCBvbiB0aGUgcmVxdWVzdAogICAgJGNlcnQgPSAkdGhpcy0+ZmV0Y2hfcHJp
dmF0ZV9jZXJ0KCRyZXF1ZXN0KTsKCiAgICAvLyBQdWxsIHRoZSBwcml2YXRlIGtleSBJRCBm
cm9tIHRoZSBjZXJ0aWZpY2F0ZQogICAgJHByaXZhdGVrZXlpZCA9IG9wZW5zc2xfZ2V0X3By
aXZhdGVrZXkoJGNlcnQpOwoKICAgIC8vIFNpZ24gdXNpbmcgdGhlIGtleQogICAgJG9rID0g
b3BlbnNzbF9zaWduKCRiYXNlX3N0cmluZywgJHNpZ25hdHVyZSwgJHByaXZhdGVrZXlpZCk7
CgogICAgLy8gUmVsZWFzZSB0aGUga2V5IHJlc291cmNlCiAgICBvcGVuc3NsX2ZyZWVfa2V5
KCRwcml2YXRla2V5aWQpOwoKICAgIHJldHVybiBiYXNlNjRfZW5jb2RlKCRzaWduYXR1cmUp
OwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNv
bnN1bWVyLCAkdG9rZW4sICRzaWduYXR1cmUpIHsKICAgICRkZWNvZGVkX3NpZyA9IGJhc2U2
NF9kZWNvZGUoJHNpZ25hdHVyZSk7CgogICAgJGJhc2Vfc3RyaW5nID0gJHJlcXVlc3QtPmdl
dF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKTsKCiAgICAvLyBGZXRjaCB0aGUgcHVibGljIGtl
eSBjZXJ0IGJhc2VkIG9uIHRoZSByZXF1ZXN0CiAgICAkY2VydCA9ICR0aGlzLT5mZXRjaF9w
dWJsaWNfY2VydCgkcmVxdWVzdCk7CgogICAgLy8gUHVsbCB0aGUgcHVibGljIGtleSBJRCBm
cm9tIHRoZSBjZXJ0aWZpY2F0ZQogICAgJHB1YmxpY2tleWlkID0gb3BlbnNzbF9nZXRfcHVi
bGlja2V5KCRjZXJ0KTsKCiAgICAvLyBDaGVjayB0aGUgY29tcHV0ZWQgc2lnbmF0dXJlIGFn
YWluc3QgdGhlIG9uZSBwYXNzZWQgaW4gdGhlIHF1ZXJ5CiAgICAkb2sgPSBvcGVuc3NsX3Zl
cmlmeSgkYmFzZV9zdHJpbmcsICRkZWNvZGVkX3NpZywgJHB1YmxpY2tleWlkKTsKCiAgICAv
LyBSZWxlYXNlIHRoZSBrZXkgcmVzb3VyY2UKICAgIG9wZW5zc2xfZnJlZV9rZXkoJHB1Ymxp
Y2tleWlkKTsKCiAgICByZXR1cm4gJG9rID09IDE7CiAgfQp9CgpjbGFzcyBPQXV0aFJlcXVl
c3QgewogIHByaXZhdGUgJHBhcmFtZXRlcnM7CiAgcHJpdmF0ZSAkaHR0cF9tZXRob2Q7CiAg
cHJpdmF0ZSAkaHR0cF91cmw7CiAgLy8gZm9yIGRlYnVnIHB1cnBvc2VzCiAgcHVibGljICRi
YXNlX3N0cmluZzsKICBwdWJsaWMgc3RhdGljICR2ZXJzaW9uID0gJzEuMCc7CiAgcHVibGlj
IHN0YXRpYyAkUE9TVF9JTlBVVCA9ICdwaHA6Ly9pbnB1dCc7CgogIGZ1bmN0aW9uIF9fY29u
c3RydWN0KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycz1OVUxMKSB7CiAg
ICBAJHBhcmFtZXRlcnMgb3IgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgJHBhcmFtZXRl
cnMgPSBhcnJheV9tZXJnZSggT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKHBhcnNlX3Vy
bCgkaHR0cF91cmwsIFBIUF9VUkxfUVVFUlkpKSwgJHBhcmFtZXRlcnMpOwogICAgJHRoaXMt
PnBhcmFtZXRlcnMgPSAkcGFyYW1ldGVyczsKICAgICR0aGlzLT5odHRwX21ldGhvZCA9ICRo
dHRwX21ldGhvZDsKICAgICR0aGlzLT5odHRwX3VybCA9ICRodHRwX3VybDsKICB9CgoKICAv
KioKICAgKiBhdHRlbXB0IHRvIGJ1aWxkIHVwIGEgcmVxdWVzdCBmcm9tIHdoYXQgd2FzIHBh
c3NlZCB0byB0aGUgc2VydmVyCiAgICovCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBmcm9t
X3JlcXVlc3QoJGh0dHBfbWV0aG9kPU5VTEwsICRodHRwX3VybD1OVUxMLCAkcGFyYW1ldGVy
cz1OVUxMKSB7CiAgICAkc2NoZW1lID0gKCFpc3NldCgkX1NFUlZFUlsnSFRUUFMnXSkgfHwg
JF9TRVJWRVJbJ0hUVFBTJ10gIT0gIm9uIikKICAgICAgICAgICAgICA/ICdodHRwJwogICAg
ICAgICAgICAgIDogJ2h0dHBzJzsKICAgIEAkaHR0cF91cmwgb3IgJGh0dHBfdXJsID0gJHNj
aGVtZSAuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc6Ly8nIC4gJF9TRVJWRVJb
J0hUVFBfSE9TVCddIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzonIC4KICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgJF9TRVJWRVJbJ1NFUlZFUl9QT1JUJ10gLgog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkX1NFUlZFUlsnUkVRVUVTVF9VUkknXTsK
ICAgIEAkaHR0cF9tZXRob2Qgb3IgJGh0dHBfbWV0aG9kID0gJF9TRVJWRVJbJ1JFUVVFU1Rf
TUVUSE9EJ107CgogICAgLy8gV2Ugd2VyZW4ndCBoYW5kZWQgYW55IHBhcmFtZXRlcnMsIHNv
IGxldCdzIGZpbmQgdGhlIG9uZXMgcmVsZXZhbnQgdG8KICAgIC8vIHRoaXMgcmVxdWVzdC4K
ICAgIC8vIElmIHlvdSBydW4gWE1MLVJQQyBvciBzaW1pbGFyIHlvdSBzaG91bGQgdXNlIHRo
aXMgdG8gcHJvdmlkZSB5b3VyIG93bgogICAgLy8gcGFyc2VkIHBhcmFtZXRlci1saXN0CiAg
ICBpZiAoISRwYXJhbWV0ZXJzKSB7CiAgICAgIC8vIEZpbmQgcmVxdWVzdCBoZWFkZXJzCiAg
ICAgICRyZXF1ZXN0X2hlYWRlcnMgPSBPQXV0aFV0aWw6OmdldF9oZWFkZXJzKCk7CgogICAg
ICAvLyBQYXJzZSB0aGUgcXVlcnktc3RyaW5nIHRvIGZpbmQgR0VUIHBhcmFtZXRlcnMKICAg
ICAgJHBhcmFtZXRlcnMgPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoJF9TRVJWRVJb
J1FVRVJZX1NUUklORyddKTsKCiAgICAgIC8vIEl0J3MgYSBQT1NUIHJlcXVlc3Qgb2YgdGhl
IHByb3BlciBjb250ZW50LXR5cGUsIHNvIHBhcnNlIFBPU1QKICAgICAgLy8gcGFyYW1ldGVy
cyBhbmQgYWRkIHRob3NlIG92ZXJyaWRpbmcgYW55IGR1cGxpY2F0ZXMgZnJvbSBHRVQKICAg
ICAgaWYgKCRodHRwX21ldGhvZCA9PSAiUE9TVCIKICAgICAgICAgICYmIEBzdHJzdHIoJHJl
cXVlc3RfaGVhZGVyc1siQ29udGVudC1UeXBlIl0sCiAgICAgICAgICAgICAgICAgICAgICJh
cHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKQogICAgICAgICAgKSB7CiAgICAg
ICAgJHBvc3RfZGF0YSA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygKICAgICAgICAg
IGZpbGVfZ2V0X2NvbnRlbnRzKHNlbGY6OiRQT1NUX0lOUFVUKQogICAgICAgICk7CiAgICAg
ICAgJHBhcmFtZXRlcnMgPSBhcnJheV9tZXJnZSgkcGFyYW1ldGVycywgJHBvc3RfZGF0YSk7
CiAgICAgIH0KCiAgICAgIC8vIFdlIGhhdmUgYSBBdXRob3JpemF0aW9uLWhlYWRlciB3aXRo
IE9BdXRoIGRhdGEuIFBhcnNlIHRoZSBoZWFkZXIKICAgICAgLy8gYW5kIGFkZCB0aG9zZSBv
dmVycmlkaW5nIGFueSBkdXBsaWNhdGVzIGZyb20gR0VUIG9yIFBPU1QKICAgICAgaWYgKEBz
dWJzdHIoJHJlcXVlc3RfaGVhZGVyc1snQXV0aG9yaXphdGlvbiddLCAwLCA2KSA9PSAiT0F1
dGggIikgewogICAgICAgICRoZWFkZXJfcGFyYW1ldGVycyA9IE9BdXRoVXRpbDo6c3BsaXRf
aGVhZGVyKAogICAgICAgICAgJHJlcXVlc3RfaGVhZGVyc1snQXV0aG9yaXphdGlvbiddCiAg
ICAgICAgKTsKICAgICAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCRwYXJhbWV0ZXJz
LCAkaGVhZGVyX3BhcmFtZXRlcnMpOwogICAgICB9CgogICAgfQoKICAgIHJldHVybiBuZXcg
T0F1dGhSZXF1ZXN0KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycyk7CiAg
fQoKICAvKioKICAgKiBwcmV0dHkgbXVjaCBhIGhlbHBlciBmdW5jdGlvbiB0byBzZXQgdXAg
dGhlIHJlcXVlc3QKICAgKi8KICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGZyb21fY29uc3Vt
ZXJfYW5kX3Rva2VuKCRjb25zdW1lciwgJHRva2VuLCAkaHR0cF9tZXRob2QsICRodHRwX3Vy
bCwgJHBhcmFtZXRlcnM9TlVMTCkgewogICAgQCRwYXJhbWV0ZXJzIG9yICRwYXJhbWV0ZXJz
ID0gYXJyYXkoKTsKICAgICRkZWZhdWx0cyA9IGFycmF5KCJvYXV0aF92ZXJzaW9uIiA9PiBP
QXV0aFJlcXVlc3Q6OiR2ZXJzaW9uLAogICAgICAgICAgICAgICAgICAgICAgIm9hdXRoX25v
bmNlIiA9PiBPQXV0aFJlcXVlc3Q6OmdlbmVyYXRlX25vbmNlKCksCiAgICAgICAgICAgICAg
ICAgICAgICAib2F1dGhfdGltZXN0YW1wIiA9PiBPQXV0aFJlcXVlc3Q6OmdlbmVyYXRlX3Rp
bWVzdGFtcCgpLAogICAgICAgICAgICAgICAgICAgICAgIm9hdXRoX2NvbnN1bWVyX2tleSIg
PT4gJGNvbnN1bWVyLT5rZXkpOwogICAgaWYgKCR0b2tlbikKICAgICAgJGRlZmF1bHRzWydv
YXV0aF90b2tlbiddID0gJHRva2VuLT5rZXk7CgogICAgJHBhcmFtZXRlcnMgPSBhcnJheV9t
ZXJnZSgkZGVmYXVsdHMsICRwYXJhbWV0ZXJzKTsKCiAgICByZXR1cm4gbmV3IE9BdXRoUmVx
dWVzdCgkaHR0cF9tZXRob2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnMpOwogIH0KCiAgcHVi
bGljIGZ1bmN0aW9uIHNldF9wYXJhbWV0ZXIoJG5hbWUsICR2YWx1ZSwgJGFsbG93X2R1cGxp
Y2F0ZXMgPSB0cnVlKSB7CiAgICBpZiAoJGFsbG93X2R1cGxpY2F0ZXMgJiYgaXNzZXQoJHRo
aXMtPnBhcmFtZXRlcnNbJG5hbWVdKSkgewogICAgICAvLyBXZSBoYXZlIGFscmVhZHkgYWRk
ZWQgcGFyYW1ldGVyKHMpIHdpdGggdGhpcyBuYW1lLCBzbyBhZGQgdG8gdGhlIGxpc3QKICAg
ICAgaWYgKGlzX3NjYWxhcigkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pKSB7CiAgICAgICAg
Ly8gVGhpcyBpcyB0aGUgZmlyc3QgZHVwbGljYXRlLCBzbyB0cmFuc2Zvcm0gc2NhbGFyIChz
dHJpbmcpCiAgICAgICAgLy8gaW50byBhbiBhcnJheSBzbyB3ZSBjYW4gYWRkIHRoZSBkdXBs
aWNhdGVzCiAgICAgICAgJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdID0gYXJyYXkoJHRoaXMt
PnBhcmFtZXRlcnNbJG5hbWVdKTsKICAgICAgfQoKICAgICAgJHRoaXMtPnBhcmFtZXRlcnNb
JG5hbWVdW10gPSAkdmFsdWU7CiAgICB9IGVsc2UgewogICAgICAkdGhpcy0+cGFyYW1ldGVy
c1skbmFtZV0gPSAkdmFsdWU7CiAgICB9CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3Bh
cmFtZXRlcigkbmFtZSkgewogICAgcmV0dXJuIGlzc2V0KCR0aGlzLT5wYXJhbWV0ZXJzWyRu
YW1lXSkgPyAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0gOiBudWxsOwogIH0KCiAgcHVibGlj
IGZ1bmN0aW9uIGdldF9wYXJhbWV0ZXJzKCkgewogICAgcmV0dXJuICR0aGlzLT5wYXJhbWV0
ZXJzOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIHVuc2V0X3BhcmFtZXRlcigkbmFtZSkgewog
ICAgdW5zZXQoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKTsKICB9CgogIC8qKgogICAqIFRo
ZSByZXF1ZXN0IHBhcmFtZXRlcnMsIHNvcnRlZCBhbmQgY29uY2F0ZW5hdGVkIGludG8gYSBu
b3JtYWxpemVkIHN0cmluZy4KICAgKiBAcmV0dXJuIHN0cmluZwogICAqLwogIHB1YmxpYyBm
dW5jdGlvbiBnZXRfc2lnbmFibGVfcGFyYW1ldGVycygpIHsKICAgIC8vIEdyYWIgYWxsIHBh
cmFtZXRlcnMKICAgICRwYXJhbXMgPSAkdGhpcy0+cGFyYW1ldGVyczsKCiAgICAvLyBSZW1v
dmUgb2F1dGhfc2lnbmF0dXJlIGlmIHByZXNlbnQKICAgIC8vIFJlZjogU3BlYzogOS4xLjEg
KCJUaGUgb2F1dGhfc2lnbmF0dXJlIHBhcmFtZXRlciBNVVNUIGJlIGV4Y2x1ZGVkLiIpCiAg
ICBpZiAoaXNzZXQoJHBhcmFtc1snb2F1dGhfc2lnbmF0dXJlJ10pKSB7CiAgICAgIHVuc2V0
KCRwYXJhbXNbJ29hdXRoX3NpZ25hdHVyZSddKTsKICAgIH0KCiAgICByZXR1cm4gT0F1dGhV
dGlsOjpidWlsZF9odHRwX3F1ZXJ5KCRwYXJhbXMpOwogIH0KCiAgLyoqCiAgICogUmV0dXJu
cyB0aGUgYmFzZSBzdHJpbmcgb2YgdGhpcyByZXF1ZXN0CiAgICoKICAgKiBUaGUgYmFzZSBz
dHJpbmcgZGVmaW5lZCBhcyB0aGUgbWV0aG9kLCB0aGUgdXJsCiAgICogYW5kIHRoZSBwYXJh
bWV0ZXJzIChub3JtYWxpemVkKSwgZWFjaCB1cmxlbmNvZGVkCiAgICogYW5kIHRoZSBjb25j
YXRlZCB3aXRoICYuCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9zaWduYXR1cmVfYmFz
ZV9zdHJpbmcoKSB7CiAgICAkcGFydHMgPSBhcnJheSgKICAgICAgJHRoaXMtPmdldF9ub3Jt
YWxpemVkX2h0dHBfbWV0aG9kKCksCiAgICAgICR0aGlzLT5nZXRfbm9ybWFsaXplZF9odHRw
X3VybCgpLAogICAgICAkdGhpcy0+Z2V0X3NpZ25hYmxlX3BhcmFtZXRlcnMoKQogICAgKTsK
CiAgICAkcGFydHMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRwYXJ0cyk7Cgog
ICAgcmV0dXJuIGltcGxvZGUoJyYnLCAkcGFydHMpOwogIH0KCiAgLyoqCiAgICoganVzdCB1
cHBlcmNhc2VzIHRoZSBodHRwIG1ldGhvZAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBnZXRf
bm9ybWFsaXplZF9odHRwX21ldGhvZCgpIHsKICAgIHJldHVybiBzdHJ0b3VwcGVyKCR0aGlz
LT5odHRwX21ldGhvZCk7CiAgfQoKICAvKioKICAgKiBwYXJzZXMgdGhlIHVybCBhbmQgcmVi
dWlsZHMgaXQgdG8gYmUKICAgKiBzY2hlbWU6Ly9ob3N0L3BhdGgKICAgKi8KICBwdWJsaWMg
ZnVuY3Rpb24gZ2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKSB7CiAgICAkcGFydHMgPSBwYXJz
ZV91cmwoJHRoaXMtPmh0dHBfdXJsKTsKCiAgICAkcG9ydCA9IEAkcGFydHNbJ3BvcnQnXTsK
ICAgICRzY2hlbWUgPSAkcGFydHNbJ3NjaGVtZSddOwogICAgJGhvc3QgPSAkcGFydHNbJ2hv
c3QnXTsKICAgICRwYXRoID0gQCRwYXJ0c1sncGF0aCddOwoKICAgICRwb3J0IG9yICRwb3J0
ID0gKCRzY2hlbWUgPT0gJ2h0dHBzJykgPyAnNDQzJyA6ICc4MCc7CgogICAgaWYgKCgkc2No
ZW1lID09ICdodHRwcycgJiYgJHBvcnQgIT0gJzQ0MycpCiAgICAgICAgfHwgKCRzY2hlbWUg
PT0gJ2h0dHAnICYmICRwb3J0ICE9ICc4MCcpKSB7CiAgICAgICRob3N0ID0gIiRob3N0OiRw
b3J0IjsKICAgIH0KICAgIHJldHVybiAiJHNjaGVtZTovLyRob3N0JHBhdGgiOwogIH0KCiAg
LyoqCiAgICogYnVpbGRzIGEgdXJsIHVzYWJsZSBmb3IgYSBHRVQgcmVxdWVzdAogICAqLwog
IHB1YmxpYyBmdW5jdGlvbiB0b191cmwoKSB7CiAgICAkcG9zdF9kYXRhID0gJHRoaXMtPnRv
X3Bvc3RkYXRhKCk7CiAgICAkb3V0ID0gJHRoaXMtPmdldF9ub3JtYWxpemVkX2h0dHBfdXJs
KCk7CiAgICBpZiAoJHBvc3RfZGF0YSkgewogICAgICAkb3V0IC49ICc/Jy4kcG9zdF9kYXRh
OwogICAgfQogICAgcmV0dXJuICRvdXQ7CiAgfQoKICAvKioKICAgKiBidWlsZHMgdGhlIGRh
dGEgb25lIHdvdWxkIHNlbmQgaW4gYSBQT1NUIHJlcXVlc3QKICAgKi8KICBwdWJsaWMgZnVu
Y3Rpb24gdG9fcG9zdGRhdGEoKSB7CiAgICByZXR1cm4gT0F1dGhVdGlsOjpidWlsZF9odHRw
X3F1ZXJ5KCR0aGlzLT5wYXJhbWV0ZXJzKTsKICB9CgogIC8qKgogICAqIGJ1aWxkcyB0aGUg
QXV0aG9yaXphdGlvbjogaGVhZGVyCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHRvX2hlYWRl
cigkcmVhbG09bnVsbCkgewogICAgJGZpcnN0ID0gdHJ1ZTsKICBpZigkcmVhbG0pIHsKICAg
ICAgJG91dCA9ICdBdXRob3JpemF0aW9uOiBPQXV0aCByZWFsbT0iJyAuIE9BdXRoVXRpbDo6
dXJsZW5jb2RlX3JmYzM5ODYoJHJlYWxtKSAuICciJzsKICAgICAgJGZpcnN0ID0gZmFsc2U7
CiAgICB9IGVsc2UKICAgICAgJG91dCA9ICdBdXRob3JpemF0aW9uOiBPQXV0aCc7CgogICAg
JHRvdGFsID0gYXJyYXkoKTsKICAgIGZvcmVhY2ggKCR0aGlzLT5wYXJhbWV0ZXJzIGFzICRr
ID0+ICR2KSB7CiAgICAgIGlmIChzdWJzdHIoJGssIDAsIDUpICE9ICJvYXV0aCIpIGNvbnRp
bnVlOwogICAgICBpZiAoaXNfYXJyYXkoJHYpKSB7CiAgICAgICAgdGhyb3cgbmV3IE9BdXRo
RXhjZXB0aW9uKCdBcnJheXMgbm90IHN1cHBvcnRlZCBpbiBoZWFkZXJzJyk7CiAgICAgIH0K
ICAgICAgJG91dCAuPSAoJGZpcnN0KSA/ICcgJyA6ICcsJzsKICAgICAgJG91dCAuPSBPQXV0
aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRrKSAuCiAgICAgICAgICAgICAgJz0iJyAuCiAg
ICAgICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkdikgLgogICAgICAg
ICAgICAgICciJzsKICAgICAgJGZpcnN0ID0gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gJG91
dDsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBfX3RvU3RyaW5nKCkgewogICAgcmV0dXJuICR0
aGlzLT50b191cmwoKTsKICB9CgoKICBwdWJsaWMgZnVuY3Rpb24gc2lnbl9yZXF1ZXN0KCRz
aWduYXR1cmVfbWV0aG9kLCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJHRoaXMtPnNldF9w
YXJhbWV0ZXIoCiAgICAgICJvYXV0aF9zaWduYXR1cmVfbWV0aG9kIiwKICAgICAgJHNpZ25h
dHVyZV9tZXRob2QtPmdldF9uYW1lKCksCiAgICAgIGZhbHNlCiAgICApOwogICAgJHNpZ25h
dHVyZSA9ICR0aGlzLT5idWlsZF9zaWduYXR1cmUoJHNpZ25hdHVyZV9tZXRob2QsICRjb25z
dW1lciwgJHRva2VuKTsKICAgICR0aGlzLT5zZXRfcGFyYW1ldGVyKCJvYXV0aF9zaWduYXR1
cmUiLCAkc2lnbmF0dXJlLCBmYWxzZSk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRf
c2lnbmF0dXJlKCRzaWduYXR1cmVfbWV0aG9kLCAkY29uc3VtZXIsICR0b2tlbikgewogICAg
JHNpZ25hdHVyZSA9ICRzaWduYXR1cmVfbWV0aG9kLT5idWlsZF9zaWduYXR1cmUoJHRoaXMs
ICRjb25zdW1lciwgJHRva2VuKTsKICAgIHJldHVybiAkc2lnbmF0dXJlOwogIH0KCiAgLyoq
CiAgICogdXRpbCBmdW5jdGlvbjogY3VycmVudCB0aW1lc3RhbXAKICAgKi8KICBwcml2YXRl
IHN0YXRpYyBmdW5jdGlvbiBnZW5lcmF0ZV90aW1lc3RhbXAoKSB7CiAgICByZXR1cm4gdGlt
ZSgpOwogIH0KCiAgLyoqCiAgICogdXRpbCBmdW5jdGlvbjogY3VycmVudCBub25jZQogICAq
LwogIHByaXZhdGUgc3RhdGljIGZ1bmN0aW9uIGdlbmVyYXRlX25vbmNlKCkgewogICAgJG10
ID0gbWljcm90aW1lKCk7CiAgICAkcmFuZCA9IG10X3JhbmQoKTsKCiAgICByZXR1cm4gbWQ1
KCRtdCAuICRyYW5kKTsgLy8gbWQ1cyBsb29rIG5pY2VyIHRoYW4gbnVtYmVycwogIH0KfQoK
Y2xhc3MgT0F1dGhTZXJ2ZXIgewogIHByb3RlY3RlZCAkdGltZXN0YW1wX3RocmVzaG9sZCA9
IDMwMDsgLy8gaW4gc2Vjb25kcywgZml2ZSBtaW51dGVzCiAgcHJvdGVjdGVkICR2ZXJzaW9u
ID0gJzEuMCc7ICAgICAgICAgICAgIC8vIGhpIGJsYWluZQogIHByb3RlY3RlZCAkc2lnbmF0
dXJlX21ldGhvZHMgPSBhcnJheSgpOwoKICBwcm90ZWN0ZWQgJGRhdGFfc3RvcmU7CgogIGZ1
bmN0aW9uIF9fY29uc3RydWN0KCRkYXRhX3N0b3JlKSB7CiAgICAkdGhpcy0+ZGF0YV9zdG9y
ZSA9ICRkYXRhX3N0b3JlOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGFkZF9zaWduYXR1cmVf
bWV0aG9kKCRzaWduYXR1cmVfbWV0aG9kKSB7CiAgICAkdGhpcy0+c2lnbmF0dXJlX21ldGhv
ZHNbJHNpZ25hdHVyZV9tZXRob2QtPmdldF9uYW1lKCldID0KICAgICAgJHNpZ25hdHVyZV9t
ZXRob2Q7CiAgfQoKICAvLyBoaWdoIGxldmVsIGZ1bmN0aW9ucwoKICAvKioKICAgKiBwcm9j
ZXNzIGEgcmVxdWVzdF90b2tlbiByZXF1ZXN0CiAgICogcmV0dXJucyB0aGUgcmVxdWVzdCB0
b2tlbiBvbiBzdWNjZXNzCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGZldGNoX3JlcXVlc3Rf
dG9rZW4oJiRyZXF1ZXN0KSB7CiAgICAkdGhpcy0+Z2V0X3ZlcnNpb24oJHJlcXVlc3QpOwoK
ICAgICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVlc3QpOwoKICAgIC8v
IG5vIHRva2VuIHJlcXVpcmVkIGZvciB0aGUgaW5pdGlhbCB0b2tlbiByZXF1ZXN0CiAgICAk
dG9rZW4gPSBOVUxMOwoKICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRj
b25zdW1lciwgJHRva2VuKTsKCiAgICAvLyBSZXYgQSBjaGFuZ2UKICAgICRjYWxsYmFjayA9
ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF9jYWxsYmFjaycpOwogICAgJG5ld190
b2tlbiA9ICR0aGlzLT5kYXRhX3N0b3JlLT5uZXdfcmVxdWVzdF90b2tlbigkY29uc3VtZXIs
ICRjYWxsYmFjayk7CgogICAgcmV0dXJuICRuZXdfdG9rZW47CiAgfQoKICAvKioKICAgKiBw
cm9jZXNzIGFuIGFjY2Vzc190b2tlbiByZXF1ZXN0CiAgICogcmV0dXJucyB0aGUgYWNjZXNz
IHRva2VuIG9uIHN1Y2Nlc3MKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZmV0Y2hfYWNjZXNz
X3Rva2VuKCYkcmVxdWVzdCkgewogICAgJHRoaXMtPmdldF92ZXJzaW9uKCRyZXF1ZXN0KTsK
CiAgICAkY29uc3VtZXIgPSAkdGhpcy0+Z2V0X2NvbnN1bWVyKCRyZXF1ZXN0KTsKCiAgICAv
LyByZXF1aXJlcyBhdXRob3JpemVkIHJlcXVlc3QgdG9rZW4KICAgICR0b2tlbiA9ICR0aGlz
LT5nZXRfdG9rZW4oJHJlcXVlc3QsICRjb25zdW1lciwgInJlcXVlc3QiKTsKCiAgICAkdGhp
cy0+Y2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CgogICAg
Ly8gUmV2IEEgY2hhbmdlCiAgICAkdmVyaWZpZXIgPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRl
cignb2F1dGhfdmVyaWZpZXInKTsKICAgICRuZXdfdG9rZW4gPSAkdGhpcy0+ZGF0YV9zdG9y
ZS0+bmV3X2FjY2Vzc190b2tlbigkdG9rZW4sICRjb25zdW1lciwgJHZlcmlmaWVyKTsKCiAg
ICByZXR1cm4gJG5ld190b2tlbjsKICB9CgogIC8qKgogICAqIHZlcmlmeSBhbiBhcGkgY2Fs
bCwgY2hlY2tzIGFsbCB0aGUgcGFyYW1ldGVycwogICAqLwogIHB1YmxpYyBmdW5jdGlvbiB2
ZXJpZnlfcmVxdWVzdCgmJHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRfdmVyc2lvbigkcmVx
dWVzdCk7CiAgICAkY29uc3VtZXIgPSAkdGhpcy0+Z2V0X2NvbnN1bWVyKCRyZXF1ZXN0KTsK
ICAgICR0b2tlbiA9ICR0aGlzLT5nZXRfdG9rZW4oJHJlcXVlc3QsICRjb25zdW1lciwgImFj
Y2VzcyIpOwogICAgJHRoaXMtPmNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVy
LCAkdG9rZW4pOwogICAgcmV0dXJuIGFycmF5KCRjb25zdW1lciwgJHRva2VuKTsKICB9Cgog
IC8vIEludGVybmFscyBmcm9tIGhlcmUKICAvKioKICAgKiB2ZXJzaW9uIDEKICAgKi8KICBw
cml2YXRlIGZ1bmN0aW9uIGdldF92ZXJzaW9uKCYkcmVxdWVzdCkgewogICAgJHZlcnNpb24g
PSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcigib2F1dGhfdmVyc2lvbiIpOwogICAgaWYgKCEk
dmVyc2lvbikgewogICAgICAvLyBTZXJ2aWNlIFByb3ZpZGVycyBNVVNUIGFzc3VtZSB0aGUg
cHJvdG9jb2wgdmVyc2lvbiB0byBiZSAxLjAgaWYgdGhpcyBwYXJhbWV0ZXIgaXMgbm90IHBy
ZXNlbnQuCiAgICAgIC8vIENoYXB0ZXIgNy4wICgiQWNjZXNzaW5nIFByb3RlY3RlZCBSZXNz
b3VyY2VzIikKICAgICAgJHZlcnNpb24gPSAnMS4wJzsKICAgIH0KICAgIGlmICgkdmVyc2lv
biAhPT0gJHRoaXMtPnZlcnNpb24pIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9u
KCJPQXV0aCB2ZXJzaW9uICckdmVyc2lvbicgbm90IHN1cHBvcnRlZCIpOwogICAgfQogICAg
cmV0dXJuICR2ZXJzaW9uOwogIH0KCiAgLyoqCiAgICogZmlndXJlIG91dCB0aGUgc2lnbmF0
dXJlIHdpdGggc29tZSBkZWZhdWx0cwogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3Np
Z25hdHVyZV9tZXRob2QoJiRyZXF1ZXN0KSB7CiAgICAkc2lnbmF0dXJlX21ldGhvZCA9CiAg
ICAgICAgQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF9zaWduYXR1cmVfbWV0aG9k
Iik7CgogICAgaWYgKCEkc2lnbmF0dXJlX21ldGhvZCkgewogICAgICAvLyBBY2NvcmRpbmcg
dG8gY2hhcHRlciA3ICgiQWNjZXNzaW5nIFByb3RlY3RlZCBSZXNzb3VyY2VzIikgdGhlIHNp
Z25hdHVyZS1tZXRob2QKICAgICAgLy8gcGFyYW1ldGVyIGlzIHJlcXVpcmVkLCBhbmQgd2Ug
Y2FuJ3QganVzdCBmYWxsYmFjayB0byBQTEFJTlRFWFQKICAgICAgdGhyb3cgbmV3IE9BdXRo
RXhjZXB0aW9uKCdObyBzaWduYXR1cmUgbWV0aG9kIHBhcmFtZXRlci4gVGhpcyBwYXJhbWV0
ZXIgaXMgcmVxdWlyZWQnKTsKICAgIH0KCiAgICBpZiAoIWluX2FycmF5KCRzaWduYXR1cmVf
bWV0aG9kLAogICAgICAgICAgICAgICAgICBhcnJheV9rZXlzKCR0aGlzLT5zaWduYXR1cmVf
bWV0aG9kcykpKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAi
U2lnbmF0dXJlIG1ldGhvZCAnJHNpZ25hdHVyZV9tZXRob2QnIG5vdCBzdXBwb3J0ZWQgIiAu
CiAgICAgICAgInRyeSBvbmUgb2YgdGhlIGZvbGxvd2luZzogIiAuCiAgICAgICAgaW1wbG9k
ZSgiLCAiLCBhcnJheV9rZXlzKCR0aGlzLT5zaWduYXR1cmVfbWV0aG9kcykpCiAgICAgICk7
CiAgICB9CiAgICByZXR1cm4gJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzWyRzaWduYXR1cmVf
bWV0aG9kXTsKICB9CgogIC8qKgogICAqIHRyeSB0byBmaW5kIHRoZSBjb25zdW1lciBmb3Ig
dGhlIHByb3ZpZGVkIHJlcXVlc3QncyBjb25zdW1lciBrZXkKICAgKi8KICBwcml2YXRlIGZ1
bmN0aW9uIGdldF9jb25zdW1lcigmJHJlcXVlc3QpIHsKICAgICRjb25zdW1lcl9rZXkgPSBA
JHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoIm9hdXRoX2NvbnN1bWVyX2tleSIpOwogICAgaWYg
KCEkY29uc3VtZXJfa2V5KSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52
YWxpZCBjb25zdW1lciBrZXkiKTsKICAgIH0KCiAgICAkY29uc3VtZXIgPSAkdGhpcy0+ZGF0
YV9zdG9yZS0+bG9va3VwX2NvbnN1bWVyKCRjb25zdW1lcl9rZXkpOwogICAgaWYgKCEkY29u
c3VtZXIpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkIGNvbnN1
bWVyIik7CiAgICB9CgogICAgcmV0dXJuICRjb25zdW1lcjsKICB9CgogIC8qKgogICAqIHRy
eSB0byBmaW5kIHRoZSB0b2tlbiBmb3IgdGhlIHByb3ZpZGVkIHJlcXVlc3QncyB0b2tlbiBr
ZXkKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGdldF90b2tlbigmJHJlcXVlc3QsICRjb25z
dW1lciwgJHRva2VuX3R5cGU9ImFjY2VzcyIpIHsKICAgICR0b2tlbl9maWVsZCA9IEAkcmVx
dWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfdG9rZW4nKTsKICAgICR0b2tlbiA9ICR0aGlz
LT5kYXRhX3N0b3JlLT5sb29rdXBfdG9rZW4oCiAgICAgICRjb25zdW1lciwgJHRva2VuX3R5
cGUsICR0b2tlbl9maWVsZAogICAgKTsKICAgIGlmICghJHRva2VuKSB7CiAgICAgIHRocm93
IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52YWxpZCAkdG9rZW5fdHlwZSB0b2tlbjogJHRva2Vu
X2ZpZWxkIik7CiAgICB9CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogYWxs
LWluLW9uZSBmdW5jdGlvbiB0byBjaGVjayB0aGUgc2lnbmF0dXJlIG9uIGEgcmVxdWVzdAog
ICAqIHNob3VsZCBndWVzcyB0aGUgc2lnbmF0dXJlIG1ldGhvZCBhcHByb3ByaWF0ZWx5CiAg
ICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBjaGVja19zaWduYXR1cmUoJiRyZXF1ZXN0LCAkY29u
c3VtZXIsICR0b2tlbikgewogICAgLy8gdGhpcyBzaG91bGQgcHJvYmFibHkgYmUgaW4gYSBk
aWZmZXJlbnQgbWV0aG9kCiAgICAkdGltZXN0YW1wID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1l
dGVyKCdvYXV0aF90aW1lc3RhbXAnKTsKICAgICRub25jZSA9IEAkcmVxdWVzdC0+Z2V0X3Bh
cmFtZXRlcignb2F1dGhfbm9uY2UnKTsKCiAgICAkdGhpcy0+Y2hlY2tfdGltZXN0YW1wKCR0
aW1lc3RhbXApOwogICAgJHRoaXMtPmNoZWNrX25vbmNlKCRjb25zdW1lciwgJHRva2VuLCAk
bm9uY2UsICR0aW1lc3RhbXApOwoKICAgICRzaWduYXR1cmVfbWV0aG9kID0gJHRoaXMtPmdl
dF9zaWduYXR1cmVfbWV0aG9kKCRyZXF1ZXN0KTsKCiAgICAkc2lnbmF0dXJlID0gJHJlcXVl
c3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX3NpZ25hdHVyZScpOwogICAgJHZhbGlkX3NpZyA9
ICRzaWduYXR1cmVfbWV0aG9kLT5jaGVja19zaWduYXR1cmUoCiAgICAgICRyZXF1ZXN0LAog
ICAgICAkY29uc3VtZXIsCiAgICAgICR0b2tlbiwKICAgICAgJHNpZ25hdHVyZQogICAgKTsK
CiAgICBpZiAoISR2YWxpZF9zaWcpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9u
KCJJbnZhbGlkIHNpZ25hdHVyZSIpOwogICAgfQogIH0KCiAgLyoqCiAgICogY2hlY2sgdGhh
dCB0aGUgdGltZXN0YW1wIGlzIG5ldyBlbm91Z2gKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9u
IGNoZWNrX3RpbWVzdGFtcCgkdGltZXN0YW1wKSB7CiAgICBpZiggISAkdGltZXN0YW1wICkK
ICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICdNaXNzaW5nIHRpbWVz
dGFtcCBwYXJhbWV0ZXIuIFRoZSBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnCiAgICAgICk7Cgog
ICAgLy8gdmVyaWZ5IHRoYXQgdGltZXN0YW1wIGlzIHJlY2VudGlzaAogICAgJG5vdyA9IHRp
bWUoKTsKICAgIGlmIChhYnMoJG5vdyAtICR0aW1lc3RhbXApID4gJHRoaXMtPnRpbWVzdGFt
cF90aHJlc2hvbGQpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAg
ICJFeHBpcmVkIHRpbWVzdGFtcCwgeW91cnMgJHRpbWVzdGFtcCwgb3VycyAkbm93IgogICAg
ICApOwogICAgfQogIH0KCiAgLyoqCiAgICogY2hlY2sgdGhhdCB0aGUgbm9uY2UgaXMgbm90
IHJlcGVhdGVkCiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBjaGVja19ub25jZSgkY29uc3Vt
ZXIsICR0b2tlbiwgJG5vbmNlLCAkdGltZXN0YW1wKSB7CiAgICBpZiggISAkbm9uY2UgKQog
ICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgJ01pc3Npbmcgbm9uY2Ug
cGFyYW1ldGVyLiBUaGUgcGFyYW1ldGVyIGlzIHJlcXVpcmVkJwogICAgICApOwoKICAgIC8v
IHZlcmlmeSB0aGF0IHRoZSBub25jZSBpcyB1bmlxdWVpc2gKICAgICRmb3VuZCA9ICR0aGlz
LT5kYXRhX3N0b3JlLT5sb29rdXBfbm9uY2UoCiAgICAgICRjb25zdW1lciwKICAgICAgJHRv
a2VuLAogICAgICAkbm9uY2UsCiAgICAgICR0aW1lc3RhbXAKICAgICk7CiAgICBpZiAoJGZv
dW5kKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiTm9uY2UgYWxyZWFkeSB1
c2VkOiAkbm9uY2UiKTsKICAgIH0KICB9Cgp9CgpjbGFzcyBPQXV0aERhdGFTdG9yZSB7CiAg
ZnVuY3Rpb24gbG9va3VwX2NvbnN1bWVyKCRjb25zdW1lcl9rZXkpIHsKICAgIC8vIGltcGxl
bWVudCBtZQogIH0KCiAgZnVuY3Rpb24gbG9va3VwX3Rva2VuKCRjb25zdW1lciwgJHRva2Vu
X3R5cGUsICR0b2tlbikgewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBs
b29rdXBfbm9uY2UoJGNvbnN1bWVyLCAkdG9rZW4sICRub25jZSwgJHRpbWVzdGFtcCkgewog
ICAgLy8gaW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBuZXdfcmVxdWVzdF90b2tlbigk
Y29uc3VtZXIsICRjYWxsYmFjayA9IG51bGwpIHsKICAgIC8vIHJldHVybiBhIG5ldyB0b2tl
biBhdHRhY2hlZCB0byB0aGlzIGNvbnN1bWVyCiAgfQoKICBmdW5jdGlvbiBuZXdfYWNjZXNz
X3Rva2VuKCR0b2tlbiwgJGNvbnN1bWVyLCAkdmVyaWZpZXIgPSBudWxsKSB7CiAgICAvLyBy
ZXR1cm4gYSBuZXcgYWNjZXNzIHRva2VuIGF0dGFjaGVkIHRvIHRoaXMgY29uc3VtZXIKICAg
IC8vIGZvciB0aGUgdXNlciBhc3NvY2lhdGVkIHdpdGggdGhpcyB0b2tlbiBpZiB0aGUgcmVx
dWVzdCB0b2tlbgogICAgLy8gaXMgYXV0aG9yaXplZAogICAgLy8gc2hvdWxkIGFsc28gaW52
YWxpZGF0ZSB0aGUgcmVxdWVzdCB0b2tlbgogIH0KCn0KCmNsYXNzIE9BdXRoVXRpbCB7CiAg
cHVibGljIHN0YXRpYyBmdW5jdGlvbiB1cmxlbmNvZGVfcmZjMzk4NigkaW5wdXQpIHsKICBp
ZiAoaXNfYXJyYXkoJGlucHV0KSkgewogICAgcmV0dXJuIGFycmF5X21hcChhcnJheSgnT0F1
dGhVdGlsJywgJ3VybGVuY29kZV9yZmMzOTg2JyksICRpbnB1dCk7CiAgfSBlbHNlIGlmIChp
c19zY2FsYXIoJGlucHV0KSkgewogICAgcmV0dXJuIHN0cl9yZXBsYWNlKAogICAgICAnKycs
CiAgICAgICcgJywKICAgICAgc3RyX3JlcGxhY2UoJyU3RScsICd+JywgcmF3dXJsZW5jb2Rl
KCRpbnB1dCkpCiAgICApOwogIH0gZWxzZSB7CiAgICByZXR1cm4gJyc7CiAgfQp9CgoKICAv
LyBUaGlzIGRlY29kZSBmdW5jdGlvbiBpc24ndCB0YWtpbmcgaW50byBjb25zaWRlcmF0aW9u
IHRoZSBhYm92ZQogIC8vIG1vZGlmaWNhdGlvbnMgdG8gdGhlIGVuY29kaW5nIHByb2Nlc3Mu
IEhvd2V2ZXIsIHRoaXMgbWV0aG9kIGRvZXNuJ3QKICAvLyBzZWVtIHRvIGJlIHVzZWQgYW55
d2hlcmUgc28gbGVhdmluZyBpdCBhcyBpcy4KICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHVy
bGRlY29kZV9yZmMzOTg2KCRzdHJpbmcpIHsKICAgIHJldHVybiB1cmxkZWNvZGUoJHN0cmlu
Zyk7CiAgfQoKICAvLyBVdGlsaXR5IGZ1bmN0aW9uIGZvciB0dXJuaW5nIHRoZSBBdXRob3Jp
emF0aW9uOiBoZWFkZXIgaW50bwogIC8vIHBhcmFtZXRlcnMsIGhhcyB0byBkbyBzb21lIHVu
ZXNjYXBpbmcKICAvLyBDYW4gZmlsdGVyIG91dCBhbnkgbm9uLW9hdXRoIHBhcmFtZXRlcnMg
aWYgbmVlZGVkIChkZWZhdWx0IGJlaGF2aW91cikKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9u
IHNwbGl0X2hlYWRlcigkaGVhZGVyLCAkb25seV9hbGxvd19vYXV0aF9wYXJhbWV0ZXJzID0g
dHJ1ZSkgewogICAgJHBhdHRlcm4gPSAnLygoWy1fYS16XSopPSgiKFteIl0qKSJ8KFteLF0q
KSksPykvJzsKICAgICRvZmZzZXQgPSAwOwogICAgJHBhcmFtcyA9IGFycmF5KCk7CiAgICB3
aGlsZSAocHJlZ19tYXRjaCgkcGF0dGVybiwgJGhlYWRlciwgJG1hdGNoZXMsIFBSRUdfT0ZG
U0VUX0NBUFRVUkUsICRvZmZzZXQpID4gMCkgewogICAgICAkbWF0Y2ggPSAkbWF0Y2hlc1sw
XTsKICAgICAgJGhlYWRlcl9uYW1lID0gJG1hdGNoZXNbMl1bMF07CiAgICAgICRoZWFkZXJf
Y29udGVudCA9IChpc3NldCgkbWF0Y2hlc1s1XSkpID8gJG1hdGNoZXNbNV1bMF0gOiAkbWF0
Y2hlc1s0XVswXTsKICAgICAgaWYgKHByZWdfbWF0Y2goJy9eb2F1dGhfLycsICRoZWFkZXJf
bmFtZSkgfHwgISRvbmx5X2FsbG93X29hdXRoX3BhcmFtZXRlcnMpIHsKICAgICAgICAkcGFy
YW1zWyRoZWFkZXJfbmFtZV0gPSBPQXV0aFV0aWw6OnVybGRlY29kZV9yZmMzOTg2KCRoZWFk
ZXJfY29udGVudCk7CiAgICAgIH0KICAgICAgJG9mZnNldCA9ICRtYXRjaFsxXSArIHN0cmxl
bigkbWF0Y2hbMF0pOwogICAgfQoKICAgIGlmIChpc3NldCgkcGFyYW1zWydyZWFsbSddKSkg
ewogICAgICB1bnNldCgkcGFyYW1zWydyZWFsbSddKTsKICAgIH0KCiAgICByZXR1cm4gJHBh
cmFtczsKICB9CgogIC8vIGhlbHBlciB0byB0cnkgdG8gc29ydCBvdXQgaGVhZGVycyBmb3Ig
cGVvcGxlIHdobyBhcmVuJ3QgcnVubmluZyBhcGFjaGUKICBwdWJsaWMgc3RhdGljIGZ1bmN0
aW9uIGdldF9oZWFkZXJzKCkgewogICAgaWYgKGZ1bmN0aW9uX2V4aXN0cygnYXBhY2hlX3Jl
cXVlc3RfaGVhZGVycycpKSB7CiAgICAgIC8vIHdlIG5lZWQgdGhpcyB0byBnZXQgdGhlIGFj
dHVhbCBBdXRob3JpemF0aW9uOiBoZWFkZXIKICAgICAgLy8gYmVjYXVzZSBhcGFjaGUgdGVu
ZHMgdG8gdGVsbCB1cyBpdCBkb2Vzbid0IGV4aXN0CiAgICAgICRoZWFkZXJzID0gYXBhY2hl
X3JlcXVlc3RfaGVhZGVycygpOwoKICAgICAgLy8gc2FuaXRpemUgdGhlIG91dHB1dCBvZiBh
cGFjaGVfcmVxdWVzdF9oZWFkZXJzIGJlY2F1c2UKICAgICAgLy8gd2UgYWx3YXlzIHdhbnQg
dGhlIGtleXMgdG8gYmUgQ2FzZWQtTGlrZS1UaGlzIGFuZCBhcmgoKQogICAgICAvLyByZXR1
cm5zIHRoZSBoZWFkZXJzIGluIHRoZSBzYW1lIGNhc2UgYXMgdGhleSBhcmUgaW4gdGhlCiAg
ICAgIC8vIHJlcXVlc3QKICAgICAgJG91dCA9IGFycmF5KCk7CiAgICAgIGZvcmVhY2goICRo
ZWFkZXJzIEFTICRrZXkgPT4gJHZhbHVlICkgewogICAgICAgICRrZXkgPSBzdHJfcmVwbGFj
ZSgKICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAiLSIsCiAgICAgICAgICAgIHVjd29y
ZHMoc3RydG9sb3dlcihzdHJfcmVwbGFjZSgiLSIsICIgIiwgJGtleSkpKQogICAgICAgICAg
KTsKICAgICAgICAkb3V0WyRrZXldID0gJHZhbHVlOwogICAgICB9CiAgICB9IGVsc2Ugewog
ICAgICAvLyBvdGhlcndpc2Ugd2UgZG9uJ3QgaGF2ZSBhcGFjaGUgYW5kIGFyZSBqdXN0IGdv
aW5nIHRvIGhhdmUgdG8gaG9wZQogICAgICAvLyB0aGF0ICRfU0VSVkVSIGFjdHVhbGx5IGNv
bnRhaW5zIHdoYXQgd2UgbmVlZAogICAgICAkb3V0ID0gYXJyYXkoKTsKICAgICAgaWYoIGlz
c2V0KCRfU0VSVkVSWydDT05URU5UX1RZUEUnXSkgKQogICAgICAgICRvdXRbJ0NvbnRlbnQt
VHlwZSddID0gJF9TRVJWRVJbJ0NPTlRFTlRfVFlQRSddOwogICAgICBpZiggaXNzZXQoJF9F
TlZbJ0NPTlRFTlRfVFlQRSddKSApCiAgICAgICAgJG91dFsnQ29udGVudC1UeXBlJ10gPSAk
X0VOVlsnQ09OVEVOVF9UWVBFJ107CgogICAgICBmb3JlYWNoICgkX1NFUlZFUiBhcyAka2V5
ID0+ICR2YWx1ZSkgewogICAgICAgIGlmIChzdWJzdHIoJGtleSwgMCwgNSkgPT0gIkhUVFBf
IikgewogICAgICAgICAgLy8gdGhpcyBpcyBjaGFvcywgYmFzaWNhbGx5IGl0IGlzIGp1c3Qg
dGhlcmUgdG8gY2FwaXRhbGl6ZSB0aGUgZmlyc3QKICAgICAgICAgIC8vIGxldHRlciBvZiBl
dmVyeSB3b3JkIHRoYXQgaXMgbm90IGFuIGluaXRpYWwgSFRUUCBhbmQgc3RyaXAgSFRUUAog
ICAgICAgICAgLy8gY29kZSBmcm9tIHByemVtZWsKICAgICAgICAgICRrZXkgPSBzdHJfcmVw
bGFjZSgKICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAiLSIsCiAgICAgICAgICAgIHVj
d29yZHMoc3RydG9sb3dlcihzdHJfcmVwbGFjZSgiXyIsICIgIiwgc3Vic3RyKCRrZXksIDUp
KSkpCiAgICAgICAgICApOwogICAgICAgICAgJG91dFska2V5XSA9ICR2YWx1ZTsKICAgICAg
ICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiAkb3V0OwogIH0KCiAgLy8gVGhpcyBmdW5j
dGlvbiB0YWtlcyBhIGlucHV0IGxpa2UgYT1iJmE9YyZkPWUgYW5kIHJldHVybnMgdGhlIHBh
cnNlZAogIC8vIHBhcmFtZXRlcnMgbGlrZSB0aGlzCiAgLy8gYXJyYXkoJ2EnID0+IGFycmF5
KCdiJywnYycpLCAnZCcgPT4gJ2UnKQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gcGFyc2Vf
cGFyYW1ldGVycyggJGlucHV0ICkgewogICAgaWYgKCFpc3NldCgkaW5wdXQpIHx8ICEkaW5w
dXQpIHJldHVybiBhcnJheSgpOwoKICAgICRwYWlycyA9IGV4cGxvZGUoJyYnLCAkaW5wdXQp
OwoKICAgICRwYXJzZWRfcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICBmb3JlYWNoICgkcGFp
cnMgYXMgJHBhaXIpIHsKICAgICAgJHNwbGl0ID0gZXhwbG9kZSgnPScsICRwYWlyLCAyKTsK
ICAgICAgJHBhcmFtZXRlciA9IE9BdXRoVXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYoJHNwbGl0
WzBdKTsKICAgICAgJHZhbHVlID0gaXNzZXQoJHNwbGl0WzFdKSA/IE9BdXRoVXRpbDo6dXJs
ZGVjb2RlX3JmYzM5ODYoJHNwbGl0WzFdKSA6ICcnOwoKICAgICAgaWYgKGlzc2V0KCRwYXJz
ZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSkpIHsKICAgICAgICAvLyBXZSBoYXZlIGFscmVh
ZHkgcmVjaWV2ZWQgcGFyYW1ldGVyKHMpIHdpdGggdGhpcyBuYW1lLCBzbyBhZGQgdG8gdGhl
IGxpc3QKICAgICAgICAvLyBvZiBwYXJhbWV0ZXJzIHdpdGggdGhpcyBuYW1lCgogICAgICAg
IGlmIChpc19zY2FsYXIoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdKSkgewogICAg
ICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgZHVwbGljYXRlLCBzbyB0cmFuc2Zvcm0gc2Nh
bGFyIChzdHJpbmcpIGludG8gYW4gYXJyYXkKICAgICAgICAgIC8vIHNvIHdlIGNhbiBhZGQg
dGhlIGR1cGxpY2F0ZXMKICAgICAgICAgICRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVy
XSA9IGFycmF5KCRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSk7CiAgICAgICAgfQoK
ICAgICAgICAkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl1bXSA9ICR2YWx1ZTsKICAg
ICAgfSBlbHNlIHsKICAgICAgICAkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0gPSAk
dmFsdWU7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiAkcGFyc2VkX3BhcmFtZXRlcnM7CiAg
fQoKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGJ1aWxkX2h0dHBfcXVlcnkoJHBhcmFtcykg
ewogICAgaWYgKCEkcGFyYW1zKSByZXR1cm4gJyc7CgogICAgLy8gVXJsZW5jb2RlIGJvdGgg
a2V5cyBhbmQgdmFsdWVzCiAgICAka2V5cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5
ODYoYXJyYXlfa2V5cygkcGFyYW1zKSk7CiAgICAkdmFsdWVzID0gT0F1dGhVdGlsOjp1cmxl
bmNvZGVfcmZjMzk4NihhcnJheV92YWx1ZXMoJHBhcmFtcykpOwogICAgJHBhcmFtcyA9IGFy
cmF5X2NvbWJpbmUoJGtleXMsICR2YWx1ZXMpOwoKICAgIC8vIFBhcmFtZXRlcnMgYXJlIHNv
cnRlZCBieSBuYW1lLCB1c2luZyBsZXhpY29ncmFwaGljYWwgYnl0ZSB2YWx1ZSBvcmRlcmlu
Zy4KICAgIC8vIFJlZjogU3BlYzogOS4xLjEgKDEpCiAgICB1a3NvcnQoJHBhcmFtcywgJ3N0
cmNtcCcpOwoKICAgICRwYWlycyA9IGFycmF5KCk7CiAgICBmb3JlYWNoICgkcGFyYW1zIGFz
ICRwYXJhbWV0ZXIgPT4gJHZhbHVlKSB7CiAgICAgIGlmIChpc19hcnJheSgkdmFsdWUpKSB7
CiAgICAgICAgLy8gSWYgdHdvIG9yIG1vcmUgcGFyYW1ldGVycyBzaGFyZSB0aGUgc2FtZSBu
YW1lLCB0aGV5IGFyZSBzb3J0ZWQgYnkgdGhlaXIgdmFsdWUKICAgICAgICAvLyBSZWY6IFNw
ZWM6IDkuMS4xICgxKQogICAgICAgIG5hdHNvcnQoJHZhbHVlKTsKICAgICAgICBmb3JlYWNo
ICgkdmFsdWUgYXMgJGR1cGxpY2F0ZV92YWx1ZSkgewogICAgICAgICAgJHBhaXJzW10gPSAk
cGFyYW1ldGVyIC4gJz0nIC4gJGR1cGxpY2F0ZV92YWx1ZTsKICAgICAgICB9CiAgICAgIH0g
ZWxzZSB7CiAgICAgICAgJHBhaXJzW10gPSAkcGFyYW1ldGVyIC4gJz0nIC4gJHZhbHVlOwog
ICAgICB9CiAgICB9CiAgICAvLyBGb3IgZWFjaCBwYXJhbWV0ZXIsIHRoZSBuYW1lIGlzIHNl
cGFyYXRlZCBmcm9tIHRoZSBjb3JyZXNwb25kaW5nIHZhbHVlIGJ5IGFuICc9JyBjaGFyYWN0
ZXIgKEFTQ0lJIGNvZGUgNjEpCiAgICAvLyBFYWNoIG5hbWUtdmFsdWUgcGFpciBpcyBzZXBh
cmF0ZWQgYnkgYW4gJyYnIGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCkKICAgIHJldHVybiBp
bXBsb2RlKCcmJywgJHBhaXJzKTsKICB9Cn0iO3M6MzoibWQ1IjtzOjMyOiIzZTc0Y2NjNWQ1
ZjdmODkzZjQyM2NlNzljNDliYzhhNCI7fQ==
